import{e as u,C as se,D as p,g as Z,z as Me,E as je,c as l,a as oe,u as Ie,h as Te,w as Le,b as t,d as c,o as r,t as a,j as C,v as I,F as f,r as V,n as h,G as W,m as Ee,p as Be,k as ze,H as Ue}from"./app-CxERHmKx.js";import{_ as Ve}from"./AuthenticatedLayout-CyBKoa2d.js";import"./ApplicationLogo-cuFhFx5-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-Crg8nh6l.js";const Ne={class:"flex h-[calc(100vh-65px)] bg-gray-50 overflow-hidden"},Fe={class:"w-80 bg-white border-r border-gray-200 flex flex-col shadow-sm"},$e={class:"p-4 bg-gradient-to-r from-emerald-600 to-teal-600"},Oe={class:"flex items-center justify-between mb-3"},Pe={class:"flex items-center gap-2"},Re={key:0,class:"bg-white text-emerald-600 px-2 py-0.5 rounded-full text-xs font-bold"},Ae={class:"relative"},He={class:"flex-1 overflow-y-auto"},Ke={key:0,class:"p-6 text-center text-gray-400"},Se=["onClick"],Ze={class:"ml-3 flex-1 min-w-0"},We={class:"flex justify-between items-center mb-1"},Ye={class:"font-semibold text-gray-800 truncate"},qe={class:"text-xs text-gray-400 whitespace-nowrap ml-2"},Ge={class:"text-sm text-gray-500 truncate"},Je={key:0,class:"ml-2 bg-emerald-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center"},Qe={key:0,class:"flex-1 flex flex-col min-h-0"},Xe={class:"px-5 py-3 bg-white border-b border-gray-200 flex items-center justify-between shrink-0 shadow-sm"},et={class:"flex items-center"},tt={class:"ml-3"},st={class:"font-semibold text-gray-800"},ot={key:0,class:"flex justify-center my-4"},lt={class:"bg-white/90 text-gray-600 text-xs font-medium px-4 py-1.5 rounded-full shadow-sm"},rt=["src","onClick"],at={key:0,class:"text-[15px] text-gray-800 mt-2"},nt={class:"flex items-start gap-3 min-w-[220px] p-2 bg-gray-50 rounded-lg border border-gray-200"},it={class:"text-white text-xs font-bold"},dt={class:"flex-1 min-w-0"},ut={class:"text-sm font-medium text-gray-800 truncate"},ct={class:"text-xs text-gray-500 mt-0.5"},mt={class:"flex gap-4 mt-2 text-sm"},gt=["onClick"],vt=["href","download"],pt={key:2,class:"text-[15px] text-gray-800 break-words"},ft={class:"flex items-center justify-end gap-1 mt-1"},ht={class:"text-[11px] text-gray-500"},xt={key:0,class:"w-4 h-4 text-blue-500",fill:"currentColor",viewBox:"0 0 24 24"},wt={key:0,class:"absolute inset-0 bg-emerald-500/20 border-4 border-dashed border-emerald-500 rounded-lg flex items-center justify-center z-50"},bt={class:"px-4 py-3 bg-gray-100 border-t border-gray-200 flex items-center gap-3"},yt=["disabled"],kt={key:1,class:"flex-1 flex flex-col items-center justify-center text-gray-400"},Ct={key:0,class:"w-80 bg-white border-l border-gray-200 flex flex-col hidden lg:flex shadow-sm"},_t={class:"flex-1 p-5 space-y-5 overflow-y-auto"},Dt={class:"bg-gray-50 rounded-xl p-4 text-center"},Mt={class:"mt-3 font-semibold text-gray-800"},jt={class:"text-sm text-gray-500"},It=["value"],Tt={key:0,class:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4"},Lt={class:"bg-[#1f2c34] rounded-xl max-w-lg w-full max-h-[90vh] flex flex-col overflow-hidden shadow-2xl"},Et={class:"flex items-center justify-between p-4 border-b border-gray-700"},Bt={class:"flex items-center gap-3"},zt={class:"text-white font-medium"},Ut={class:"flex-1 overflow-y-auto p-4 bg-[#0b141a]"},Vt={key:0,class:"flex items-center justify-center min-h-[200px]"},Nt=["src"],Ft={key:1,class:"text-center"},$t={class:"text-white font-medium"},Ot={class:"text-gray-400 text-sm"},Pt={key:1,class:"flex gap-2 mt-4 justify-center flex-wrap"},Rt=["onClick"],At=["src"],Ht={key:1,class:"w-16 h-16 bg-gray-700 flex items-center justify-center"},Kt=["onClick"],St={class:"p-4 bg-[#1f2c34] border-t border-gray-700"},Zt={class:"flex items-center gap-3"},Wt=["disabled"],Yt={key:1,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4"},qt={class:"bg-white rounded-xl max-w-sm w-full shadow-2xl overflow-hidden animate-fade-in-up"},Gt={class:"p-4 bg-emerald-600 flex justify-between items-center"},Jt={class:"p-6 space-y-4"},Qt={class:"relative"},Xt=["value"],es=["disabled"],ts={key:0,class:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"},is={__name:"Index",props:{initialContacts:Array},setup(le){const m=u(le.initialContacts),n=u(null),v=u([]),T=u(null),L=u(""),re=u(null),ae=u(null),E=u(!1),_=u(!1),N=u("591"),w=u(""),B=u(""),D=u([]),M=u(!1);se(_,s=>{s&&D.value.length===0&&ne()});const ne=async()=>{try{const s=await p.get("/debug-templates");s.data&&s.data.data&&(D.value=s.data.data.filter(e=>e.status==="APPROVED").map(e=>({name:e.name,language:e.language})),D.value.length>0&&(B.value=D.value[0].name))}catch(s){console.error("Error fetching templates",s)}},Y=Z(()=>m.value.reduce((s,e)=>s+(e.unread||0),0)),q=async()=>{if(w.value){M.value=!0;try{const s=N.value+w.value,o=(await p.post(route("chat.initiate"),{phone:s,template:B.value})).data,i=m.value.findIndex(x=>x.id===o.id);i===-1?(m.value.unshift({...o,relativeDate:$(o.time,!0),formattedTime:j(o.time)}),O(m.value[0])):O(m.value[i]),_.value=!1,w.value=""}catch(s){console.error("Error initiating chat",s),alert("Error al iniciar chat")}finally{M.value=!1}}},z=u(!1),d=u([]),b=u(""),g=u(0);let F=null;const ie=["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],de=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],j=s=>{if(!s)return"";let e;return s.includes("T")&&(s.includes("+")||s.includes("Z"))?e=new Date(s):e=new Date(s.replace(" ","T")+"Z"),isNaN(e.getTime())?s:e.toLocaleTimeString("es-BO",{hour:"2-digit",minute:"2-digit"})},$=(s,e=!1)=>{if(!s)return"";let o;if(s.includes("T")&&(s.includes("+")||s.includes("Z"))?o=new Date(s):o=new Date(s.replace(" ","T")+"Z"),isNaN(o.getTime()))return s;const i=new Date,x=new Date(i.getFullYear(),i.getMonth(),i.getDate()),S=new Date(o.getFullYear(),o.getMonth(),o.getDate()),U=Math.floor((x-S)/(1e3*60*60*24));return U===0?e?j(s):"Hoy":U===1?"Ayer":U===2?"Anteayer":U<7?ie[o.getDay()]:`${o.getDate()} ${de[o.getMonth()]}`},ue=s=>{if(!s)return"";let e;return s.includes("T")&&(s.includes("+")||s.includes("Z"))?e=new Date(s):e=new Date(s.replace(" ","T")+"Z"),`${e.getFullYear()}-${e.getMonth()}-${e.getDate()}`},G=Z(()=>{if(!L.value.trim())return m.value;const s=L.value.toLowerCase();return m.value.filter(e=>e.name&&e.name.toLowerCase().includes(s)||e.lastMessage&&e.lastMessage.toLowerCase().includes(s))}),ce=Z(()=>{const s=[];let e=null;return v.value.forEach(o=>{const i=ue(o.rawDate);i!==e&&(s.push({type:"separator",date:$(o.rawDate),key:"sep-"+i}),e=i),s.push({type:"message",...o})}),s}),me=async()=>{await Ue(),setTimeout(()=>{T.value&&(T.value.scrollTop=T.value.scrollHeight)},100)};se(v,()=>{me()},{deep:!0});const O=async s=>{if(n.value=s,v.value=[],await J(),s.unread>0)try{await p.post(route("chat.read",s.id));const e=m.value.findIndex(o=>o.id===s.id);e!==-1&&(m.value[e].unread=0)}catch(e){console.error("Error marking as read",e)}},J=async()=>{if(n.value)try{const e=(await p.get(route("chat.messages",n.value.id))).data.map(o=>({id:o.id,text:o.body,sender:o.direction==="outgoing"?"me":"them",time:j(o.created_at),rawDate:o.created_at,msgType:o.type,metadata:o.metadata?JSON.parse(o.metadata):null}));e.length!==v.value.length&&(v.value=e)}catch(s){console.error("Error loading messages",s)}},ge=async()=>{try{const s=await p.get(route("chat.contacts"));m.value=s.data.map(e=>({...e,relativeDate:$(e.time,!0),formattedTime:j(e.time)}))}catch(s){console.error("Error fetching contacts",s)}},y=u(""),k=u(!1),Q=async()=>{if(!y.value.trim()||!n.value)return;const s=y.value;y.value="",k.value=!0;const e=new Date().toISOString(),o=Date.now();v.value.push({id:o,text:s,sender:"me",time:j(e),rawDate:e});try{await p.post(route("chat.send",n.value.id),{message:s})}catch(i){console.error("Failed to send",i),alert("Error al enviar mensaje")}finally{k.value=!1}},P=s=>{if(!s)return"?";const e=s.split(" ");return e.length>=2?(e[0][0]+e[1][0]).toUpperCase():s.substring(0,2).toUpperCase()},R=s=>{if(!s)return"bg-gray-400";const e=["bg-emerald-500","bg-blue-500","bg-purple-500","bg-pink-500","bg-orange-500","bg-teal-500","bg-indigo-500","bg-rose-500"],o=s.charCodeAt(0)%e.length;return e[o]},ve=s=>{window.open(s,"_blank")},A=s=>{if(s.metadata?.filename)return s.metadata.filename;if(s.text&&!s.text.includes("/"))return s.text;if(s.text?.includes("/")){const e=s.text.split("/");return e[e.length-1]||"Documento"}return"Documento"},H=s=>A(s).split(".").pop()?.toUpperCase()||"Archivo",X=s=>s.metadata?.local_url?s.metadata.local_url:s.text?.startsWith("http")?s.text:`/storage/chat-media/${s.text}`,pe=s=>{const e=H(s).toLowerCase();return{pdf:"bg-red-500",doc:"bg-blue-600",docx:"bg-blue-600",xls:"bg-green-600",xlsx:"bg-green-600",ppt:"bg-orange-500",pptx:"bg-orange-500",txt:"bg-gray-500",zip:"bg-yellow-600",rar:"bg-yellow-600",mp3:"bg-purple-500",mp4:"bg-pink-500",jpg:"bg-teal-500",jpeg:"bg-teal-500",png:"bg-teal-500"}[e]||"bg-gray-500"},fe=s=>{const e=H(s).toUpperCase();return e.length>4?e.substring(0,4):e},he=s=>{const e=X(s);window.open(e,"_blank")},xe=async(s,e="")=>{const o=new FormData;o.append("image",s),e&&o.append("caption",e);const i=Date.now()+Math.random(),x=URL.createObjectURL(s);v.value.push({id:i,text:x,sender:"me",time:new Date().toLocaleTimeString("es-BO",{hour:"2-digit",minute:"2-digit"}),rawDate:new Date().toISOString(),msgType:"image",metadata:e?{caption:e}:null});try{await p.post(route("chat.sendImage",n.value.id),o,{headers:{"Content-Type":"multipart/form-data"}})}catch(S){console.error("Failed to send image",S)}},we=async s=>{const e=new FormData;e.append("document",s),e.append("filename",s.name);const o=Date.now()+Math.random();v.value.push({id:o,text:s.name,sender:"me",time:new Date().toLocaleTimeString("es-BO",{hour:"2-digit",minute:"2-digit"}),rawDate:new Date().toISOString(),msgType:"document"});try{await p.post(route("chat.sendDocument",n.value.id),e,{headers:{"Content-Type":"multipart/form-data"}})}catch(i){console.error("Failed to send document",i)}},be=s=>{const e=Array.from(s.target.files);!e.length||!n.value||(K(e),s.target.value="")},ye=s=>{const e=Array.from(s.target.files);!e.length||!n.value||(K(e),s.target.value="")},K=s=>{d.value=s.map(e=>({file:e,name:e.name,type:e.type,isImage:e.type.startsWith("image/"),preview:e.type.startsWith("image/")?URL.createObjectURL(e):null,size:(e.size/1024).toFixed(1)+" KB"})),g.value=0,b.value="",z.value=!0},ee=()=>{d.value.forEach(s=>{s.preview&&URL.revokeObjectURL(s.preview)}),d.value=[],b.value="",z.value=!1},ke=s=>{d.value[s].preview&&URL.revokeObjectURL(d.value[s].preview),d.value.splice(s,1),d.value.length===0?ee():g.value>=d.value.length&&(g.value=d.value.length-1)},te=async()=>{if(!d.value.length||!n.value)return;z.value=!1,k.value=!0;const s=b.value;for(const e of d.value)e.isImage?await xe(e.file,s):await we(e.file);d.value.forEach(e=>{e.preview&&URL.revokeObjectURL(e.preview)}),d.value=[],b.value="",k.value=!1},Ce=s=>{s.preventDefault(),E.value=!0},_e=()=>{E.value=!1},De=s=>{if(s.preventDefault(),E.value=!1,!n.value)return;const e=Array.from(s.dataTransfer.files);e.length&&K(e)};return Me(()=>{F=setInterval(()=>{ge(),n.value&&J()},5e3)}),je(()=>{F&&clearInterval(F)}),(s,e)=>(r(),l(f,null,[oe(Ie(Te),{title:"Chat CRM"}),oe(Ve,null,{default:Le(()=>[t("div",Ne,[t("div",Fe,[t("div",$e,[t("div",Oe,[t("div",Pe,[e[10]||(e[10]=t("h2",{class:"text-white font-semibold text-lg"},"Conversaciones",-1)),Y.value>0?(r(),l("span",Re,a(Y.value),1)):c("",!0)]),t("button",{onClick:e[0]||(e[0]=o=>_.value=!0),class:"p-1.5 bg-white/20 hover:bg-white/30 rounded-full text-white transition-colors",title:"Nuevo Chat"},[...e[11]||(e[11]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])]),t("div",Ae,[e[12]||(e[12]=t("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),C(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>L.value=o),type:"text",placeholder:"Buscar chat...",class:"w-full pl-10 pr-4 py-2.5 rounded-xl bg-white/90 border-0 text-sm placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-white/50 focus:bg-white transition-all"},null,512),[[I,L.value]])])]),t("div",He,[G.value.length===0?(r(),l("div",Ke,[...e[13]||(e[13]=[t("svg",{class:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),t("p",{class:"text-sm"},"No hay conversaciones",-1)])])):c("",!0),(r(!0),l(f,null,V(G.value,o=>(r(),l("div",{key:o.id,onClick:i=>O(o),class:h(["flex items-center p-4 cursor-pointer border-b border-gray-100 transition-all duration-200 hover:bg-gray-50",{"bg-emerald-50 border-l-4 border-l-emerald-500":n.value&&n.value.id===o.id}])},[t("div",{class:h([R(o.name),"w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold text-sm shadow-md"])},a(P(o.name)),3),t("div",Ze,[t("div",We,[t("h3",Ye,a(o.name),1),t("span",qe,a(o.relativeDate||o.formattedTime),1)]),t("p",Ge,a(o.lastMessage||"Sin mensajes"),1)]),o.unread>0?(r(),l("div",Je,a(o.unread),1)):c("",!0)],10,Se))),128))])]),t("div",{class:"flex-1 flex flex-col bg-[#efeae2] min-h-0 relative",onDragover:Ce,onDragleave:_e,onDrop:De,style:{"background-image":"url('data:image/svg+xml,%3Csvg width=\\'60\\' height=\\'60\\' viewBox=\\'0 0 60 60\\' xmlns=\\'http://www.w3.org/2000/svg\\'%3E%3Cg fill=\\'none\\' fill-rule=\\'evenodd\\'%3E%3Cg fill=\\'%23d5cfc7\\' fill-opacity=\\'0.3\\'%3E%3Cpath d=\\'M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z\\'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')"}},[n.value?(r(),l("div",Qe,[t("div",Xe,[t("div",et,[t("div",{class:h([R(n.value.name),"w-11 h-11 rounded-full flex items-center justify-center text-white font-semibold shadow-md"])},a(P(n.value.name)),3),t("div",tt,[t("h3",st,a(n.value.name),1),e[14]||(e[14]=t("p",{class:"text-xs text-emerald-600"},"En línea",-1))])]),e[15]||(e[15]=t("div",{class:"flex items-center gap-2"},[t("button",{class:"p-2 rounded-full hover:bg-gray-100 text-gray-500 transition-colors"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])]),t("button",{class:"p-2 rounded-full hover:bg-gray-100 text-gray-500 transition-colors"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})])])],-1))]),t("div",{ref_key:"messageContainer",ref:T,class:"flex-1 overflow-y-auto px-6 py-4 min-h-0"},[(r(!0),l(f,null,V(ce.value,o=>(r(),l(f,{key:o.key||o.id},[o.type==="separator"?(r(),l("div",ot,[t("span",lt,a(o.date),1)])):(r(),l("div",{key:1,class:h(["flex mb-2",o.sender==="me"?"justify-end":"justify-start"])},[t("div",{class:h(["max-w-[70%] px-3 py-2 rounded-lg shadow-sm relative",o.sender==="me"?"bg-[#d9fdd3] rounded-tr-none":"bg-white rounded-tl-none"])},[o.msgType==="image"?(r(),l(f,{key:0},[t("img",{src:o.text,alt:"Imagen",class:"max-w-[280px] max-h-[300px] rounded-lg cursor-pointer hover:opacity-90 object-cover",onClick:i=>ve(o.text)},null,8,rt),o.metadata?.caption?(r(),l("p",at,a(o.metadata.caption),1)):c("",!0)],64)):o.msgType==="document"?(r(),l(f,{key:1},[t("div",nt,[t("div",{class:h(["flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center",pe(o)])},[t("span",it,a(fe(o)),1)],2),t("div",dt,[t("p",ut,a(A(o)),1),t("p",ct,a(H(o)),1)])]),t("div",mt,[t("button",{onClick:i=>he(o),class:"text-emerald-600 hover:text-emerald-700 font-medium"}," Abrir ",8,gt),t("a",{href:X(o),download:A(o),class:"text-emerald-600 hover:text-emerald-700 font-medium"}," Descargar ",8,vt)])],64)):(r(),l("p",pt,a(o.text),1)),t("div",ft,[t("span",ht,a(o.time),1),o.sender==="me"?(r(),l("svg",xt,[...e[16]||(e[16]=[t("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},null,-1)])])):c("",!0)])],2)],2))],64))),128))],512),E.value?(r(),l("div",wt,[...e[17]||(e[17]=[t("div",{class:"text-center"},[t("svg",{class:"w-16 h-16 mx-auto text-emerald-600 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})]),t("p",{class:"text-lg font-semibold text-emerald-700"},"Suelta tus archivos aquí"),t("p",{class:"text-sm text-emerald-600"},"Imágenes o documentos")],-1)])])):c("",!0),t("div",bt,[t("input",{type:"file",ref_key:"imageInput",ref:re,accept:"image/*",multiple:"",class:"hidden",onChange:be},null,544),t("input",{type:"file",ref_key:"documentInput",ref:ae,multiple:"",class:"hidden",onChange:ye},null,544),t("button",{onClick:e[2]||(e[2]=o=>s.$refs.imageInput.click()),class:"p-2 rounded-full hover:bg-gray-200 text-gray-500 transition-colors",title:"Enviar imagen"},[...e[18]||(e[18]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])]),t("button",{onClick:e[3]||(e[3]=o=>s.$refs.documentInput.click()),class:"p-2 rounded-full hover:bg-gray-200 text-gray-500 transition-colors",title:"Enviar documento"},[...e[19]||(e[19]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})],-1)])]),C(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>y.value=o),onKeyup:W(Q,["enter"]),type:"text",placeholder:"Escribe un mensaje",class:"flex-1 px-5 py-3 rounded-full bg-white border-0 text-[15px] focus:outline-none focus:ring-2 focus:ring-emerald-500 shadow-sm"},null,544),[[I,y.value]]),t("button",{onClick:Q,disabled:k.value||!y.value.trim(),class:"p-3 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-md"},[...e[20]||(e[20]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1)])],8,yt)])])):(r(),l("div",kt,[...e[21]||(e[21]=[t("div",{class:"w-24 h-24 bg-gray-200 rounded-full flex items-center justify-center mb-4"},[t("svg",{class:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])],-1),t("h3",{class:"text-xl font-medium text-gray-600 mb-2"},"UNITEPC CRM Chat",-1),t("p",{class:"text-sm"},"Selecciona un chat para comenzar",-1)])]))],32),n.value?(r(),l("div",Ct,[e[26]||(e[26]=t("div",{class:"p-5 bg-gradient-to-r from-gray-50 to-gray-100 border-b"},[t("h2",{class:"text-lg font-bold text-gray-800"},"Información del CRM")],-1)),t("div",_t,[t("div",Dt,[t("div",{class:h([R(n.value.name),"w-16 h-16 rounded-full flex items-center justify-center text-white font-bold text-xl mx-auto shadow-lg"])},a(P(n.value.name)),3),t("h3",Mt,a(n.value.name),1),t("p",jt,"+591 "+a(n.value.wa_id?.slice(-8)||"--------"),1)]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-600 mb-1.5"},"Nombre completo",-1)),t("input",{value:n.value.name,class:"w-full px-3 py-2.5 rounded-lg border border-gray-200 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},null,8,It)]),e[23]||(e[23]=t("div",null,[t("label",{class:"block text-sm font-medium text-gray-600 mb-1.5"},"Carrera de Interés"),t("select",{class:"w-full px-3 py-2.5 rounded-lg border border-gray-200 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"},[t("option",null,"Medicina"),t("option",null,"Odontología"),t("option",null,"Ing. Sistemas"),t("option",null,"Derecho"),t("option",null,"Enfermería")])],-1)),e[24]||(e[24]=t("div",null,[t("label",{class:"block text-sm font-medium text-gray-600 mb-1.5"},"Estado"),t("div",{class:"flex gap-2 flex-wrap"},[t("span",{class:"px-3 py-1.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-700 cursor-pointer hover:bg-yellow-200 transition-colors"}," Prospecto "),t("span",{class:"px-3 py-1.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600 cursor-pointer hover:bg-gray-200 transition-colors"}," Interesado "),t("span",{class:"px-3 py-1.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600 cursor-pointer hover:bg-gray-200 transition-colors"}," Inscrito ")])],-1)),e[25]||(e[25]=t("div",null,[t("label",{class:"block text-sm font-medium text-gray-600 mb-1.5"},"Notas"),t("textarea",{rows:"3",placeholder:"Agregar notas sobre el contacto...",class:"w-full px-3 py-2.5 rounded-lg border border-gray-200 bg-white text-sm resize-none focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})],-1))]),e[27]||(e[27]=t("div",{class:"p-4 border-t"},[t("button",{class:"w-full py-2.5 bg-emerald-500 hover:bg-emerald-600 text-white font-medium rounded-lg transition-colors shadow-sm"}," Guardar cambios ")],-1))])):c("",!0)]),z.value?(r(),l("div",Tt,[t("div",Lt,[t("div",Et,[t("div",Bt,[t("button",{onClick:ee,class:"p-2 hover:bg-gray-700 rounded-full transition-colors"},[...e[28]||(e[28]=[t("svg",{class:"w-5 h-5 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),t("span",zt,a(d.value.length)+" archivo"+a(d.value.length>1?"s":""),1)])]),t("div",Ut,[d.value[g.value]?(r(),l("div",Vt,[d.value[g.value].isImage?(r(),l("img",{key:0,src:d.value[g.value].preview,class:"max-w-full max-h-[300px] rounded-lg object-contain"},null,8,Nt)):(r(),l("div",Ft,[e[29]||(e[29]=t("svg",{class:"w-20 h-20 mx-auto text-gray-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t("p",$t,a(d.value[g.value].name),1),t("p",Ot,a(d.value[g.value].size),1)]))])):c("",!0),d.value.length>1?(r(),l("div",Pt,[(r(!0),l(f,null,V(d.value,(o,i)=>(r(),l("div",{key:i,class:h(["relative cursor-pointer rounded-lg overflow-hidden border-2 transition-all",g.value===i?"border-emerald-500":"border-transparent"]),onClick:x=>g.value=i},[o.isImage?(r(),l("img",{key:0,src:o.preview,class:"w-16 h-16 object-cover"},null,8,At)):(r(),l("div",Ht,[...e[30]||(e[30]=[t("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)])])),t("button",{onClick:Ee(x=>ke(i),["stop"]),class:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center shadow-lg"},[...e[31]||(e[31]=[t("svg",{class:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Kt)],10,Rt))),128))])):c("",!0)]),t("div",St,[t("div",Zt,[C(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>b.value=o),type:"text",placeholder:"Agregar un comentario...",class:"flex-1 bg-[#2a3942] text-white px-4 py-3 rounded-full border-0 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 placeholder-gray-400",onKeyup:W(te,["enter"])},null,544),[[I,b.value]]),t("button",{onClick:te,disabled:k.value,class:"p-3 bg-emerald-500 hover:bg-emerald-600 rounded-full transition-colors disabled:opacity-50"},[...e[32]||(e[32]=[t("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1)])],8,Wt)])])])])):c("",!0),_.value?(r(),l("div",Yt,[t("div",qt,[t("div",Gt,[e[34]||(e[34]=t("h3",{class:"text-white font-semibold text-lg"},"Iniciar Conversación",-1)),t("button",{onClick:e[6]||(e[6]=o=>_.value=!1),class:"text-white/80 hover:text-white transition-colors"},[...e[33]||(e[33]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Jt,[t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Prefijo País",-1)),t("div",Qt,[e[35]||(e[35]=t("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 font-medium"},"+",-1)),C(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>N.value=o),type:"text",class:"w-full pl-6 pr-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all outline-none",placeholder:"591"},null,512),[[I,N.value]])])]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Número de Teléfono",-1)),C(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>w.value=o),type:"tel",class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all outline-none",placeholder:"70012345",onKeyup:W(q,["enter"])},null,544),[[I,w.value]])]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Plantilla de Inicio (Opcional)",-1)),C(t("select",{"onUpdate:modelValue":e[9]||(e[9]=o=>B.value=o),class:"w-full px-4 py-2 rounded-lg border border-gray-300 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all outline-none text-sm"},[e[38]||(e[38]=t("option",{value:""},"-- Ninguna (Solo crear contacto) --",-1)),(r(!0),l(f,null,V(D.value,o=>(r(),l("option",{key:o.name,value:o.name},a(o.name)+" ("+a(o.language)+")",9,Xt))),128))],512),[[Be,B.value]]),e[40]||(e[40]=t("p",{class:"text-xs text-gray-500 mt-1"},"Si el contacto no te ha escrito en 24h, DEBES user una plantilla.",-1))]),t("button",{onClick:q,disabled:M.value||!w.value,class:"w-full py-2.5 bg-emerald-600 hover:bg-emerald-700 text-white font-medium rounded-lg shadow-md transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[M.value?(r(),l("span",ts)):c("",!0),ze(" "+a(M.value?"Iniciando...":"Iniciar Chat"),1)],8,es)])])])):c("",!0)]),_:1})],64))}};export{is as default};
