import{E as Ha,e as Fa,p as Oe,f as P0,G as G1,H as be,B as Da,I as qa,c as N0,a as We,b as Z,d as se,u as $e,h as Xa,t as G0,w as P1,l as U1,q as De,k as pe,v as Ie,F as Se,r as ke,n as Re,J as Je,y as j1,x as ge,K as Ya,s as Ga,o as O0,j as Pa}from"./app-C7EbkmSA.js";import{_ as Ua}from"./_plugin-vue_export-helper-DlAUqK2U.js";var qe={},e1,K1;function $0(){if(K1)return e1;K1=1;function _(A){return new Int8Array(A)}function p(A){return new Int16Array(A)}function r0(A){return new Int32Array(A)}function K(A){return new Float32Array(A)}function n0(A){return new Float64Array(A)}function $(A){if(A.length==1)return K(A[0]);var c=A[0];A=A.slice(1);for(var H=[],r=0;r<c;r++)H.push($(A));return H}function Y(A){if(A.length==1)return r0(A[0]);var c=A[0];A=A.slice(1);for(var H=[],r=0;r<c;r++)H.push(Y(A));return H}function J(A){if(A.length==1)return p(A[0]);var c=A[0];A=A.slice(1);for(var H=[],r=0;r<c;r++)H.push(J(A));return H}function L(A){if(A.length==1)return new Array(A[0]);var c=A[0];A=A.slice(1);for(var H=[],r=0;r<c;r++)H.push(L(A));return H}var U={};U.fill=function(A,c,H,r){if(arguments.length==2)for(var V=0;V<A.length;V++)A[V]=arguments[1];else for(var V=c;V<H;V++)A[V]=r};var k={};k.arraycopy=function(A,c,H,r,V){for(var y=c+V;c<y;)H[r++]=A[c++]},k.out={},k.out.println=function(A){console.log(A)},k.out.printf=function(){console.log.apply(console,arguments)};var E={};E.SQRT2=1.4142135623730951,E.FAST_LOG10=function(A){return Math.log10(A)},E.FAST_LOG10_X=function(A,c){return Math.log10(A)*c};function I(A){this.ordinal=A}I.short_block_allowed=new I(0),I.short_block_coupled=new I(1),I.short_block_dispensed=new I(2),I.short_block_forced=new I(3);var a0={};a0.MAX_VALUE=34028235e31;function e0(A){this.ordinal=A}e0.vbr_off=new e0(0),e0.vbr_mt=new e0(1),e0.vbr_rh=new e0(2),e0.vbr_abr=new e0(3),e0.vbr_mtrh=new e0(4),e0.vbr_default=e0.vbr_mtrh;var S=function(A){};return e1={System:k,VbrMode:e0,Float:a0,ShortBlock:I,Util:E,Arrays:U,new_array_n:L,new_byte:_,new_double:n0,new_float:K,new_float_n:$,new_int:r0,new_int_n:Y,new_short:p,new_short_n:J,assert:S},e1}var a1,Z1;function ja(){if(Z1)return a1;Z1=1;var _=$0(),p=_.System;_.VbrMode,_.Float,_.ShortBlock;var r0=_.Util,K=_.Arrays;_.new_array_n,_.new_byte,_.new_double;var n0=_.new_float;_.new_float_n,_.new_int,_.new_int_n,_.assert;var $=ie();function Y(){var J=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*r0.SQRT2*.5/2384e-9,.017876148*r0.SQRT2*.5/2384e-9,.003134727*r0.SQRT2*.5/2384e-9,.002457142*r0.SQRT2*.5/2384e-9,971317e-9*r0.SQRT2*.5/2384e-9,218868e-9*r0.SQRT2*.5/2384e-9,101566e-9*r0.SQRT2*.5/2384e-9,13828e-9*r0.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],L=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],U=L[$.SHORT_TYPE],k=L[$.SHORT_TYPE],E=L[$.SHORT_TYPE],I=L[$.SHORT_TYPE],a0=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function e0(c,H,r){for(var V=10,y=H+238-14-286,Q=-15;Q<0;Q++){var D,O,l0;D=J[V+-10],O=c[y+-224]*D,l0=c[H+224]*D,D=J[V+-9],O+=c[y+-160]*D,l0+=c[H+160]*D,D=J[V+-8],O+=c[y+-96]*D,l0+=c[H+96]*D,D=J[V+-7],O+=c[y+-32]*D,l0+=c[H+32]*D,D=J[V+-6],O+=c[y+32]*D,l0+=c[H+-32]*D,D=J[V+-5],O+=c[y+96]*D,l0+=c[H+-96]*D,D=J[V+-4],O+=c[y+160]*D,l0+=c[H+-160]*D,D=J[V+-3],O+=c[y+224]*D,l0+=c[H+-224]*D,D=J[V+-2],O+=c[H+-256]*D,l0-=c[y+256]*D,D=J[V+-1],O+=c[H+-192]*D,l0-=c[y+192]*D,D=J[V+0],O+=c[H+-128]*D,l0-=c[y+128]*D,D=J[V+1],O+=c[H+-64]*D,l0-=c[y+64]*D,D=J[V+2],O+=c[H+0]*D,l0-=c[y+0]*D,D=J[V+3],O+=c[H+64]*D,l0-=c[y+-64]*D,D=J[V+4],O+=c[H+128]*D,l0-=c[y+-128]*D,D=J[V+5],O+=c[H+192]*D,l0-=c[y+-192]*D,O*=J[V+6],D=l0-O,r[30+Q*2]=l0+O,r[31+Q*2]=J[V+7]*D,V+=18,H--,y++}{var O,l0,h0,W;l0=c[H+-16]*J[V+-10],O=c[H+-32]*J[V+-2],l0+=(c[H+-48]-c[H+16])*J[V+-9],O+=c[H+-96]*J[V+-1],l0+=(c[H+-80]+c[H+48])*J[V+-8],O+=c[H+-160]*J[V+0],l0+=(c[H+-112]-c[H+80])*J[V+-7],O+=c[H+-224]*J[V+1],l0+=(c[H+-144]+c[H+112])*J[V+-6],O-=c[H+32]*J[V+2],l0+=(c[H+-176]-c[H+144])*J[V+-5],O-=c[H+96]*J[V+3],l0+=(c[H+-208]+c[H+176])*J[V+-4],O-=c[H+160]*J[V+4],l0+=(c[H+-240]-c[H+208])*J[V+-3],O-=c[H+224],h0=O-l0,W=O+l0,l0=r[14],O=r[15]-l0,r[31]=W+l0,r[30]=h0+O,r[15]=h0-O,r[14]=W-l0}{var m;m=r[28]-r[0],r[0]+=r[28],r[28]=m*J[V+-36+7],m=r[29]-r[1],r[1]+=r[29],r[29]=m*J[V+-36+7],m=r[26]-r[2],r[2]+=r[26],r[26]=m*J[V+-72+7],m=r[27]-r[3],r[3]+=r[27],r[27]=m*J[V+-72+7],m=r[24]-r[4],r[4]+=r[24],r[24]=m*J[V+-108+7],m=r[25]-r[5],r[5]+=r[25],r[25]=m*J[V+-108+7],m=r[22]-r[6],r[6]+=r[22],r[22]=m*r0.SQRT2,m=r[23]-r[7],r[7]+=r[23],r[23]=m*r0.SQRT2-r[7],r[7]-=r[6],r[22]-=r[7],r[23]-=r[22],m=r[6],r[6]=r[31]-m,r[31]=r[31]+m,m=r[7],r[7]=r[30]-m,r[30]=r[30]+m,m=r[22],r[22]=r[15]-m,r[15]=r[15]+m,m=r[23],r[23]=r[14]-m,r[14]=r[14]+m,m=r[20]-r[8],r[8]+=r[20],r[20]=m*J[V+-180+7],m=r[21]-r[9],r[9]+=r[21],r[21]=m*J[V+-180+7],m=r[18]-r[10],r[10]+=r[18],r[18]=m*J[V+-216+7],m=r[19]-r[11],r[11]+=r[19],r[19]=m*J[V+-216+7],m=r[16]-r[12],r[12]+=r[16],r[16]=m*J[V+-252+7],m=r[17]-r[13],r[13]+=r[17],r[17]=m*J[V+-252+7],m=-r[20]+r[24],r[20]+=r[24],r[24]=m*J[V+-216+7],m=-r[21]+r[25],r[21]+=r[25],r[25]=m*J[V+-216+7],m=r[4]-r[8],r[4]+=r[8],r[8]=m*J[V+-216+7],m=r[5]-r[9],r[5]+=r[9],r[9]=m*J[V+-216+7],m=r[0]-r[12],r[0]+=r[12],r[12]=m*J[V+-72+7],m=r[1]-r[13],r[1]+=r[13],r[13]=m*J[V+-72+7],m=r[16]-r[28],r[16]+=r[28],r[28]=m*J[V+-72+7],m=-r[17]+r[29],r[17]+=r[29],r[29]=m*J[V+-72+7],m=r0.SQRT2*(r[2]-r[10]),r[2]+=r[10],r[10]=m,m=r0.SQRT2*(r[3]-r[11]),r[3]+=r[11],r[11]=m,m=r0.SQRT2*(-r[18]+r[26]),r[18]+=r[26],r[26]=m-r[18],m=r0.SQRT2*(-r[19]+r[27]),r[19]+=r[27],r[27]=m-r[19],m=r[2],r[19]-=r[3],r[3]-=m,r[2]=r[31]-m,r[31]+=m,m=r[3],r[11]-=r[19],r[18]-=m,r[3]=r[30]-m,r[30]+=m,m=r[18],r[27]-=r[11],r[19]-=m,r[18]=r[15]-m,r[15]+=m,m=r[19],r[10]-=m,r[19]=r[14]-m,r[14]+=m,m=r[10],r[11]-=m,r[10]=r[23]-m,r[23]+=m,m=r[11],r[26]-=m,r[11]=r[22]-m,r[22]+=m,m=r[26],r[27]-=m,r[26]=r[7]-m,r[7]+=m,m=r[27],r[27]=r[6]-m,r[6]+=m,m=r0.SQRT2*(r[0]-r[4]),r[0]+=r[4],r[4]=m,m=r0.SQRT2*(r[1]-r[5]),r[1]+=r[5],r[5]=m,m=r0.SQRT2*(r[16]-r[20]),r[16]+=r[20],r[20]=m,m=r0.SQRT2*(r[17]-r[21]),r[17]+=r[21],r[21]=m,m=-r0.SQRT2*(r[8]-r[12]),r[8]+=r[12],r[12]=m-r[8],m=-r0.SQRT2*(r[9]-r[13]),r[9]+=r[13],r[13]=m-r[9],m=-r0.SQRT2*(r[25]-r[29]),r[25]+=r[29],r[29]=m-r[25],m=-r0.SQRT2*(r[24]+r[28]),r[24]-=r[28],r[28]=m-r[24],m=r[24]-r[16],r[24]=m,m=r[20]-m,r[20]=m,m=r[28]-m,r[28]=m,m=r[25]-r[17],r[25]=m,m=r[21]-m,r[21]=m,m=r[29]-m,r[29]=m,m=r[17]-r[1],r[17]=m,m=r[9]-m,r[9]=m,m=r[25]-m,r[25]=m,m=r[5]-m,r[5]=m,m=r[21]-m,r[21]=m,m=r[13]-m,r[13]=m,m=r[29]-m,r[29]=m,m=r[1]-r[0],r[1]=m,m=r[16]-m,r[16]=m,m=r[17]-m,r[17]=m,m=r[8]-m,r[8]=m,m=r[9]-m,r[9]=m,m=r[24]-m,r[24]=m,m=r[25]-m,r[25]=m,m=r[4]-m,r[4]=m,m=r[5]-m,r[5]=m,m=r[20]-m,r[20]=m,m=r[21]-m,r[21]=m,m=r[12]-m,r[12]=m,m=r[13]-m,r[13]=m,m=r[28]-m,r[28]=m,m=r[29]-m,r[29]=m,m=r[0],r[0]+=r[31],r[31]-=m,m=r[1],r[1]+=r[30],r[30]-=m,m=r[16],r[16]+=r[15],r[15]-=m,m=r[17],r[17]+=r[14],r[14]-=m,m=r[8],r[8]+=r[23],r[23]-=m,m=r[9],r[9]+=r[22],r[22]-=m,m=r[24],r[24]+=r[7],r[7]-=m,m=r[25],r[25]+=r[6],r[6]-=m,m=r[4],r[4]+=r[27],r[27]-=m,m=r[5],r[5]+=r[26],r[26]-=m,m=r[20],r[20]+=r[11],r[11]-=m,m=r[21],r[21]+=r[10],r[10]-=m,m=r[12],r[12]+=r[19],r[19]-=m,m=r[13],r[13]+=r[18],r[18]-=m,m=r[28],r[28]+=r[3],r[3]-=m,m=r[29],r[29]+=r[2],r[2]-=m}}function S(c,H){for(var r=0;r<3;r++){var V,y,Q,D,O,l0;D=c[H+6]*L[$.SHORT_TYPE][0]-c[H+15],V=c[H+0]*L[$.SHORT_TYPE][2]-c[H+9],y=D+V,Q=D-V,D=c[H+15]*L[$.SHORT_TYPE][0]+c[H+6],V=c[H+9]*L[$.SHORT_TYPE][2]+c[H+0],O=D+V,l0=-D+V,V=(c[H+3]*L[$.SHORT_TYPE][1]-c[H+12])*2069978111953089e-26,D=(c[H+12]*L[$.SHORT_TYPE][1]+c[H+3])*2069978111953089e-26,c[H+0]=y*190752519173728e-25+V,c[H+15]=-O*190752519173728e-25+D,Q=Q*.8660254037844387*1907525191737281e-26,O=O*.5*1907525191737281e-26+D,c[H+3]=Q-O,c[H+6]=Q+O,y=y*.5*1907525191737281e-26-V,l0=l0*.8660254037844387*1907525191737281e-26,c[H+9]=y+l0,c[H+12]=y-l0,H++}}function A(c,H,r){var V,y;{var Q,D,O,l0,h0,W,m,y0;Q=r[17]-r[9],O=r[15]-r[11],l0=r[14]-r[12],h0=r[0]+r[8],W=r[1]+r[7],m=r[2]+r[6],y0=r[3]+r[5],c[H+17]=h0+m-y0-(W-r[4]),y=(h0+m-y0)*k[19]+(W-r[4]),V=(Q-O-l0)*k[18],c[H+5]=V+y,c[H+6]=V-y,D=(r[16]-r[10])*k[18],W=W*k[19]+r[4],V=Q*k[12]+D+O*k[13]+l0*k[14],y=-h0*k[16]+W-m*k[17]+y0*k[15],c[H+1]=V+y,c[H+2]=V-y,V=Q*k[13]-D-O*k[14]+l0*k[12],y=-h0*k[17]+W-m*k[15]+y0*k[16],c[H+9]=V+y,c[H+10]=V-y,V=Q*k[14]-D+O*k[12]-l0*k[13],y=h0*k[15]-W+m*k[16]-y0*k[17],c[H+13]=V+y,c[H+14]=V-y}{var N,R,l,d,B,C,h,e;N=r[8]-r[0],l=r[6]-r[2],d=r[5]-r[3],B=r[17]+r[9],C=r[16]+r[10],h=r[15]+r[11],e=r[14]+r[12],c[H+0]=B+h+e+(C+r[13]),V=(B+h+e)*k[19]-(C+r[13]),y=(N-l+d)*k[18],c[H+11]=V+y,c[H+12]=V-y,R=(r[7]-r[1])*k[18],C=r[13]-C*k[19],V=B*k[15]-C+h*k[16]+e*k[17],y=N*k[14]+R+l*k[12]+d*k[13],c[H+3]=V+y,c[H+4]=V-y,V=-B*k[17]+C-h*k[15]-e*k[16],y=N*k[13]+R-l*k[14]-d*k[12],c[H+7]=V+y,c[H+8]=V-y,V=-B*k[16]+C-h*k[17]-e*k[15],y=N*k[12]-R+l*k[13]-d*k[14],c[H+15]=V+y,c[H+16]=V-y}}this.mdct_sub48=function(c,H,r){for(var V=H,y=286,Q=0;Q<c.channels_out;Q++){for(var D=0;D<c.mode_gr;D++){for(var O,l0=c.l3_side.tt[D][Q],h0=l0.xr,W=0,m=c.sb_sample[Q][1-D],y0=0,N=0;N<18/2;N++)for(e0(V,y,m[y0]),e0(V,y+32,m[y0+1]),y0+=2,y+=64,O=1;O<32;O+=2)m[y0-1][O]*=-1;for(O=0;O<32;O++,W+=18){var R=l0.block_type,l=c.sb_sample[Q][D],d=c.sb_sample[Q][1-D];if(l0.mixed_block_flag!=0&&O<2&&(R=0),c.amp_filter[O]<1e-12)K.fill(h0,W+0,W+18,0);else{if(c.amp_filter[O]<1)for(var N=0;N<18;N++)d[N][a0[O]]*=c.amp_filter[O];if(R==$.SHORT_TYPE){for(var N=-12/4;N<0;N++){var B=L[$.SHORT_TYPE][N+3];h0[W+N*3+9]=l[9+N][a0[O]]*B-l[8-N][a0[O]],h0[W+N*3+18]=l[14-N][a0[O]]*B+l[15+N][a0[O]],h0[W+N*3+10]=l[15+N][a0[O]]*B-l[14-N][a0[O]],h0[W+N*3+19]=d[2-N][a0[O]]*B+d[3+N][a0[O]],h0[W+N*3+11]=d[3+N][a0[O]]*B-d[2-N][a0[O]],h0[W+N*3+20]=d[8-N][a0[O]]*B+d[9+N][a0[O]]}S(h0,W)}else{for(var C=n0(18),N=-36/4;N<0;N++){var h,e;h=L[R][N+27]*d[N+9][a0[O]]+L[R][N+36]*d[8-N][a0[O]],e=L[R][N+9]*l[N+9][a0[O]]-L[R][N+18]*l[8-N][a0[O]],C[N+9]=h-e*U[3+N+9],C[N+18]=h*U[3+N+9]+e}A(h0,W,C)}}if(R!=$.SHORT_TYPE&&O!=0)for(var N=7;N>=0;--N){var t,a;t=h0[W+N]*E[20+N]+h0[W+-1-N]*I[28+N],a=h0[W+N]*I[28+N]-h0[W+-1-N]*E[20+N],h0[W+-1-N]=t,h0[W+N]=a}}}if(V=r,y=286,c.mode_gr==1)for(var n=0;n<18;n++)p.arraycopy(c.sb_sample[Q][1][n],0,c.sb_sample[Q][0][n],0,32)}}}return a1=Y,a1}var t1,z1;function Ba(){if(z1)return t1;z1=1;var _=ie(),p=$0(),r0=p.System;p.VbrMode,p.Float,p.ShortBlock,p.Util,p.Arrays,p.new_array_n,p.new_byte,p.new_double;var K=p.new_float,n0=p.new_float_n;p.new_int,p.new_int_n,p.assert;function $(){this.l=K(_.SBMAX_l),this.s=n0([_.SBMAX_s,3]);var Y=this;this.assign=function(J){r0.arraycopy(J.l,0,Y.l,0,_.SBMAX_l);for(var L=0;L<_.SBMAX_s;L++)for(var U=0;U<3;U++)Y.s[L][U]=J.s[L][U]}}return t1=$,t1}var r1,Q1;function Ka(){if(Q1)return r1;Q1=1;var _=Ba();function p(){this.thm=new _,this.en=new _}return r1=p,r1}var s1,W1;function ie(){if(W1)return s1;W1=1;var _=$0(),p=_.System,r0=_.VbrMode;_.Float,_.ShortBlock,_.Util,_.Arrays;var K=_.new_array_n;_.new_byte,_.new_double;var n0=_.new_float,$=_.new_float_n,Y=_.new_int;_.new_int_n;var J=_.assert;L.ENCDELAY=576,L.POSTDELAY=1152,L.MDCTDELAY=48,L.FFTOFFSET=224+L.MDCTDELAY,L.DECDELAY=528,L.SBLIMIT=32,L.CBANDS=64,L.SBPSY_l=21,L.SBPSY_s=12,L.SBMAX_l=22,L.SBMAX_s=13,L.PSFB21=6,L.PSFB12=6,L.BLKSIZE=1024,L.HBLKSIZE=L.BLKSIZE/2+1,L.BLKSIZE_s=256,L.HBLKSIZE_s=L.BLKSIZE_s/2+1,L.NORM_TYPE=0,L.START_TYPE=1,L.SHORT_TYPE=2,L.STOP_TYPE=3,L.MPG_MD_LR_LR=0,L.MPG_MD_LR_I=1,L.MPG_MD_MS_LR=2,L.MPG_MD_MS_I=3,L.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function L(){var U=ja(),k=Ka(),E=L.FFTOFFSET,I=L.MPG_MD_MS_LR,a0=null;this.psy=null;var e0=null,S=null,A=null;this.setModules=function(y,Q,D,O){a0=y,this.psy=Q,e0=Q,S=O,A=D};var c=new U;function H(y){var Q,D;if(y.ATH.useAdjust==0){y.ATH.adjust=1;return}if(D=y.loudness_sq[0][0],Q=y.loudness_sq[1][0],y.channels_out==2?(D+=y.loudness_sq[0][1],Q+=y.loudness_sq[1][1]):(D+=D,Q+=Q),y.mode_gr==2&&(D=Math.max(D,Q)),D*=.5,D*=y.ATH.aaSensitivityP,D>.03125)y.ATH.adjust>=1?y.ATH.adjust=1:y.ATH.adjust<y.ATH.adjustLimit&&(y.ATH.adjust=y.ATH.adjustLimit),y.ATH.adjustLimit=1;else{var O=31.98*D+625e-6;y.ATH.adjust>=O?(y.ATH.adjust*=O*.075+.925,y.ATH.adjust<O&&(y.ATH.adjust=O)):y.ATH.adjustLimit>=O?y.ATH.adjust=O:y.ATH.adjust<y.ATH.adjustLimit&&(y.ATH.adjust=y.ATH.adjustLimit),y.ATH.adjustLimit=O}}function r(y){var Q,D;for(J(0<=y.bitrate_index&&y.bitrate_index<16),J(0<=y.mode_ext&&y.mode_ext<4),y.bitrate_stereoMode_Hist[y.bitrate_index][4]++,y.bitrate_stereoMode_Hist[15][4]++,y.channels_out==2&&(y.bitrate_stereoMode_Hist[y.bitrate_index][y.mode_ext]++,y.bitrate_stereoMode_Hist[15][y.mode_ext]++),Q=0;Q<y.mode_gr;++Q)for(D=0;D<y.channels_out;++D){var O=y.l3_side.tt[Q][D].block_type|0;y.l3_side.tt[Q][D].mixed_block_flag!=0&&(O=4),y.bitrate_blockType_Hist[y.bitrate_index][O]++,y.bitrate_blockType_Hist[y.bitrate_index][5]++,y.bitrate_blockType_Hist[15][O]++,y.bitrate_blockType_Hist[15][5]++}}function V(y,Q){var D=y.internal_flags,O,l0;if(D.lame_encode_frame_init==0){var h0,W,m=n0(2014),y0=n0(2014);for(D.lame_encode_frame_init=1,h0=0,W=0;h0<286+576*(1+D.mode_gr);++h0)h0<576*D.mode_gr?(m[h0]=0,D.channels_out==2&&(y0[h0]=0)):(m[h0]=Q[0][W],D.channels_out==2&&(y0[h0]=Q[1][W]),++W);for(l0=0;l0<D.mode_gr;l0++)for(O=0;O<D.channels_out;O++)D.l3_side.tt[l0][O].block_type=L.SHORT_TYPE;c.mdct_sub48(D,m,y0),J(576>=L.FFTOFFSET),J(D.mf_size>=L.BLKSIZE+y.framesize-L.FFTOFFSET),J(D.mf_size>=512+y.framesize-32)}}this.lame_encode_mp3_frame=function(y,Q,D,O,l0,h0){var W,m=K([2,2]);m[0][0]=new k,m[0][1]=new k,m[1][0]=new k,m[1][1]=new k;var y0=K([2,2]);y0[0][0]=new k,y0[0][1]=new k,y0[1][0]=new k,y0[1][1]=new k;var N,R=[null,null],l=y.internal_flags,d=$([2,4]),B=[.5,.5],C=[[0,0],[0,0]],h=[[0,0],[0,0]],e,t,a;if(R[0]=Q,R[1]=D,l.lame_encode_frame_init==0&&V(y,R),l.padding=0,(l.slot_lag-=l.frac_SpF)<0&&(l.slot_lag+=y.out_samplerate,l.padding=1),l.psymodel!=0){var n,v=[null,null],b=0,M=Y(2);for(a=0;a<l.mode_gr;a++){for(t=0;t<l.channels_out;t++)v[t]=R[t],b=576+a*576-L.FFTOFFSET;if(y.VBR==r0.vbr_mtrh||y.VBR==r0.vbr_mt?n=e0.L3psycho_anal_vbr(y,v,b,a,m,y0,C[a],h[a],d[a],M):n=e0.L3psycho_anal_ns(y,v,b,a,m,y0,C[a],h[a],d[a],M),n!=0)return-4;for(y.mode==MPEGMode.JOINT_STEREO&&(B[a]=d[a][2]+d[a][3],B[a]>0&&(B[a]=d[a][3]/B[a])),t=0;t<l.channels_out;t++){var f=l.l3_side.tt[a][t];f.block_type=M[t],f.mixed_block_flag=0}}}else for(a=0;a<l.mode_gr;a++)for(t=0;t<l.channels_out;t++)l.l3_side.tt[a][t].block_type=L.NORM_TYPE,l.l3_side.tt[a][t].mixed_block_flag=0,h[a][t]=C[a][t]=700;if(H(l),c.mdct_sub48(l,R[0],R[1]),l.mode_ext=L.MPG_MD_LR_LR,y.force_ms)l.mode_ext=L.MPG_MD_MS_LR;else if(y.mode==MPEGMode.JOINT_STEREO){var F=0,P=0;for(a=0;a<l.mode_gr;a++)for(t=0;t<l.channels_out;t++)F+=h[a][t],P+=C[a][t];if(F<=1*P){var o0=l.l3_side.tt[0],c0=l.l3_side.tt[l.mode_gr-1];o0[0].block_type==o0[1].block_type&&c0[0].block_type==c0[1].block_type&&(l.mode_ext=L.MPG_MD_MS_LR)}}if(l.mode_ext==I?(N=y0,e=h):(N=m,e=C),y.analysis&&l.pinfo!=null)for(a=0;a<l.mode_gr;a++)for(t=0;t<l.channels_out;t++)l.pinfo.ms_ratio[a]=l.ms_ratio[a],l.pinfo.ms_ener_ratio[a]=B[a],l.pinfo.blocktype[a][t]=l.l3_side.tt[a][t].block_type,l.pinfo.pe[a][t]=e[a][t],p.arraycopy(l.l3_side.tt[a][t].xr,0,l.pinfo.xr[a][t],0,576),l.mode_ext==I&&(l.pinfo.ers[a][t]=l.pinfo.ers[a][t+2],p.arraycopy(l.pinfo.energy[a][t+2],0,l.pinfo.energy[a][t],0,l.pinfo.energy[a][t].length));if(y.VBR==r0.vbr_off||y.VBR==r0.vbr_abr){var d0,b0;for(d0=0;d0<18;d0++)l.nsPsy.pefirbuf[d0]=l.nsPsy.pefirbuf[d0+1];for(b0=0,a=0;a<l.mode_gr;a++)for(t=0;t<l.channels_out;t++)b0+=e[a][t];for(l.nsPsy.pefirbuf[18]=b0,b0=l.nsPsy.pefirbuf[9],d0=0;d0<9;d0++)b0+=(l.nsPsy.pefirbuf[d0]+l.nsPsy.pefirbuf[18-d0])*L.fircoef[d0];for(b0=670*5*l.mode_gr*l.channels_out/b0,a=0;a<l.mode_gr;a++)for(t=0;t<l.channels_out;t++)e[a][t]*=b0}if(l.iteration_loop.iteration_loop(y,e,B,N),a0.format_bitstream(y),W=a0.copy_buffer(l,O,l0,h0,1),y.bWriteVbrTag&&S.addVbrFrame(y),y.analysis&&l.pinfo!=null){for(t=0;t<l.channels_out;t++){var S0;for(S0=0;S0<E;S0++)l.pinfo.pcmdata[t][S0]=l.pinfo.pcmdata[t][S0+y.framesize];for(S0=E;S0<1600;S0++)l.pinfo.pcmdata[t][S0]=R[t][S0-E]}A.set_frame_pinfo(y,N)}return r(l),W}}return s1=L,s1}var n1,$1;function Za(){if($1)return n1;$1=1;var _=$0();_.System,_.VbrMode,_.Float,_.ShortBlock;var p=_.Util;_.Arrays,_.new_array_n,_.new_byte,_.new_double;var r0=_.new_float;_.new_float_n,_.new_int,_.new_int_n,_.assert;var K=ie();function n0(){var $=r0(K.BLKSIZE),Y=r0(K.BLKSIZE_s/2),J=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function L(k,E,I){var a0=0,e0,S,A;I<<=1;var c=E+I;e0=4;do{var H,r,V,y,Q,D,O;O=e0>>1,y=e0,Q=e0<<1,D=Q+y,e0=Q<<1,S=E,A=S+O;do{var l0,h0,W,m;h0=k[S+0]-k[S+y],l0=k[S+0]+k[S+y],m=k[S+Q]-k[S+D],W=k[S+Q]+k[S+D],k[S+Q]=l0-W,k[S+0]=l0+W,k[S+D]=h0-m,k[S+y]=h0+m,h0=k[A+0]-k[A+y],l0=k[A+0]+k[A+y],m=p.SQRT2*k[A+D],W=p.SQRT2*k[A+Q],k[A+Q]=l0-W,k[A+0]=l0+W,k[A+D]=h0-m,k[A+y]=h0+m,A+=e0,S+=e0}while(S<c);for(r=J[a0+0],H=J[a0+1],V=1;V<O;V++){var y0,N;y0=1-2*H*H,N=2*H*r,S=E+V,A=E+y-V;do{var R,l,d,l0,h0,B,W,C,m,h;l=N*k[S+y]-y0*k[A+y],R=y0*k[S+y]+N*k[A+y],h0=k[S+0]-R,l0=k[S+0]+R,B=k[A+0]-l,d=k[A+0]+l,l=N*k[S+D]-y0*k[A+D],R=y0*k[S+D]+N*k[A+D],m=k[S+Q]-R,W=k[S+Q]+R,h=k[A+Q]-l,C=k[A+Q]+l,l=H*W-r*h,R=r*W+H*h,k[S+Q]=l0-R,k[S+0]=l0+R,k[A+D]=B-l,k[A+y]=B+l,l=r*C-H*m,R=H*C+r*m,k[A+Q]=d-R,k[A+0]=d+R,k[S+D]=h0-l,k[S+y]=h0+l,A+=e0,S+=e0}while(S<c);y0=r,r=y0*J[a0+0]-H*J[a0+1],H=y0*J[a0+1]+H*J[a0+0]}a0+=2}while(e0<I)}var U=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(k,E,I,a0,e0){for(var S=0;S<3;S++){var A=K.BLKSIZE_s/2,c=65535&576/3*(S+1),H=K.BLKSIZE_s/8-1;do{var r,V,y,Q,D,O=U[H<<2]&255;r=Y[O]*a0[I][e0+O+c],D=Y[127-O]*a0[I][e0+O+c+128],V=r-D,r=r+D,y=Y[O+64]*a0[I][e0+O+c+64],D=Y[63-O]*a0[I][e0+O+c+192],Q=y-D,y=y+D,A-=4,E[S][A+0]=r+y,E[S][A+2]=r-y,E[S][A+1]=V+Q,E[S][A+3]=V-Q,r=Y[O+1]*a0[I][e0+O+c+1],D=Y[126-O]*a0[I][e0+O+c+129],V=r-D,r=r+D,y=Y[O+65]*a0[I][e0+O+c+65],D=Y[62-O]*a0[I][e0+O+c+193],Q=y-D,y=y+D,E[S][A+K.BLKSIZE_s/2+0]=r+y,E[S][A+K.BLKSIZE_s/2+2]=r-y,E[S][A+K.BLKSIZE_s/2+1]=V+Q,E[S][A+K.BLKSIZE_s/2+3]=V-Q}while(--H>=0);L(E[S],A,K.BLKSIZE_s/2)}},this.fft_long=function(k,E,I,a0,e0){var S=K.BLKSIZE/8-1,A=K.BLKSIZE/2;do{var c,H,r,V,y,Q=U[S]&255;c=$[Q]*a0[I][e0+Q],y=$[Q+512]*a0[I][e0+Q+512],H=c-y,c=c+y,r=$[Q+256]*a0[I][e0+Q+256],y=$[Q+768]*a0[I][e0+Q+768],V=r-y,r=r+y,A-=4,E[A+0]=c+r,E[A+2]=c-r,E[A+1]=H+V,E[A+3]=H-V,c=$[Q+1]*a0[I][e0+Q+1],y=$[Q+513]*a0[I][e0+Q+513],H=c-y,c=c+y,r=$[Q+257]*a0[I][e0+Q+257],y=$[Q+769]*a0[I][e0+Q+769],V=r-y,r=r+y,E[A+K.BLKSIZE/2+0]=c+r,E[A+K.BLKSIZE/2+2]=c-r,E[A+K.BLKSIZE/2+1]=H+V,E[A+K.BLKSIZE/2+3]=H-V}while(--S>=0);L(E,A,K.BLKSIZE/2)},this.init_fft=function(k){for(var E=0;E<K.BLKSIZE;E++)$[E]=.42-.5*Math.cos(2*Math.PI*(E+.5)/K.BLKSIZE)+.08*Math.cos(4*Math.PI*(E+.5)/K.BLKSIZE);for(var E=0;E<K.BLKSIZE_s/2;E++)Y[E]=.5*(1-Math.cos(2*Math.PI*(E+.5)/K.BLKSIZE_s))}}return n1=n0,n1}var i1,J1;function za(){if(J1)return i1;J1=1;var _=$0();_.System;var p=_.VbrMode,r0=_.Float,K=_.ShortBlock,n0=_.Util,$=_.Arrays;_.new_array_n,_.new_byte,_.new_double;var Y=_.new_float,J=_.new_float_n,L=_.new_int;_.new_int_n;var U=_.assert,k=Za(),E=ie();function I(){var a0=new k,e0=2.302585092994046,S=2,A=16,c=2,H=16,r=.34,V=1/(14752*14752)/(E.BLKSIZE/2),y=.01,Q=.8,D=.6,O=.3,l0=3.5,h0=21,W=.2302585093;function m(s){return s}function y0(s,i){for(var w=0,T=0;T<E.BLKSIZE/2;++T)w+=s[T]*i.ATH.eql_w[T];return w*=V,w}function N(s,i,w,T,G,x,X,j,q,s0,z){var i0=s.internal_flags;if(q<2)a0.fft_long(i0,T[G],q,s0,z),a0.fft_short(i0,x[X],q,s0,z);else if(q==2){for(var f0=E.BLKSIZE-1;f0>=0;--f0){var B0=T[G+0][f0],_0=T[G+1][f0];T[G+0][f0]=(B0+_0)*n0.SQRT2*.5,T[G+1][f0]=(B0-_0)*n0.SQRT2*.5}for(var I0=2;I0>=0;--I0)for(var f0=E.BLKSIZE_s-1;f0>=0;--f0){var B0=x[X+0][I0][f0],_0=x[X+1][I0][f0];x[X+0][I0][f0]=(B0+_0)*n0.SQRT2*.5,x[X+1][I0][f0]=(B0-_0)*n0.SQRT2*.5}}i[0]=T[G+0][0],i[0]*=i[0];for(var f0=E.BLKSIZE/2-1;f0>=0;--f0){var t0=T[G+0][E.BLKSIZE/2-f0],p0=T[G+0][E.BLKSIZE/2+f0];i[E.BLKSIZE/2-f0]=(t0*t0+p0*p0)*.5}for(var I0=2;I0>=0;--I0){w[I0][0]=x[X+0][I0][0],w[I0][0]*=w[I0][0];for(var f0=E.BLKSIZE_s/2-1;f0>=0;--f0){var t0=x[X+0][I0][E.BLKSIZE_s/2-f0],p0=x[X+0][I0][E.BLKSIZE_s/2+f0];w[I0][E.BLKSIZE_s/2-f0]=(t0*t0+p0*p0)*.5}}{for(var F0=0,f0=11;f0<E.HBLKSIZE;f0++)F0+=i[f0];i0.tot_ener[q]=F0}if(s.analysis){for(var f0=0;f0<E.HBLKSIZE;f0++)i0.pinfo.energy[j][q][f0]=i0.pinfo.energy_save[q][f0],i0.pinfo.energy_save[q][f0]=i[f0];i0.pinfo.pe[j][q]=i0.pe[q]}s.athaa_loudapprox==2&&q<2&&(i0.loudness_sq[j][q]=i0.loudness_sq_save[q],i0.loudness_sq_save[q]=y0(i,i0))}var R=8,l=23,d=15,B,C,h,e=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function t(){B=Math.pow(10,(R+1)/16),C=Math.pow(10,(l+1)/16),h=Math.pow(10,d/10)}var a=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],n=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],v=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function b(s,i,w,T,G,x){var X;if(i>s)if(i<s*C)X=i/s;else return s+i;else{if(s>=i*C)return s+i;X=s/i}if(U(s>=0),U(i>=0),s+=i,T+3<=6){if(X>=B)return s;var j=0|n0.FAST_LOG10_X(X,16);return s*n[j]}var j=0|n0.FAST_LOG10_X(X,16);if(i=G.ATH.cb_l[w]*G.ATH.adjust,U(i>=0),s<h*i){if(s>i){var q,s0;return q=1,j<=13&&(q=v[j]),s0=n0.FAST_LOG10_X(s/i,10/15),s*((a[j]-q)*s0+q)}return j>13?s:s*v[j]}return s*a[j]}var M=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function f(s,i,w){var T;if(s<0&&(s=0),i<0&&(i=0),s<=0)return i;if(i<=0)return s;if(i>s?T=i/s:T=s/i,-2<=w&&w<=2){if(T>=B)return s+i;var G=0|n0.FAST_LOG10_X(T,16);return(s+i)*M[G]}return T<C?s+i:(s<i&&(s=i),s)}function F(s,i){var w=s.internal_flags;if(w.channels_out>1){for(var T=0;T<E.SBMAX_l;T++){var G=w.thm[0].l[T],x=w.thm[1].l[T];w.thm[0].l[T]+=x*i,w.thm[1].l[T]+=G*i}for(var T=0;T<E.SBMAX_s;T++)for(var X=0;X<3;X++){var G=w.thm[0].s[T][X],x=w.thm[1].s[T][X];w.thm[0].s[T][X]+=x*i,w.thm[1].s[T][X]+=G*i}}}function P(s){for(var i=0;i<E.SBMAX_l;i++)if(!(s.thm[0].l[i]>1.58*s.thm[1].l[i]||s.thm[1].l[i]>1.58*s.thm[0].l[i])){var w=s.mld_l[i]*s.en[3].l[i],T=Math.max(s.thm[2].l[i],Math.min(s.thm[3].l[i],w));w=s.mld_l[i]*s.en[2].l[i];var G=Math.max(s.thm[3].l[i],Math.min(s.thm[2].l[i],w));s.thm[2].l[i]=T,s.thm[3].l[i]=G}for(var i=0;i<E.SBMAX_s;i++)for(var x=0;x<3;x++)if(!(s.thm[0].s[i][x]>1.58*s.thm[1].s[i][x]||s.thm[1].s[i][x]>1.58*s.thm[0].s[i][x])){var w=s.mld_s[i]*s.en[3].s[i][x],T=Math.max(s.thm[2].s[i][x],Math.min(s.thm[3].s[i][x],w));w=s.mld_s[i]*s.en[2].s[i][x];var G=Math.max(s.thm[3].s[i][x],Math.min(s.thm[2].s[i][x],w));s.thm[2].s[i][x]=T,s.thm[3].s[i][x]=G}}function o0(s,i,w){var T=i,G=Math.pow(10,w);i*=2,T*=2;for(var x=0;x<E.SBMAX_l;x++){var X,j,q,s0;if(s0=s.ATH.cb_l[s.bm_l[x]]*G,X=Math.min(Math.max(s.thm[0].l[x],s0),Math.max(s.thm[1].l[x],s0)),j=Math.max(s.thm[2].l[x],s0),q=Math.max(s.thm[3].l[x],s0),X*i<j+q){var z=X*T/(j+q);j*=z,q*=z,U(j+q>0)}s.thm[2].l[x]=Math.min(j,s.thm[2].l[x]),s.thm[3].l[x]=Math.min(q,s.thm[3].l[x])}G*=E.BLKSIZE_s/E.BLKSIZE;for(var x=0;x<E.SBMAX_s;x++)for(var i0=0;i0<3;i0++){var X,j,q,s0;if(s0=s.ATH.cb_s[s.bm_s[x]]*G,X=Math.min(Math.max(s.thm[0].s[x][i0],s0),Math.max(s.thm[1].s[x][i0],s0)),j=Math.max(s.thm[2].s[x][i0],s0),q=Math.max(s.thm[3].s[x][i0],s0),X*i<j+q){var z=X*i/(j+q);j*=z,q*=z,U(j+q>0)}s.thm[2].s[x][i0]=Math.min(s.thm[2].s[x][i0],j),s.thm[3].s[x][i0]=Math.min(s.thm[3].s[x][i0],q)}}function c0(s,i,w,T,G){var x,X,j=0,q=0;for(x=X=0;x<E.SBMAX_s;++X,++x){for(var s0=s.bo_s[x],z=s.npart_s,i0=s0<z?s0:z;X<i0;)U(i[X]>=0),U(w[X]>=0),j+=i[X],q+=w[X],X++;if(s.en[T].s[x][G]=j,s.thm[T].s[x][G]=q,X>=z){++x;break}U(i[X]>=0),U(w[X]>=0);{var f0=s.PSY.bo_s_weight[x],B0=1-f0;j=f0*i[X],q=f0*w[X],s.en[T].s[x][G]+=j,s.thm[T].s[x][G]+=q,j=B0*i[X],q=B0*w[X]}}for(;x<E.SBMAX_s;++x)s.en[T].s[x][G]=0,s.thm[T].s[x][G]=0}function d0(s,i,w,T){var G,x,X=0,j=0;for(G=x=0;G<E.SBMAX_l;++x,++G){for(var q=s.bo_l[G],s0=s.npart_l,z=q<s0?q:s0;x<z;)U(i[x]>=0),U(w[x]>=0),X+=i[x],j+=w[x],x++;if(s.en[T].l[G]=X,s.thm[T].l[G]=j,x>=s0){++G;break}U(i[x]>=0),U(w[x]>=0);{var i0=s.PSY.bo_l_weight[G],f0=1-i0;X=i0*i[x],j=i0*w[x],s.en[T].l[G]+=X,s.thm[T].l[G]+=j,X=f0*i[x],j=f0*w[x]}}for(;G<E.SBMAX_l;++G)s.en[T].l[G]=0,s.thm[T].l[G]=0}function b0(s,i,w,T,G,x){var X=s.internal_flags,j,q;for(q=j=0;q<X.npart_s;++q){for(var s0=0,z=X.numlines_s[q],i0=0;i0<z;++i0,++j){var f0=i[x][j];s0+=f0}w[q]=s0}for(U(q==X.npart_s),U(j==129),j=q=0;q<X.npart_s;q++){var B0=X.s3ind_s[q][0],_0=X.s3_ss[j++]*w[B0];for(++B0;B0<=X.s3ind_s[q][1];)_0+=X.s3_ss[j]*w[B0],++j,++B0;{var I0=c*X.nb_s1[G][q];T[q]=Math.min(_0,I0)}if(X.blocktype_old[G&1]==E.SHORT_TYPE){var I0=H*X.nb_s2[G][q],t0=T[q];T[q]=Math.min(I0,t0)}X.nb_s2[G][q]=X.nb_s1[G][q],X.nb_s1[G][q]=_0,U(T[q]>=0)}for(;q<=E.CBANDS;++q)w[q]=0,T[q]=0}function S0(s,i,w,T){var G=s.internal_flags;s.short_blocks==K.short_block_coupled&&!(i[0]!=0&&i[1]!=0)&&(i[0]=i[1]=0);for(var x=0;x<G.channels_out;x++)T[x]=E.NORM_TYPE,s.short_blocks==K.short_block_dispensed&&(i[x]=1),s.short_blocks==K.short_block_forced&&(i[x]=0),i[x]!=0?(U(G.blocktype_old[x]!=E.START_TYPE),G.blocktype_old[x]==E.SHORT_TYPE&&(T[x]=E.STOP_TYPE)):(T[x]=E.SHORT_TYPE,G.blocktype_old[x]==E.NORM_TYPE&&(G.blocktype_old[x]=E.START_TYPE),G.blocktype_old[x]==E.STOP_TYPE&&(G.blocktype_old[x]=E.SHORT_TYPE)),w[x]=G.blocktype_old[x],G.blocktype_old[x]=T[x]}function V0(s,i,w){return w>=1?s:w<=0?i:i>0?Math.pow(s/i,w)*i:0}var U0=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function o(s,i){for(var w=309.07,T=0;T<E.SBMAX_s-1;T++)for(var G=0;G<3;G++){var x=s.thm.s[T][G];if(U(T<U0.length),x>0){var X=x*i,j=s.en.s[T][G];j>X&&(j>X*1e10?w+=U0[T]*(10*e0):(U(X>0),w+=U0[T]*n0.FAST_LOG10(j/X)))}}return w}var u=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function x0(s,i){for(var w=281.0575,T=0;T<E.SBMAX_l-1;T++){var G=s.thm.l[T];if(U(T<u.length),G>0){var x=G*i,X=s.en.l[T];X>x&&(X>x*1e10?w+=u[T]*(10*e0):(U(x>0),w+=u[T]*n0.FAST_LOG10(X/x)))}}return w}function M0(s,i,w,T,G){var x,X;for(x=X=0;x<s.npart_l;++x){var j=0,q=0,s0;for(s0=0;s0<s.numlines_l[x];++s0,++X){var z=i[X];U(z>=0),j+=z,q<z&&(q=z)}w[x]=j,T[x]=q,G[x]=j*s.rnumlines_l[x],U(s.rnumlines_l[x]>=0),U(j>=0),U(w[x]>=0),U(T[x]>=0),U(G[x]>=0)}}function L0(s,i,w,T){var G=e.length-1,x=0,X=w[x]+w[x+1];if(U(X>=0),X>0){var j=i[x];j<i[x+1]&&(j=i[x+1]),U(s.numlines_l[x]+s.numlines_l[x+1]-1>0),X=20*(j*2-X)/(X*(s.numlines_l[x]+s.numlines_l[x+1]-1));var q=0|X;q>G&&(q=G),T[x]=q}else T[x]=0;for(x=1;x<s.npart_l-1;x++)if(X=w[x-1]+w[x]+w[x+1],U(X>=0),X>0){var j=i[x-1];j<i[x]&&(j=i[x]),j<i[x+1]&&(j=i[x+1]),U(s.numlines_l[x-1]+s.numlines_l[x]+s.numlines_l[x+1]-1>0),X=20*(j*3-X)/(X*(s.numlines_l[x-1]+s.numlines_l[x]+s.numlines_l[x+1]-1));var q=0|X;q>G&&(q=G),T[x]=q}else T[x]=0;if(U(x>0),U(x==s.npart_l-1),X=w[x-1]+w[x],U(X>=0),X>0){var j=i[x-1];j<i[x]&&(j=i[x]),U(s.numlines_l[x-1]+s.numlines_l[x]-1>0),X=20*(j*2-X)/(X*(s.numlines_l[x-1]+s.numlines_l[x]-1));var q=0|X;q>G&&(q=G),T[x]=q}else T[x]=0;U(x==s.npart_l-1)}var T0=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(s,i,w,T,G,x,X,j,q,s0){var z=s.internal_flags,i0=J([2,E.BLKSIZE]),f0=J([2,3,E.BLKSIZE_s]),B0=Y(E.CBANDS+1),_0=Y(E.CBANDS+1),I0=Y(E.CBANDS+2),t0=L(2),p0=L(2),F0,u0,R0,v0,C0,K0,w0,H0,q0=J([2,576]),Q0,he=L(E.CBANDS+2),ae=L(E.CBANDS+2);for($.fill(ae,0),F0=z.channels_out,s.mode==MPEGMode.JOINT_STEREO&&(F0=4),s.VBR==p.vbr_off?Q0=z.ResvMax==0?0:z.ResvSize/z.ResvMax*.5:s.VBR==p.vbr_rh||s.VBR==p.vbr_mtrh||s.VBR==p.vbr_mt?Q0=.6:Q0=1,u0=0;u0<z.channels_out;u0++){var z0=i[u0],ve=w+576-350-h0+192;for(U(T0.length==(h0-1)/2),v0=0;v0<576;v0++){var de,fe;for(de=z0[ve+v0+10],fe=0,C0=0;C0<(h0-1)/2-1;C0+=2)de+=T0[C0]*(z0[ve+v0+C0]+z0[ve+v0+h0-C0]),fe+=T0[C0+1]*(z0[ve+v0+C0+1]+z0[ve+v0+h0-C0-1]);q0[u0][v0]=de+fe}G[T][u0].en.assign(z.en[u0]),G[T][u0].thm.assign(z.thm[u0]),F0>2&&(x[T][u0].en.assign(z.en[u0+2]),x[T][u0].thm.assign(z.thm[u0+2]))}for(u0=0;u0<F0;u0++){var ce,me,ne=Y(12),Me=[0,0,0,0],Te=Y(12),Ge=1,H1,F1=Y(E.CBANDS),D1=Y(E.CBANDS),W0=[0,0,0,0],q1=Y(E.HBLKSIZE),X1=J([3,E.HBLKSIZE_s]);for(U(z.npart_s<=E.CBANDS),U(z.npart_l<=E.CBANDS),v0=0;v0<3;v0++)ne[v0]=z.nsPsy.last_en_subshort[u0][v0+6],U(z.nsPsy.last_en_subshort[u0][v0+4]>0),Te[v0]=ne[v0]/z.nsPsy.last_en_subshort[u0][v0+4],Me[0]+=ne[v0];if(u0==2)for(v0=0;v0<576;v0++){var Pe,Ue;Pe=q0[0][v0],Ue=q0[1][v0],q0[0][v0]=Pe+Ue,q0[1][v0]=Pe-Ue}{var Y1=q0[u0&1],Ce=0;for(v0=0;v0<9;v0++){for(var Oa=Ce+64,re=1;Ce<Oa;Ce++)re<Math.abs(Y1[Ce])&&(re=Math.abs(Y1[Ce]));z.nsPsy.last_en_subshort[u0][v0]=ne[v0+3]=re,Me[1+v0/3]+=re,re>ne[v0+3-2]?(U(ne[v0+3-2]>0),re=re/ne[v0+3-2]):ne[v0+3-2]>re*10?(U(re>0),re=ne[v0+3-2]/(re*10)):re=0,Te[v0+3]=re}}if(s.analysis){var je=Te[0];for(v0=1;v0<12;v0++)je<Te[v0]&&(je=Te[v0]);z.pinfo.ers[T][u0]=z.pinfo.ers_save[u0],z.pinfo.ers_save[u0]=je}for(H1=u0==3?z.nsPsy.attackthre_s:z.nsPsy.attackthre,v0=0;v0<12;v0++)W0[v0/3]==0&&Te[v0]>H1&&(W0[v0/3]=v0%3+1);for(v0=1;v0<4;v0++){var Ke;Me[v0-1]>Me[v0]?(U(Me[v0]>0),Ke=Me[v0-1]/Me[v0]):(U(Me[v0-1]>0),Ke=Me[v0]/Me[v0-1]),Ke<1.7&&(W0[v0]=0,v0==1&&(W0[0]=0))}for(W0[0]!=0&&z.nsPsy.lastAttacks[u0]!=0&&(W0[0]=0),(z.nsPsy.lastAttacks[u0]==3||W0[0]+W0[1]+W0[2]+W0[3]!=0)&&(Ge=0,W0[1]!=0&&W0[0]!=0&&(W0[1]=0),W0[2]!=0&&W0[1]!=0&&(W0[2]=0),W0[3]!=0&&W0[2]!=0&&(W0[3]=0)),u0<2?p0[u0]=Ge:Ge==0&&(p0[0]=p0[1]=0),q[u0]=z.tot_ener[u0],me=f0,ce=i0,N(s,q1,X1,ce,u0&1,me,u0&1,T,u0,i,w),M0(z,q1,B0,F1,D1),L0(z,F1,D1,he),H0=0;H0<3;H0++){var Ze,ue;for(b0(s,X1,_0,I0,u0,H0),c0(z,_0,I0,u0,H0),w0=0;w0<E.SBMAX_s;w0++){if(ue=z.thm[u0].s[w0][H0],ue*=Q,W0[H0]>=2||W0[H0+1]==1){var Le=H0!=0?H0-1:2,re=V0(z.thm[u0].s[w0][Le],ue,D*Q0);ue=Math.min(ue,re)}if(W0[H0]==1){var Le=H0!=0?H0-1:2,re=V0(z.thm[u0].s[w0][Le],ue,O*Q0);ue=Math.min(ue,re)}else if(H0!=0&&W0[H0-1]==3||H0==0&&z.nsPsy.lastAttacks[u0]==3){var Le=H0!=2?H0+1:0,re=V0(z.thm[u0].s[w0][Le],ue,O*Q0);ue=Math.min(ue,re)}Ze=ne[H0*3+3]+ne[H0*3+4]+ne[H0*3+5],ne[H0*3+5]*6<Ze&&(ue*=.5,ne[H0*3+4]*6<Ze&&(ue*=.5)),z.thm[u0].s[w0][H0]=ue}}for(z.nsPsy.lastAttacks[u0]=W0[2],K0=0,R0=0;R0<z.npart_l;R0++){for(var Ee=z.s3ind[R0][0],ze=B0[Ee]*e[he[Ee]],Be=z.s3_ll[K0++]*ze;++Ee<=z.s3ind[R0][1];)ze=B0[Ee]*e[he[Ee]],Be=b(Be,z.s3_ll[K0++]*ze,Ee,Ee-R0,z);Be*=.158489319246111,z.blocktype_old[u0&1]==E.SHORT_TYPE?I0[R0]=Be:I0[R0]=V0(Math.min(Be,Math.min(S*z.nb_1[u0][R0],A*z.nb_2[u0][R0])),Be,Q0),z.nb_2[u0][R0]=z.nb_1[u0][R0],z.nb_1[u0][R0]=Be}for(;R0<=E.CBANDS;++R0)B0[R0]=0,I0[R0]=0;d0(z,B0,I0,u0)}if((s.mode==MPEGMode.STEREO||s.mode==MPEGMode.JOINT_STEREO)&&s.interChRatio>0&&F(s,s.interChRatio),s.mode==MPEGMode.JOINT_STEREO){var Qe;P(z),Qe=s.msfix,Math.abs(Qe)>0&&o0(z,Qe,s.ATHlower*z.ATH.adjust)}for(S0(s,p0,s0,t0),u0=0;u0<F0;u0++){var Ve,Ne=0,He,Fe;u0>1?(Ve=j,Ne=-2,He=E.NORM_TYPE,(s0[0]==E.SHORT_TYPE||s0[1]==E.SHORT_TYPE)&&(He=E.SHORT_TYPE),Fe=x[T][u0-2]):(Ve=X,Ne=0,He=s0[u0],Fe=G[T][u0]),He==E.SHORT_TYPE?Ve[Ne+u0]=o(Fe,z.masking_lower):Ve[Ne+u0]=x0(Fe,z.masking_lower),s.analysis&&(z.pinfo.pe[T][u0]=Ve[Ne+u0])}return 0};function E0(s,i,w,T,G,x,X,j){var q=s.internal_flags;if(T<2)a0.fft_long(q,X[j],T,i,w);else if(T==2)for(var s0=E.BLKSIZE-1;s0>=0;--s0){var z=X[j+0][s0],i0=X[j+1][s0];X[j+0][s0]=(z+i0)*n0.SQRT2*.5,X[j+1][s0]=(z-i0)*n0.SQRT2*.5}x[0]=X[j+0][0],x[0]*=x[0];for(var s0=E.BLKSIZE/2-1;s0>=0;--s0){var f0=X[j+0][E.BLKSIZE/2-s0],B0=X[j+0][E.BLKSIZE/2+s0];x[E.BLKSIZE/2-s0]=(f0*f0+B0*B0)*.5}{for(var _0=0,s0=11;s0<E.HBLKSIZE;s0++)_0+=x[s0];q.tot_ener[T]=_0}if(s.analysis){for(var s0=0;s0<E.HBLKSIZE;s0++)q.pinfo.energy[G][T][s0]=q.pinfo.energy_save[T][s0],q.pinfo.energy_save[T][s0]=x[s0];q.pinfo.pe[G][T]=q.pe[T]}}function A0(s,i,w,T,G,x,X,j){var q=s.internal_flags;if(G==0&&T<2&&a0.fft_short(q,X[j],T,i,w),T==2)for(var s0=E.BLKSIZE_s-1;s0>=0;--s0){var z=X[j+0][G][s0],i0=X[j+1][G][s0];X[j+0][G][s0]=(z+i0)*n0.SQRT2*.5,X[j+1][G][s0]=(z-i0)*n0.SQRT2*.5}x[G][0]=X[j+0][G][0],x[G][0]*=x[G][0];for(var s0=E.BLKSIZE_s/2-1;s0>=0;--s0){var f0=X[j+0][G][E.BLKSIZE_s/2-s0],B0=X[j+0][G][E.BLKSIZE_s/2+s0];x[G][E.BLKSIZE_s/2-s0]=(f0*f0+B0*B0)*.5}}function D0(s,i,w,T){var G=s.internal_flags;s.athaa_loudapprox==2&&w<2&&(G.loudness_sq[i][w]=G.loudness_sq_save[w],G.loudness_sq_save[w]=y0(T,G))}var k0=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function m0(s,i,w,T,G,x,X,j,q,s0){for(var z=J([2,576]),i0=s.internal_flags,f0=i0.channels_out,B0=s.mode==MPEGMode.JOINT_STEREO?4:f0,_0=0;_0<f0;_0++){firbuf=i[_0];var I0=w+576-350-h0+192;U(k0.length==(h0-1)/2);for(var t0=0;t0<576;t0++){var p0,F0;p0=firbuf[I0+t0+10],F0=0;for(var u0=0;u0<(h0-1)/2-1;u0+=2)p0+=k0[u0]*(firbuf[I0+t0+u0]+firbuf[I0+t0+h0-u0]),F0+=k0[u0+1]*(firbuf[I0+t0+u0+1]+firbuf[I0+t0+h0-u0-1]);z[_0][t0]=p0+F0}G[T][_0].en.assign(i0.en[_0]),G[T][_0].thm.assign(i0.thm[_0]),B0>2&&(x[T][_0].en.assign(i0.en[_0+2]),x[T][_0].thm.assign(i0.thm[_0+2]))}for(var _0=0;_0<B0;_0++){var R0=Y(12),v0=Y(12),C0=[0,0,0,0],K0=z[_0&1],w0=0,H0=_0==3?i0.nsPsy.attackthre_s:i0.nsPsy.attackthre,q0=1;if(_0==2)for(var t0=0,u0=576;u0>0;++t0,--u0){var Q0=z[0][t0],he=z[1][t0];z[0][t0]=Q0+he,z[1][t0]=Q0-he}for(var t0=0;t0<3;t0++)v0[t0]=i0.nsPsy.last_en_subshort[_0][t0+6],U(i0.nsPsy.last_en_subshort[_0][t0+4]>0),R0[t0]=v0[t0]/i0.nsPsy.last_en_subshort[_0][t0+4],C0[0]+=v0[t0];for(var t0=0;t0<9;t0++){for(var ae=w0+64,z0=1;w0<ae;w0++)z0<Math.abs(K0[w0])&&(z0=Math.abs(K0[w0]));i0.nsPsy.last_en_subshort[_0][t0]=v0[t0+3]=z0,C0[1+t0/3]+=z0,z0>v0[t0+3-2]?(U(v0[t0+3-2]>0),z0=z0/v0[t0+3-2]):v0[t0+3-2]>z0*10?(U(z0>0),z0=v0[t0+3-2]/(z0*10)):z0=0,R0[t0+3]=z0}for(var t0=0;t0<3;++t0){var ve=v0[t0*3+3]+v0[t0*3+4]+v0[t0*3+5],de=1;v0[t0*3+5]*6<ve&&(de*=.5,v0[t0*3+4]*6<ve&&(de*=.5)),j[_0][t0]=de}if(s.analysis){for(var fe=R0[0],t0=1;t0<12;t0++)fe<R0[t0]&&(fe=R0[t0]);i0.pinfo.ers[T][_0]=i0.pinfo.ers_save[_0],i0.pinfo.ers_save[_0]=fe}for(var t0=0;t0<12;t0++)q[_0][t0/3]==0&&R0[t0]>H0&&(q[_0][t0/3]=t0%3+1);for(var t0=1;t0<4;t0++){var ce=C0[t0-1],me=C0[t0],ne=Math.max(ce,me);ne<4e4&&ce<1.7*me&&me<1.7*ce&&(t0==1&&q[_0][0]<=q[_0][t0]&&(q[_0][0]=0),q[_0][t0]=0)}q[_0][0]<=i0.nsPsy.lastAttacks[_0]&&(q[_0][0]=0),(i0.nsPsy.lastAttacks[_0]==3||q[_0][0]+q[_0][1]+q[_0][2]+q[_0][3]!=0)&&(q0=0,q[_0][1]!=0&&q[_0][0]!=0&&(q[_0][1]=0),q[_0][2]!=0&&q[_0][1]!=0&&(q[_0][2]=0),q[_0][3]!=0&&q[_0][2]!=0&&(q[_0][3]=0)),_0<2?s0[_0]=q0:q0==0&&(s0[0]=s0[1]=0),X[_0]=i0.tot_ener[_0]}}function X0(s,i,w){if(w==0)for(var T=0;T<s.npart_s;T++)s.nb_s2[i][T]=s.nb_s1[i][T],s.nb_s1[i][T]=0}function J0(s,i){for(var w=0;w<s.npart_l;w++)s.nb_2[i][w]=s.nb_1[i][w],s.nb_1[i][w]=0}function Y0(s,i,w,T){var G=e.length-1,x=0,X=w[x]+w[x+1];if(U(X>=0),X>0){var j=i[x];j<i[x+1]&&(j=i[x+1]),U(s.numlines_s[x]+s.numlines_s[x+1]-1>0),X=20*(j*2-X)/(X*(s.numlines_s[x]+s.numlines_s[x+1]-1));var q=0|X;q>G&&(q=G),T[x]=q}else T[x]=0;for(x=1;x<s.npart_s-1;x++)if(X=w[x-1]+w[x]+w[x+1],U(x+1<s.npart_s),U(X>=0),X>0){var j=i[x-1];j<i[x]&&(j=i[x]),j<i[x+1]&&(j=i[x+1]),U(s.numlines_s[x-1]+s.numlines_s[x]+s.numlines_s[x+1]-1>0),X=20*(j*3-X)/(X*(s.numlines_s[x-1]+s.numlines_s[x]+s.numlines_s[x+1]-1));var q=0|X;q>G&&(q=G),T[x]=q}else T[x]=0;if(U(x>0),U(x==s.npart_s-1),X=w[x-1]+w[x],U(X>=0),X>0){var j=i[x-1];j<i[x]&&(j=i[x]),U(s.numlines_s[x-1]+s.numlines_s[x]-1>0),X=20*(j*2-X)/(X*(s.numlines_s[x-1]+s.numlines_s[x]-1));var q=0|X;q>G&&(q=G),T[x]=q}else T[x]=0;U(x==s.npart_s-1)}function Z0(s,i,w,T,G,x){var X=s.internal_flags,j=new float[E.CBANDS],q=Y(E.CBANDS),s0,z,i0,f0=new int[E.CBANDS];for(i0=z=0;i0<X.npart_s;++i0){var B0=0,_0=0,I0=X.numlines_s[i0];for(s0=0;s0<I0;++s0,++z){var t0=i[x][z];B0+=t0,_0<t0&&(_0=t0)}w[i0]=B0,U(B0>=0),j[i0]=_0,U(I0>0),q[i0]=B0/I0,U(q[i0]>=0)}for(U(i0==X.npart_s),U(z==129);i0<E.CBANDS;++i0)j[i0]=0,q[i0]=0;for(Y0(X,j,q,f0),z=i0=0;i0<X.npart_s;i0++){var p0=X.s3ind_s[i0][0],F0=X.s3ind_s[i0][1],u0,R0,v0,C0,K0;for(u0=f0[p0],R0=1,C0=X.s3_ss[z]*w[p0]*e[f0[p0]],++z,++p0;p0<=F0;)u0+=f0[p0],R0+=1,v0=X.s3_ss[z]*w[p0]*e[f0[p0]],C0=f(C0,v0,p0-i0),++z,++p0;u0=(1+2*u0)/(2*R0),K0=e[u0]*.5,C0*=K0,T[i0]=C0,X.nb_s2[G][i0]=X.nb_s1[G][i0],X.nb_s1[G][i0]=C0,v0=j[i0],v0*=X.minval_s[i0],v0*=K0,T[i0]>v0&&(T[i0]=v0),X.masking_lower>1&&(T[i0]*=X.masking_lower),T[i0]>w[i0]&&(T[i0]=w[i0]),X.masking_lower<1&&(T[i0]*=X.masking_lower),U(T[i0]>=0)}for(;i0<E.CBANDS;++i0)w[i0]=0,T[i0]=0}function g0(s,i,w,T,G){var x=Y(E.CBANDS),X=Y(E.CBANDS),j=L(E.CBANDS+2),q;M0(s,i,w,x,X),L0(s,x,X,j);var s0=0;for(q=0;q<s.npart_l;q++){var z,i0,f0,B0,_0=s.s3ind[q][0],I0=s.s3ind[q][1],t0=0,p0=0;for(t0=j[_0],p0+=1,i0=s.s3_ll[s0]*w[_0]*e[j[_0]],++s0,++_0;_0<=I0;)t0+=j[_0],p0+=1,z=s.s3_ll[s0]*w[_0]*e[j[_0]],B0=f(i0,z,_0-q),i0=B0,++s0,++_0;if(t0=(1+2*t0)/(2*p0),f0=e[t0]*.5,i0*=f0,s.blocktype_old[G&1]==E.SHORT_TYPE){var F0=S*s.nb_1[G][q];F0>0?T[q]=Math.min(i0,F0):T[q]=Math.min(i0,w[q]*O)}else{var u0=A*s.nb_2[G][q],R0=S*s.nb_1[G][q],F0;u0<=0&&(u0=i0),R0<=0&&(R0=i0),s.blocktype_old[G&1]==E.NORM_TYPE?F0=Math.min(R0,u0):F0=R0,T[q]=Math.min(i0,F0)}s.nb_2[G][q]=s.nb_1[G][q],s.nb_1[G][q]=i0,z=x[q],z*=s.minval_l[q],z*=f0,T[q]>z&&(T[q]=z),s.masking_lower>1&&(T[q]*=s.masking_lower),T[q]>w[q]&&(T[q]=w[q]),s.masking_lower<1&&(T[q]*=s.masking_lower),U(T[q]>=0)}for(;q<E.CBANDS;++q)w[q]=0,T[q]=0}function j0(s,i){var w=s.internal_flags;s.short_blocks==K.short_block_coupled&&!(i[0]!=0&&i[1]!=0)&&(i[0]=i[1]=0);for(var T=0;T<w.channels_out;T++)s.short_blocks==K.short_block_dispensed&&(i[T]=1),s.short_blocks==K.short_block_forced&&(i[T]=0)}function ee(s,i,w){for(var T=s.internal_flags,G=0;G<T.channels_out;G++){var x=E.NORM_TYPE;i[G]!=0?(U(T.blocktype_old[G]!=E.START_TYPE),T.blocktype_old[G]==E.SHORT_TYPE&&(x=E.STOP_TYPE)):(x=E.SHORT_TYPE,T.blocktype_old[G]==E.NORM_TYPE&&(T.blocktype_old[G]=E.START_TYPE),T.blocktype_old[G]==E.STOP_TYPE&&(T.blocktype_old[G]=E.SHORT_TYPE)),w[G]=T.blocktype_old[G],T.blocktype_old[G]=x}}function le(s,i,w,T,G,x,X){for(var j=x*2,q=x>0?Math.pow(10,G):1,s0,z,i0=0;i0<X;++i0){var f0=s[2][i0],B0=s[3][i0],_0=i[0][i0],I0=i[1][i0],t0=i[2][i0],p0=i[3][i0];if(_0<=1.58*I0&&I0<=1.58*_0){var F0=w[i0]*B0,u0=w[i0]*f0;z=Math.max(t0,Math.min(p0,F0)),s0=Math.max(p0,Math.min(t0,u0))}else z=t0,s0=p0;if(x>0){var R0,v0,C0=T[i0]*q;if(R0=Math.min(Math.max(_0,C0),Math.max(I0,C0)),t0=Math.max(z,C0),p0=Math.max(s0,C0),v0=t0+p0,v0>0&&R0*j<v0){var K0=R0*j/v0;t0*=K0,p0*=K0,U(v0>0)}z=Math.min(t0,z),s0=Math.min(p0,s0)}z>f0&&(z=f0),s0>B0&&(s0=B0),i[2][i0]=z,i[3][i0]=s0}}this.L3psycho_anal_vbr=function(s,i,w,T,G,x,X,j,q,s0){var z=s.internal_flags,i0,f0,B0=Y(E.HBLKSIZE),_0=J([3,E.HBLKSIZE_s]),I0=J([2,E.BLKSIZE]),t0=J([2,3,E.BLKSIZE_s]),p0=J([4,E.CBANDS]),F0=J([4,E.CBANDS]),u0=J([4,3]),R0=.6,v0=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],C0=L(2),K0=s.mode==MPEGMode.JOINT_STEREO?4:z.channels_out;m0(s,i,w,T,G,x,q,u0,v0,C0),j0(s,C0);{for(var w0=0;w0<K0;w0++){var H0=w0&1;i0=I0,E0(s,i,w,w0,T,B0,i0,H0),D0(s,T,w0,B0),C0[H0]!=0?g0(z,B0,p0[w0],F0[w0],w0):J0(z,w0)}C0[0]+C0[1]==2&&s.mode==MPEGMode.JOINT_STEREO&&le(p0,F0,z.mld_cb_l,z.ATH.cb_l,s.ATHlower*z.ATH.adjust,s.msfix,z.npart_l);for(var w0=0;w0<K0;w0++){var H0=w0&1;C0[H0]!=0&&d0(z,p0[w0],F0[w0],w0)}}{for(var q0=0;q0<3;q0++){for(var w0=0;w0<K0;++w0){var H0=w0&1;C0[H0]!=0?X0(z,w0,q0):(f0=t0,A0(s,i,w,w0,q0,_0,f0,H0),Z0(s,_0,p0[w0],F0[w0],w0,q0))}C0[0]+C0[1]==0&&s.mode==MPEGMode.JOINT_STEREO&&le(p0,F0,z.mld_cb_s,z.ATH.cb_s,s.ATHlower*z.ATH.adjust,s.msfix,z.npart_s);for(var w0=0;w0<K0;++w0){var H0=w0&1;C0[H0]==0&&c0(z,p0[w0],F0[w0],w0,q0)}}for(var w0=0;w0<K0;w0++){var H0=w0&1;if(C0[H0]==0)for(var Q0=0;Q0<E.SBMAX_s;Q0++){for(var he=Y(3),q0=0;q0<3;q0++){var ae=z.thm[w0].s[Q0][q0];if(ae*=Q,v0[w0][q0]>=2||v0[w0][q0+1]==1){var z0=q0!=0?q0-1:2,ve=V0(z.thm[w0].s[Q0][z0],ae,D*R0);ae=Math.min(ae,ve)}else if(v0[w0][q0]==1){var z0=q0!=0?q0-1:2,ve=V0(z.thm[w0].s[Q0][z0],ae,O*R0);ae=Math.min(ae,ve)}else if(q0!=0&&v0[w0][q0-1]==3||q0==0&&z.nsPsy.lastAttacks[w0]==3){var z0=q0!=2?q0+1:0,ve=V0(z.thm[w0].s[Q0][z0],ae,O*R0);ae=Math.min(ae,ve)}ae*=u0[w0][q0],he[q0]=ae}for(var q0=0;q0<3;q0++)z.thm[w0].s[Q0][q0]=he[q0]}}}for(var w0=0;w0<K0;w0++)z.nsPsy.lastAttacks[w0]=v0[w0][2];ee(s,C0,s0);for(var w0=0;w0<K0;w0++){var de,fe,ce,me;w0>1?(de=j,fe=-2,ce=E.NORM_TYPE,(s0[0]==E.SHORT_TYPE||s0[1]==E.SHORT_TYPE)&&(ce=E.SHORT_TYPE),me=x[T][w0-2]):(de=X,fe=0,ce=s0[w0],me=G[T][w0]),ce==E.SHORT_TYPE?de[fe+w0]=o(me,z.masking_lower):de[fe+w0]=x0(me,z.masking_lower),s.analysis&&(z.pinfo.pe[T][w0]=de[fe+w0])}return 0};function te(s,i){var w=s,T;return w>=0?T=-w*27:T=w*i,T<=-72?0:Math.exp(T*W)}function oe(s){var i=0,w=0;{var T=0,G,x;for(T=0;te(T,s)>1e-20;T-=1);for(G=T,x=0;Math.abs(x-G)>1e-12;)T=(x+G)/2,te(T,s)>0?x=T:G=T;i=G}{var T=0,G,x;for(T=0;te(T,s)>1e-20;T+=1);for(G=0,x=T;Math.abs(x-G)>1e-12;)T=(x+G)/2,te(T,s)>0?G=T:x=T;w=x}{var X=0,j=1e3,q;for(q=0;q<=j;++q){var T=i+q*(w-i)/j,s0=te(T,s);X+=s0}{var z=(j+1)/(X*(w-i));return z}}}function xe(s){var i,w,T,G;return i=s,i>=0?i*=3:i*=1.5,i>=.5&&i<=2.5?(G=i-.5,w=8*(G*G-2*G)):w=0,i+=.474,T=15.811389+7.5*i-17.5*Math.sqrt(1+i*i),T<=-60?0:(i=Math.exp((w+T)*W),i/=.6609193,i)}function _e(s){return s<0&&(s=0),s=s*.001,13*Math.atan(.76*s)+3.5*Math.atan(s*s/(7.5*7.5))}function Ae(s,i,w,T,G,x,X,j,q,s0,z,i0){var f0=Y(E.CBANDS+1),B0=j/(i0>15?2*576:384),_0=L(E.HBLKSIZE),I0;j/=q;var t0=0,p0=0;for(I0=0;I0<E.CBANDS;I0++){var F0,u0;for(F0=_e(j*t0),f0[I0]=j*t0,u0=t0;_e(j*u0)-F0<r&&u0<=q/2;u0++);for(s[I0]=u0-t0,p0=I0+1;t0<u0;)U(t0<E.HBLKSIZE),_0[t0++]=I0;if(t0>q/2){t0=q/2,++I0;break}}U(I0<E.CBANDS),f0[I0]=j*t0;for(var R0=0;R0<i0;R0++){var v0,C0,K0,w0,H0;K0=s0[R0],w0=s0[R0+1],v0=0|Math.floor(.5+z*(K0-.5)),v0<0&&(v0=0),C0=0|Math.floor(.5+z*(w0-.5)),C0>q/2&&(C0=q/2),w[R0]=(_0[v0]+_0[C0])/2,i[R0]=_0[C0];var q0=B0*w0;X[R0]=(q0-f0[i[R0]])/(f0[i[R0]+1]-f0[i[R0]]),X[R0]<0?X[R0]=0:X[R0]>1&&(X[R0]=1),H0=_e(j*s0[R0]*z),H0=Math.min(H0,15.5)/15.5,x[R0]=Math.pow(10,1.25*(1-Math.cos(Math.PI*H0))-2.5)}t0=0;for(var Q0=0;Q0<p0;Q0++){var he=s[Q0],F0,ae;F0=_e(j*t0),ae=_e(j*(t0+he-1)),T[Q0]=.5*(F0+ae),F0=_e(j*(t0-.5)),ae=_e(j*(t0+he-.5)),G[Q0]=ae-F0,t0+=he}return p0}function we(s,i,w,T,G,x){var X=J([E.CBANDS,E.CBANDS]),j,q=0;if(x)for(var s0=0;s0<i;s0++)for(j=0;j<i;j++){var z=xe(w[s0]-w[j])*T[j];X[s0][j]=z*G[s0]}else for(j=0;j<i;j++)for(var i0=15+Math.min(21/w[j],12),f0=oe(i0),s0=0;s0<i;s0++){var z=f0*te(w[s0]-w[j],i0)*T[j];X[s0][j]=z*G[s0]}for(var s0=0;s0<i;s0++){for(j=0;j<i&&!(X[s0][j]>0);j++);for(s[s0][0]=j,j=i-1;j>0&&!(X[s0][j]>0);j--);s[s0][1]=j,q+=s[s0][1]-s[s0][0]+1}for(var B0=Y(q),_0=0,s0=0;s0<i;s0++)for(j=s[s0][0];j<=s[s0][1];j++)B0[_0++]=X[s0][j];return B0}function ye(s){var i=_e(s);return i=Math.min(i,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*i))-2.5)}this.psymodel_init=function(s){var i=s.internal_flags,w,T=!0,G=13,x=24,X=0,j=0,q=-8.25,s0=-4.5,z=Y(E.CBANDS),i0=Y(E.CBANDS),f0=Y(E.CBANDS),B0=s.out_samplerate;switch(s.experimentalZ){default:case 0:T=!0;break;case 1:T=!(s.VBR==p.vbr_mtrh||s.VBR==p.vbr_mt);break;case 2:T=!1;break;case 3:G=8,X=-1.75,j=-.0125,q=-8.25,s0=-2.25;break}for(i.ms_ener_ratio_old=.25,i.blocktype_old[0]=i.blocktype_old[1]=E.NORM_TYPE,w=0;w<4;++w){for(var t0=0;t0<E.CBANDS;++t0)i.nb_1[w][t0]=1e20,i.nb_2[w][t0]=1e20,i.nb_s1[w][t0]=i.nb_s2[w][t0]=1;for(var _0=0;_0<E.SBMAX_l;_0++)i.en[w].l[_0]=1e20,i.thm[w].l[_0]=1e20;for(var t0=0;t0<3;++t0){for(var _0=0;_0<E.SBMAX_s;_0++)i.en[w].s[_0][t0]=1e20,i.thm[w].s[_0][t0]=1e20;i.nsPsy.lastAttacks[w]=0}for(var t0=0;t0<9;t0++)i.nsPsy.last_en_subshort[w][t0]=10}for(i.loudness_sq_save[0]=i.loudness_sq_save[1]=0,i.npart_l=Ae(i.numlines_l,i.bo_l,i.bm_l,z,i0,i.mld_l,i.PSY.bo_l_weight,B0,E.BLKSIZE,i.scalefac_band.l,E.BLKSIZE/(2*576),E.SBMAX_l),U(i.npart_l<E.CBANDS),w=0;w<i.npart_l;w++){var I0=X;z[w]>=G&&(I0=j*(z[w]-G)/(x-G)+X*(x-z[w])/(x-G)),f0[w]=Math.pow(10,I0/10),i.numlines_l[w]>0?i.rnumlines_l[w]=1/i.numlines_l[w]:i.rnumlines_l[w]=0}i.s3_ll=we(i.s3ind,i.npart_l,z,i0,f0,T);var t0=0;for(w=0;w<i.npart_l;w++){var p0;p0=r0.MAX_VALUE;for(var F0=0;F0<i.numlines_l[w];F0++,t0++){var u0=B0*t0/(1e3*E.BLKSIZE),R0;R0=this.ATHformula(u0*1e3,s)-20,R0=Math.pow(10,.1*R0),R0*=i.numlines_l[w],p0>R0&&(p0=R0)}i.ATH.cb_l[w]=p0,p0=-20+z[w]*20/10,p0>6&&(p0=100),p0<-15&&(p0=-15),p0-=8,i.minval_l[w]=Math.pow(10,p0/10)*i.numlines_l[w]}for(i.npart_s=Ae(i.numlines_s,i.bo_s,i.bm_s,z,i0,i.mld_s,i.PSY.bo_s_weight,B0,E.BLKSIZE_s,i.scalefac_band.s,E.BLKSIZE_s/384,E.SBMAX_s),U(i.npart_s<E.CBANDS),t0=0,w=0;w<i.npart_s;w++){var p0,I0=q;z[w]>=G&&(I0=s0*(z[w]-G)/(x-G)+q*(x-z[w])/(x-G)),f0[w]=Math.pow(10,I0/10),p0=r0.MAX_VALUE;for(var F0=0;F0<i.numlines_s[w];F0++,t0++){var u0=B0*t0/(1e3*E.BLKSIZE_s),R0;R0=this.ATHformula(u0*1e3,s)-20,R0=Math.pow(10,.1*R0),R0*=i.numlines_s[w],p0>R0&&(p0=R0)}i.ATH.cb_s[w]=p0,p0=-7+z[w]*7/12,z[w]>12&&(p0*=1+Math.log(1+p0)*3.1),z[w]<12&&(p0*=1+Math.log(1-p0)*2.3),p0<-15&&(p0=-15),p0-=8,i.minval_s[w]=Math.pow(10,p0/10)*i.numlines_s[w]}i.s3_ss=we(i.s3ind_s,i.npart_s,z,i0,f0,T),t(),a0.init_fft(i),i.decay=Math.exp(-1*e0/(y*B0/192));{var v0;v0=l0,(s.exp_nspsytune&2)!=0&&(v0=1),Math.abs(s.msfix)>0&&(v0=s.msfix),s.msfix=v0;for(var C0=0;C0<i.npart_l;C0++)i.s3ind[C0][1]>i.npart_l-1&&(i.s3ind[C0][1]=i.npart_l-1)}var K0=576*i.mode_gr/B0;if(i.ATH.decay=Math.pow(10,-12/10*K0),i.ATH.adjust=.01,i.ATH.adjustLimit=1,U(i.bo_l[E.SBMAX_l-1]<=i.npart_l),U(i.bo_s[E.SBMAX_s-1]<=i.npart_s),s.ATHtype!=-1){var u0,w0=s.out_samplerate/E.BLKSIZE,H0=0;for(u0=0,w=0;w<E.BLKSIZE/2;++w)u0+=w0,i.ATH.eql_w[w]=1/Math.pow(10,this.ATHformula(u0,s)/10),H0+=i.ATH.eql_w[w];for(H0=1/H0,w=E.BLKSIZE/2;--w>=0;)i.ATH.eql_w[w]*=H0}{for(var C0=t0=0;C0<i.npart_s;++C0)for(w=0;w<i.numlines_s[C0];++w)++t0;U(t0==129);for(var C0=t0=0;C0<i.npart_l;++C0)for(w=0;w<i.numlines_l[C0];++w)++t0;U(t0==513)}for(t0=0,w=0;w<i.npart_l;w++){var u0=B0*(t0+i.numlines_l[w]/2)/(1*E.BLKSIZE);i.mld_cb_l[w]=ye(u0),t0+=i.numlines_l[w]}for(;w<E.CBANDS;++w)i.mld_cb_l[w]=1;for(t0=0,w=0;w<i.npart_s;w++){var u0=B0*(t0+i.numlines_s[w]/2)/(1*E.BLKSIZE_s);i.mld_cb_s[w]=ye(u0),t0+=i.numlines_s[w]}for(;w<E.CBANDS;++w)i.mld_cb_s[w]=1;return 0};function g(s,i){s<-.3&&(s=3410),s/=1e3,s=Math.max(.1,s);var w=3.64*Math.pow(s,-.8)-6.8*Math.exp(-.6*Math.pow(s-3.4,2))+6*Math.exp(-.15*Math.pow(s-8.7,2))+(.6+.04*i)*.001*Math.pow(s,4);return w}this.ATHformula=function(s,i){var w;switch(i.ATHtype){case 0:w=g(s,9);break;case 1:w=g(s,-1);break;case 2:w=g(s,0);break;case 3:w=g(s,1)+6;break;case 4:w=g(s,i.ATHcurve);break;default:w=g(s,0);break}return w}}return i1=I,i1}var l1,g1;function Ta(){if(g1)return l1;g1=1;function _(p){var r0=p;this.ordinal=function(){return r0}}return _.STEREO=new _(0),_.JOINT_STEREO=new _(1),_.DUAL_CHANNEL=new _(2),_.MONO=new _(3),_.NOT_SET=new _(4),l1=_,l1}var o1,ea;function Qa(){if(ea)return o1;ea=1;var _=Ta();function p(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=_.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}return o1=p,o1}var _1,aa;function Xe(){if(aa)return _1;aa=1;var _=ie(),p={};return p.SFBMAX=_.SBMAX_s*3,_1=p,_1}var v1,ta;function N1(){if(ta)return v1;ta=1;var _=$0();_.System,_.VbrMode,_.Float,_.ShortBlock,_.Util,_.Arrays,_.new_array_n,_.new_byte,_.new_double;var p=_.new_float;_.new_float_n;var r0=_.new_int;_.new_int_n,_.assert;var K=Xe();function n0(){this.xr=p(576),this.l3_enc=r0(576),this.scalefac=r0(K.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=r0(3),this.subblock_gain=r0(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=r0(K.SFBMAX),this.window=r0(K.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=r0(4),this.max_nonzero_coeff=0;var $=this;function Y(L){return new Int32Array(L)}function J(L){return new Float32Array(L)}this.assign=function(L){$.xr=J(L.xr),$.l3_enc=Y(L.l3_enc),$.scalefac=Y(L.scalefac),$.xrpow_max=L.xrpow_max,$.part2_3_length=L.part2_3_length,$.big_values=L.big_values,$.count1=L.count1,$.global_gain=L.global_gain,$.scalefac_compress=L.scalefac_compress,$.block_type=L.block_type,$.mixed_block_flag=L.mixed_block_flag,$.table_select=Y(L.table_select),$.subblock_gain=Y(L.subblock_gain),$.region0_count=L.region0_count,$.region1_count=L.region1_count,$.preflag=L.preflag,$.scalefac_scale=L.scalefac_scale,$.count1table_select=L.count1table_select,$.part2_length=L.part2_length,$.sfb_lmax=L.sfb_lmax,$.sfb_smin=L.sfb_smin,$.psy_lmax=L.psy_lmax,$.sfbmax=L.sfbmax,$.psymax=L.psymax,$.sfbdivide=L.sfbdivide,$.width=Y(L.width),$.window=Y(L.window),$.count1bits=L.count1bits,$.sfb_partition_table=L.sfb_partition_table.slice(0),$.slen=Y(L.slen),$.max_nonzero_coeff=L.max_nonzero_coeff}}return v1=n0,v1}var u1,ra;function Wa(){if(ra)return u1;ra=1;var _=$0();_.System,_.VbrMode,_.Float,_.ShortBlock,_.Util,_.Arrays,_.new_array_n,_.new_byte,_.new_double,_.new_float,_.new_float_n;var p=_.new_int;_.new_int_n,_.assert;var r0=N1();function K(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[p(4),p(4)];for(var n0=0;n0<2;n0++)for(var $=0;$<2;$++)this.tt[n0][$]=new r0}return u1=K,u1}var h1,sa;function Ia(){if(sa)return h1;sa=1;var _=$0(),p=_.System;_.VbrMode,_.Float,_.ShortBlock,_.Util,_.Arrays,_.new_array_n,_.new_byte,_.new_double,_.new_float,_.new_float_n;var r0=_.new_int;_.new_int_n,_.assert;var K=ie();function n0($,Y,J,L){this.l=r0(1+K.SBMAX_l),this.s=r0(1+K.SBMAX_s),this.psfb21=r0(1+K.PSFB21),this.psfb12=r0(1+K.PSFB12);var U=this.l,k=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],p.arraycopy(this.arrL,0,U,0,Math.min(this.arrL.length,this.l.length)),p.arraycopy(this.arrS,0,k,0,Math.min(this.arrS.length,this.s.length)),p.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),p.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}return h1=n0,h1}var d1,na;function $a(){if(na)return d1;na=1;var _=$0();_.System,_.VbrMode,_.Float,_.ShortBlock,_.Util,_.Arrays,_.new_array_n,_.new_byte,_.new_double;var p=_.new_float,r0=_.new_float_n,K=_.new_int;_.new_int_n,_.assert;var n0=ie();function $(){this.last_en_subshort=r0([4,9]),this.lastAttacks=K(4),this.pefirbuf=p(19),this.longfact=p(n0.SBMAX_l),this.shortfact=p(n0.SBMAX_s),this.attackthre=0,this.attackthre_s=0}return d1=$,d1}var f1,ia;function Ja(){if(ia)return f1;ia=1;function _(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}return f1=_,f1}var c1,la;function Ye(){if(la)return c1;la=1;var _=$0();_.System,_.VbrMode,_.Float,_.ShortBlock,_.Util,_.Arrays,_.new_array_n;var p=_.new_byte,r0=_.new_double,K=_.new_float,n0=_.new_float_n,$=_.new_int,Y=_.new_int_n;_.assert;var J=Wa(),L=Ia(),U=$a(),k=Ja(),E=Ba(),I=ie(),a0=Xe();e0.MFSIZE=3*1152+I.ENCDELAY-I.MDCTDELAY,e0.MAX_HEADER_BUF=256,e0.MAX_BITS_PER_CHANNEL=4095,e0.MAX_BITS_PER_GRANULE=7680,e0.BPC=320;function e0(){var S=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=n0([2,e0.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new J,this.ms_ratio=K(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=$(2),this.CurrentStep=$(2),this.masking_lower=0,this.bv_scf=$(576),this.pseudohalf=$(a0.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*e0.BPC+1),this.itime=r0(2),this.sideinfo_len=0,this.sb_sample=n0([2,2,18,I.SBLIMIT]),this.amp_filter=K(32);function A(){this.write_timing=0,this.ptr=0,this.buf=p(S)}this.header=new Array(e0.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new L,this.minval_l=K(I.CBANDS),this.minval_s=K(I.CBANDS),this.nb_1=n0([4,I.CBANDS]),this.nb_2=n0([4,I.CBANDS]),this.nb_s1=n0([4,I.CBANDS]),this.nb_s2=n0([4,I.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=K(4),this.loudness_sq=n0([2,2]),this.loudness_sq_save=K(2),this.mld_l=K(I.SBMAX_l),this.mld_s=K(I.SBMAX_s),this.bm_l=$(I.SBMAX_l),this.bo_l=$(I.SBMAX_l),this.bm_s=$(I.SBMAX_s),this.bo_s=$(I.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=Y([I.CBANDS,2]),this.s3ind_s=Y([I.CBANDS,2]),this.numlines_s=$(I.CBANDS),this.numlines_l=$(I.CBANDS),this.rnumlines_l=K(I.CBANDS),this.mld_cb_l=K(I.CBANDS),this.mld_cb_s=K(I.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=K(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=$(2),this.nsPsy=new U,this.VBR_seek_table=new k,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=Y([16,5]),this.bitrate_blockType_Hist=Y([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var c=0;c<this.en.length;c++)this.en[c]=new E;for(var c=0;c<this.thm.length;c++)this.thm[c]=new E;for(var c=0;c<this.header.length;c++)this.header[c]=new A}return c1=e0,c1}var m1,oa;function ga(){if(oa)return m1;oa=1;var _=$0();_.System,_.VbrMode,_.Float,_.ShortBlock,_.Util,_.Arrays,_.new_array_n,_.new_byte,_.new_double;var p=_.new_float;_.new_float_n,_.new_int,_.new_int_n,_.assert;var r0=ie();function K(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=p(r0.SBMAX_l),this.s=p(r0.SBMAX_s),this.psfb21=p(r0.PSFB21),this.psfb12=p(r0.PSFB12),this.cb_l=p(r0.CBANDS),this.cb_s=p(r0.CBANDS),this.eql_w=p(r0.BLKSIZE/2)}return m1=K,m1}var b1,_a;function ka(){if(_a)return b1;_a=1;var _=$0(),p=_.System;_.VbrMode,_.Float,_.ShortBlock,_.Util;var r0=_.Arrays;_.new_array_n,_.new_byte,_.new_double,_.new_float,_.new_float_n,_.new_int,_.new_int_n,_.assert,K.STEPS_per_dB=100,K.MAX_dB=120,K.GAIN_NOT_ENOUGH_SAMPLES=-24601,K.GAIN_ANALYSIS_ERROR=0,K.GAIN_ANALYSIS_OK=1,K.INIT_GAIN_ANALYSIS_ERROR=0,K.INIT_GAIN_ANALYSIS_OK=1,K.YULE_ORDER=10,K.MAX_ORDER=K.YULE_ORDER,K.MAX_SAMP_FREQ=48e3,K.RMS_WINDOW_TIME_NUMERATOR=1,K.RMS_WINDOW_TIME_DENOMINATOR=20,K.MAX_SAMPLES_PER_WINDOW=K.MAX_SAMP_FREQ*K.RMS_WINDOW_TIME_NUMERATOR/K.RMS_WINDOW_TIME_DENOMINATOR+1;function K(){var n0=64.82;K.YULE_ORDER;var $=.95;K.MAX_SAMP_FREQ;var Y=K.RMS_WINDOW_TIME_NUMERATOR,J=K.RMS_WINDOW_TIME_DENOMINATOR;K.MAX_SAMPLES_PER_WINDOW;var L=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],U=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function k(S,A,c,H,r,V){for(;r--!=0;)c[H]=1e-10+S[A+0]*V[0]-c[H-1]*V[1]+S[A-1]*V[2]-c[H-2]*V[3]+S[A-2]*V[4]-c[H-3]*V[5]+S[A-3]*V[6]-c[H-4]*V[7]+S[A-4]*V[8]-c[H-5]*V[9]+S[A-5]*V[10]-c[H-6]*V[11]+S[A-6]*V[12]-c[H-7]*V[13]+S[A-7]*V[14]-c[H-8]*V[15]+S[A-8]*V[16]-c[H-9]*V[17]+S[A-9]*V[18]-c[H-10]*V[19]+S[A-10]*V[20],++H,++A}function E(S,A,c,H,r,V){for(;r--!=0;)c[H]=S[A+0]*V[0]-c[H-1]*V[1]+S[A-1]*V[2]-c[H-2]*V[3]+S[A-2]*V[4],++H,++A}function I(S,A){for(var c=0;c<MAX_ORDER;c++)S.linprebuf[c]=S.lstepbuf[c]=S.loutbuf[c]=S.rinprebuf[c]=S.rstepbuf[c]=S.routbuf[c]=0;switch(0|A){case 48e3:S.reqindex=0;break;case 44100:S.reqindex=1;break;case 32e3:S.reqindex=2;break;case 24e3:S.reqindex=3;break;case 22050:S.reqindex=4;break;case 16e3:S.reqindex=5;break;case 12e3:S.reqindex=6;break;case 11025:S.reqindex=7;break;case 8e3:S.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return S.sampleWindow=0|(A*Y+J-1)/J,S.lsum=0,S.rsum=0,S.totsamp=0,r0.ill(S.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(S,A){return I(S,A)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(S.linpre=MAX_ORDER,S.rinpre=MAX_ORDER,S.lstep=MAX_ORDER,S.rstep=MAX_ORDER,S.lout=MAX_ORDER,S.rout=MAX_ORDER,r0.fill(S.B,0),INIT_GAIN_ANALYSIS_OK)};function a0(S){return S*S}this.AnalyzeSamples=function(S,A,c,H,r,V,y){var Q,D,O,l0,h0,W,m;if(V==0)return GAIN_ANALYSIS_OK;switch(m=0,h0=V,y){case 1:H=A,r=c;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(V<MAX_ORDER?(p.arraycopy(A,c,S.linprebuf,MAX_ORDER,V),p.arraycopy(H,r,S.rinprebuf,MAX_ORDER,V)):(p.arraycopy(A,c,S.linprebuf,MAX_ORDER,MAX_ORDER),p.arraycopy(H,r,S.rinprebuf,MAX_ORDER,MAX_ORDER));h0>0;){W=h0>S.sampleWindow-S.totsamp?S.sampleWindow-S.totsamp:h0,m<MAX_ORDER?(Q=S.linpre+m,D=S.linprebuf,O=S.rinpre+m,l0=S.rinprebuf,W>MAX_ORDER-m&&(W=MAX_ORDER-m)):(Q=c+m,D=A,O=r+m,l0=H),k(D,Q,S.lstepbuf,S.lstep+S.totsamp,W,L[S.reqindex]),k(l0,O,S.rstepbuf,S.rstep+S.totsamp,W,L[S.reqindex]),E(S.lstepbuf,S.lstep+S.totsamp,S.loutbuf,S.lout+S.totsamp,W,U[S.reqindex]),E(S.rstepbuf,S.rstep+S.totsamp,S.routbuf,S.rout+S.totsamp,W,U[S.reqindex]),Q=S.lout+S.totsamp,D=S.loutbuf,O=S.rout+S.totsamp,l0=S.routbuf;for(var y0=W%8;y0--!=0;)S.lsum+=a0(D[Q++]),S.rsum+=a0(l0[O++]);for(y0=W/8;y0--!=0;)S.lsum+=a0(D[Q+0])+a0(D[Q+1])+a0(D[Q+2])+a0(D[Q+3])+a0(D[Q+4])+a0(D[Q+5])+a0(D[Q+6])+a0(D[Q+7]),Q+=8,S.rsum+=a0(l0[O+0])+a0(l0[O+1])+a0(l0[O+2])+a0(l0[O+3])+a0(l0[O+4])+a0(l0[O+5])+a0(l0[O+6])+a0(l0[O+7]),O+=8;if(h0-=W,m+=W,S.totsamp+=W,S.totsamp==S.sampleWindow){var N=K.STEPS_per_dB*10*Math.log10((S.lsum+S.rsum)/S.totsamp*.5+1e-37),R=N<=0?0:0|N;R>=S.A.length&&(R=S.A.length-1),S.A[R]++,S.lsum=S.rsum=0,p.arraycopy(S.loutbuf,S.totsamp,S.loutbuf,0,MAX_ORDER),p.arraycopy(S.routbuf,S.totsamp,S.routbuf,0,MAX_ORDER),p.arraycopy(S.lstepbuf,S.totsamp,S.lstepbuf,0,MAX_ORDER),p.arraycopy(S.rstepbuf,S.totsamp,S.rstepbuf,0,MAX_ORDER),S.totsamp=0}if(S.totsamp>S.sampleWindow)return GAIN_ANALYSIS_ERROR}return V<MAX_ORDER?(p.arraycopy(S.linprebuf,V,S.linprebuf,0,MAX_ORDER-V),p.arraycopy(S.rinprebuf,V,S.rinprebuf,0,MAX_ORDER-V),p.arraycopy(A,c,S.linprebuf,MAX_ORDER-V,V),p.arraycopy(H,r,S.rinprebuf,MAX_ORDER-V,V)):(p.arraycopy(A,c+V-MAX_ORDER,S.linprebuf,0,MAX_ORDER),p.arraycopy(H,r+V-MAX_ORDER,S.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function e0(S,A){var c,H=0;for(c=0;c<A;c++)H+=S[c];if(H==0)return GAIN_NOT_ENOUGH_SAMPLES;var r=0|Math.ceil(H*(1-$));for(c=A;c-- >0&&!((r-=S[c])<=0););return n0-c/K.STEPS_per_dB}this.GetTitleGain=function(S){for(var A=e0(S.A,S.A.length),c=0;c<S.A.length;c++)S.B[c]+=S.A[c],S.A[c]=0;for(var c=0;c<MAX_ORDER;c++)S.linprebuf[c]=S.lstepbuf[c]=S.loutbuf[c]=S.rinprebuf[c]=S.rstepbuf[c]=S.routbuf[c]=0;return S.totsamp=0,S.lsum=S.rsum=0,A}}return b1=K,b1}var x1,va;function et(){if(va)return x1;va=1;var _=$0();_.System,_.VbrMode,_.Float,_.ShortBlock,_.Util,_.Arrays,_.new_array_n,_.new_byte,_.new_double;var p=_.new_float;_.new_float_n;var r0=_.new_int;_.new_int_n,_.assert;var K=ka();function n0(){this.linprebuf=p(K.MAX_ORDER*2),this.linpre=0,this.lstepbuf=p(K.MAX_SAMPLES_PER_WINDOW+K.MAX_ORDER),this.lstep=0,this.loutbuf=p(K.MAX_SAMPLES_PER_WINDOW+K.MAX_ORDER),this.lout=0,this.rinprebuf=p(K.MAX_ORDER*2),this.rinpre=0,this.rstepbuf=p(K.MAX_SAMPLES_PER_WINDOW+K.MAX_ORDER),this.rstep=0,this.routbuf=p(K.MAX_SAMPLES_PER_WINDOW+K.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=r0(0|K.STEPS_per_dB*K.MAX_dB),this.B=r0(0|K.STEPS_per_dB*K.MAX_dB)}return x1=n0,x1}var w1,ua;function Ca(){if(ua)return w1;ua=1;function _(p){this.bits=p}return w1=_,w1}var M1,ha;function at(){if(ha)return M1;ha=1;var _=$0();_.System,_.VbrMode,_.Float,_.ShortBlock,_.Util,_.Arrays,_.new_array_n,_.new_byte,_.new_double;var p=_.new_float;_.new_float_n;var r0=_.new_int;_.new_int_n;var K=_.assert,n0=Ca(),$=ie(),Y=Xe(),J=Ye();function L(U){var k=U;this.quantize=k,this.iteration_loop=function(E,I,a0,e0){var S=E.internal_flags,A=p(Y.SFBMAX),c=p(576),H=r0(2),r=0,V,y=S.l3_side,Q=new n0(r);this.quantize.rv.ResvFrameBegin(E,Q),r=Q.bits;for(var D=0;D<S.mode_gr;D++){V=this.quantize.qupvt.on_pe(E,I,H,r,D,D),S.mode_ext==$.MPG_MD_MS_LR&&(this.quantize.ms_convert(S.l3_side,D),this.quantize.qupvt.reduce_side(H,a0[D],r,V));for(var O=0;O<S.channels_out;O++){var l0,h0,W=y.tt[D][O];W.block_type!=$.SHORT_TYPE?(l0=0,h0=S.PSY.mask_adjust-l0):(l0=0,h0=S.PSY.mask_adjust_short-l0),S.masking_lower=Math.pow(10,h0*.1),this.quantize.init_outer_loop(S,W),this.quantize.init_xrpow(S,W,c)&&(this.quantize.qupvt.calc_xmin(E,e0[D][O],W,A),this.quantize.outer_loop(E,W,A,c,O,H[O])),this.quantize.iteration_finish_one(S,D,O),K(W.part2_3_length<=J.MAX_BITS_PER_CHANNEL),K(W.part2_3_length<=H[O])}}this.quantize.rv.ResvFrameEnd(S,r)}}return M1=L,M1}var S1,da;function O1(){if(da)return S1;da=1;function _(r0,K,n0,$){this.xlen=r0,this.linmax=K,this.table=n0,this.hlen=$}var p={};return p.t1HB=[1,1,1,0],p.t2HB=[1,2,1,3,1,1,3,2,0],p.t3HB=[3,2,1,1,1,1,3,2,0],p.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],p.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],p.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],p.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],p.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],p.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],p.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],p.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],p.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],p.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],p.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],p.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],p.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],p.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],p.t1l=[1,4,3,5],p.t2l=[1,4,7,4,5,7,6,7,8],p.t3l=[2,3,7,4,4,7,6,7,8],p.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],p.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],p.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],p.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],p.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],p.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],p.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],p.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],p.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],p.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],p.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],p.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],p.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],p.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],p.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],p.ht=[new _(0,0,null,null),new _(2,0,p.t1HB,p.t1l),new _(3,0,p.t2HB,p.t2l),new _(3,0,p.t3HB,p.t3l),new _(0,0,null,null),new _(4,0,p.t5HB,p.t5l),new _(4,0,p.t6HB,p.t6l),new _(6,0,p.t7HB,p.t7l),new _(6,0,p.t8HB,p.t8l),new _(6,0,p.t9HB,p.t9l),new _(8,0,p.t10HB,p.t10l),new _(8,0,p.t11HB,p.t11l),new _(8,0,p.t12HB,p.t12l),new _(16,0,p.t13HB,p.t13l),new _(0,0,null,p.t16_5l),new _(16,0,p.t15HB,p.t15l),new _(1,1,p.t16HB,p.t16l),new _(2,3,p.t16HB,p.t16l),new _(3,7,p.t16HB,p.t16l),new _(4,15,p.t16HB,p.t16l),new _(6,63,p.t16HB,p.t16l),new _(8,255,p.t16HB,p.t16l),new _(10,1023,p.t16HB,p.t16l),new _(13,8191,p.t16HB,p.t16l),new _(4,15,p.t24HB,p.t24l),new _(5,31,p.t24HB,p.t24l),new _(6,63,p.t24HB,p.t24l),new _(7,127,p.t24HB,p.t24l),new _(8,255,p.t24HB,p.t24l),new _(9,511,p.t24HB,p.t24l),new _(11,2047,p.t24HB,p.t24l),new _(13,8191,p.t24HB,p.t24l),new _(0,0,p.t32HB,p.t32l),new _(0,0,p.t33HB,p.t33l)],p.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],p.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],p.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],p.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],p.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],p.scfsi_band=[0,6,11,16,21],S1=p,S1}var p1,fa;function La(){if(fa)return p1;fa=1;var _=Ia(),p=$0();p.System;var r0=p.VbrMode,K=p.Float;p.ShortBlock;var n0=p.Util;p.Arrays,p.new_array_n,p.new_byte,p.new_double;var $=p.new_float;p.new_float_n;var Y=p.new_int;p.new_int_n;var J=p.assert,L=ie(),U=Ca(),k=Ye();E.Q_MAX=257,E.Q_MAX2=116,E.LARGE_BITS=1e5,E.IXMAX_VAL=8206;function E(){var I=null,a0=null,e0=null;this.setModules=function(N,R,l){I=N,a0=R,e0=l};function S(N){return J(0<=N+E.Q_MAX2&&N<E.Q_MAX),D[N+E.Q_MAX2]}this.IPOW20=function(N){return J(0<=N&&N<E.Q_MAX),O[N]};var A=2220446049250313e-31,c=E.IXMAX_VAL,H=c+2,r=E.Q_MAX,V=E.Q_MAX2;E.LARGE_BITS;var y=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var Q=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=Q,this.sfBandIndex=[new _([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new _([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var D=$(r+V+1),O=$(r),l0=$(H),h0=$(H);this.adj43=h0;function W(N,R){var l=e0.ATHformula(R,N);return l-=y,l=Math.pow(10,l/10+N.ATHlower),l}function m(N){for(var R=N.internal_flags.ATH.l,l=N.internal_flags.ATH.psfb21,d=N.internal_flags.ATH.s,B=N.internal_flags.ATH.psfb12,C=N.internal_flags,h=N.out_samplerate,e=0;e<L.SBMAX_l;e++){var t=C.scalefac_band.l[e],a=C.scalefac_band.l[e+1];R[e]=K.MAX_VALUE;for(var n=t;n<a;n++){var v=n*h/1152,b=W(N,v);R[e]=Math.min(R[e],b)}}for(var e=0;e<L.PSFB21;e++){var t=C.scalefac_band.psfb21[e],a=C.scalefac_band.psfb21[e+1];l[e]=K.MAX_VALUE;for(var n=t;n<a;n++){var v=n*h/1152,b=W(N,v);l[e]=Math.min(l[e],b)}}for(var e=0;e<L.SBMAX_s;e++){var t=C.scalefac_band.s[e],a=C.scalefac_band.s[e+1];d[e]=K.MAX_VALUE;for(var n=t;n<a;n++){var v=n*h/384,b=W(N,v);d[e]=Math.min(d[e],b)}d[e]*=C.scalefac_band.s[e+1]-C.scalefac_band.s[e]}for(var e=0;e<L.PSFB12;e++){var t=C.scalefac_band.psfb12[e],a=C.scalefac_band.psfb12[e+1];B[e]=K.MAX_VALUE;for(var n=t;n<a;n++){var v=n*h/384,b=W(N,v);B[e]=Math.min(B[e],b)}B[e]*=C.scalefac_band.s[13]-C.scalefac_band.s[12]}if(N.noATH){for(var e=0;e<L.SBMAX_l;e++)R[e]=1e-20;for(var e=0;e<L.PSFB21;e++)l[e]=1e-20;for(var e=0;e<L.SBMAX_s;e++)d[e]=1e-20;for(var e=0;e<L.PSFB12;e++)B[e]=1e-20}C.ATH.floor=10*Math.log10(W(N,-1))}this.iteration_init=function(N){var R=N.internal_flags,l=R.l3_side,d;if(R.iteration_init_init==0){for(R.iteration_init_init=1,l.main_data_begin=0,m(N),l0[0]=0,d=1;d<H;d++)l0[d]=Math.pow(d,4/3);for(d=0;d<H-1;d++)h0[d]=d+1-Math.pow(.5*(l0[d]+l0[d+1]),.75);for(h0[d]=.5,d=0;d<r;d++)O[d]=Math.pow(2,(d-210)*-.1875);for(d=0;d<=r+V;d++)D[d]=Math.pow(2,(d-210-V)*.25);I.huffman_init(R);{var B,C,h,e;for(d=N.exp_nspsytune>>2&63,d>=32&&(d-=64),B=Math.pow(10,d/4/10),d=N.exp_nspsytune>>8&63,d>=32&&(d-=64),C=Math.pow(10,d/4/10),d=N.exp_nspsytune>>14&63,d>=32&&(d-=64),h=Math.pow(10,d/4/10),d=N.exp_nspsytune>>20&63,d>=32&&(d-=64),e=h*Math.pow(10,d/4/10),d=0;d<L.SBMAX_l;d++){var t;d<=6?t=B:d<=13?t=C:d<=20?t=h:t=e,R.nsPsy.longfact[d]=t}for(d=0;d<L.SBMAX_s;d++){var t;d<=5?t=B:d<=10?t=C:d<=11?t=h:t=e,R.nsPsy.shortfact[d]=t}}}},this.on_pe=function(N,R,l,d,B,C){var h=N.internal_flags,e=0,t,a=Y(2),n,v=new U(e),b=a0.ResvMaxBits(N,d,v,C);e=v.bits;var M=e+b;for(M>k.MAX_BITS_PER_GRANULE&&(M=k.MAX_BITS_PER_GRANULE),t=0,n=0;n<h.channels_out;++n)l[n]=Math.min(k.MAX_BITS_PER_CHANNEL,e/h.channels_out),a[n]=0|l[n]*R[B][n]/700-l[n],a[n]>d*3/4&&(a[n]=d*3/4),a[n]<0&&(a[n]=0),a[n]+l[n]>k.MAX_BITS_PER_CHANNEL&&(a[n]=Math.max(0,k.MAX_BITS_PER_CHANNEL-l[n])),t+=a[n];if(t>b)for(n=0;n<h.channels_out;++n)a[n]=b*a[n]/t;for(n=0;n<h.channels_out;++n)l[n]+=a[n],b-=a[n];for(t=0,n=0;n<h.channels_out;++n)t+=l[n];if(t>k.MAX_BITS_PER_GRANULE){var f=0;for(n=0;n<h.channels_out;++n)l[n]*=k.MAX_BITS_PER_GRANULE,l[n]/=t,f+=l[n];J(f<=k.MAX_BITS_PER_GRANULE)}return M},this.reduce_side=function(N,R,l,d){J(d<=k.MAX_BITS_PER_GRANULE),J(N[0]+N[1]<=k.MAX_BITS_PER_GRANULE);var B=.33*(.5-R)/.5;B<0&&(B=0),B>.5&&(B=.5);var C=0|B*.5*(N[0]+N[1]);C>k.MAX_BITS_PER_CHANNEL-N[0]&&(C=k.MAX_BITS_PER_CHANNEL-N[0]),C<0&&(C=0),N[1]>=125&&(N[1]-C>125?(N[0]<l&&(N[0]+=C),N[1]-=C):(N[0]+=N[1]-125,N[1]=125)),C=N[0]+N[1],C>d&&(N[0]=d*N[0]/C,N[1]=d*N[1]/C),J(N[0]<=k.MAX_BITS_PER_CHANNEL),J(N[1]<=k.MAX_BITS_PER_CHANNEL),J(N[0]+N[1]<=k.MAX_BITS_PER_GRANULE)},this.athAdjust=function(N,R,l){var d=90.30873362,B=94.82444863,C=n0.FAST_LOG10_X(R,10),h=N*N,e=0;return C-=l,h>1e-20&&(e=1+n0.FAST_LOG10_X(h,10/d)),e<0&&(e=0),C*=e,C+=l+d-B,Math.pow(10,.1*C)},this.calc_xmin=function(N,R,l,d){var B=0,C=N.internal_flags,h,e=0,t=0,a=C.ATH,n=l.xr,v=N.VBR==r0.vbr_mtrh?1:0,b=C.masking_lower;for((N.VBR==r0.vbr_mtrh||N.VBR==r0.vbr_mt)&&(b=1),h=0;h<l.psy_lmax;h++){var M,f,F,P,o0,c0;N.VBR==r0.vbr_rh||N.VBR==r0.vbr_mtrh?f=athAdjust(a.adjust,a.l[h],a.floor):f=a.adjust*a.l[h],o0=l.width[h],F=f/o0,P=A,c0=o0>>1,M=0;do{var d0,b0;d0=n[e]*n[e],M+=d0,P+=d0<F?d0:F,e++,b0=n[e]*n[e],M+=b0,P+=b0<F?b0:F,e++}while(--c0>0);if(M>f&&t++,h==L.SBPSY_l){var S0=f*C.nsPsy.longfact[h];P<S0&&(P=S0)}if(v!=0&&(f=P),!N.ATHonly){var V0=R.en.l[h];if(V0>0){var S0;S0=M*R.thm.l[h]*b/V0,v!=0&&(S0*=C.nsPsy.longfact[h]),f<S0&&(f=S0)}}v!=0?d[B++]=f:d[B++]=f*C.nsPsy.longfact[h]}var U0=575;if(l.block_type!=L.SHORT_TYPE)for(var o=576;o--!=0&&BitStream.EQ(n[o],0);)U0=o;l.max_nonzero_coeff=U0;for(var u=l.sfb_smin;h<l.psymax;u++,h+=3){var o0,x0,M0;for(N.VBR==r0.vbr_rh||N.VBR==r0.vbr_mtrh?M0=athAdjust(a.adjust,a.s[u],a.floor):M0=a.adjust*a.s[u],o0=l.width[h],x0=0;x0<3;x0++){var M=0,f,F,P,c0=o0>>1;F=M0/o0,P=A;do{var d0,b0;d0=n[e]*n[e],M+=d0,P+=d0<F?d0:F,e++,b0=n[e]*n[e],M+=b0,P+=b0<F?b0:F,e++}while(--c0>0);if(M>M0&&t++,u==L.SBPSY_s){var S0=M0*C.nsPsy.shortfact[u];P<S0&&(P=S0)}if(v!=0?f=P:f=M0,!N.ATHonly&&!N.ATHshort){var V0=R.en.s[u][x0];if(V0>0){var S0;S0=M*R.thm.s[u][x0]*b/V0,v!=0&&(S0*=C.nsPsy.shortfact[u]),f<S0&&(f=S0)}}v!=0?d[B++]=f:d[B++]=f*C.nsPsy.shortfact[u]}N.useTemporal&&(d[B-3]>d[B-3+1]&&(d[B-3+1]+=(d[B-3]-d[B-3+1])*C.decay),d[B-3+1]>d[B-3+2]&&(d[B-3+2]+=(d[B-3+1]-d[B-3+2])*C.decay))}return t};function y0(N){this.s=N}this.calc_noise_core=function(N,R,l,d){var B=0,C=R.s,h=N.l3_enc;if(C>N.count1)for(;l--!=0;){var e;e=N.xr[C],C++,B+=e*e,e=N.xr[C],C++,B+=e*e}else if(C>N.big_values){var t=$(2);for(t[0]=0,t[1]=d;l--!=0;){var e;e=Math.abs(N.xr[C])-t[h[C]],C++,B+=e*e,e=Math.abs(N.xr[C])-t[h[C]],C++,B+=e*e}}else for(;l--!=0;){var e;e=Math.abs(N.xr[C])-l0[h[C]]*d,C++,B+=e*e,e=Math.abs(N.xr[C])-l0[h[C]]*d,C++,B+=e*e}return R.s=C,B},this.calc_noise=function(N,R,l,d,B){var C=0,h=0,e,t,a=0,n=0,v=0,b=-20,M=0,f=N.scalefac,F=0;for(d.over_SSD=0,e=0;e<N.psymax;e++){var P=N.global_gain-(f[F++]+(N.preflag!=0?Q[e]:0)<<N.scalefac_scale+1)-N.subblock_gain[N.window[e]]*8,o0=0;if(B!=null&&B.step[e]==P)o0=B.noise[e],M+=N.width[e],l[C++]=o0/R[h++],o0=B.noise_log[e];else{var c0=S(P);if(t=N.width[e]>>1,M+N.width[e]>N.max_nonzero_coeff){var d0;d0=N.max_nonzero_coeff-M+1,d0>0?t=d0>>1:t=0}var b0=new y0(M);o0=this.calc_noise_core(N,b0,t,c0),M=b0.s,B!=null&&(B.step[e]=P,B.noise[e]=o0),o0=l[C++]=o0/R[h++],o0=n0.FAST_LOG10(Math.max(o0,1e-20)),B!=null&&(B.noise_log[e]=o0)}if(B!=null&&(B.global_gain=N.global_gain),v+=o0,o0>0){var S0;S0=Math.max(0|o0*10+.5,1),d.over_SSD+=S0*S0,a++,n+=o0}b=Math.max(b,o0)}return d.over_count=a,d.tot_noise=v,d.over_noise=n,d.max_noise=b,a},this.set_pinfo=function(N,R,l,d,B){var C=N.internal_flags,h,e,t,a,n,v=R.scalefac_scale==0?.5:1,b=R.scalefac,M=$(L3Side.SFBMAX),f=$(L3Side.SFBMAX),F=new CalcNoiseResult;calc_xmin(N,l,R,M),calc_noise(R,M,f,F,null);var P=0;for(e=R.sfb_lmax,R.block_type!=L.SHORT_TYPE&&R.mixed_block_flag==0&&(e=22),h=0;h<e;h++){var o0=C.scalefac_band.l[h],c0=C.scalefac_band.l[h+1],d0=c0-o0;for(a=0;P<c0;P++)a+=R.xr[P]*R.xr[P];a/=d0,n=1e15,C.pinfo.en[d][B][h]=n*a,C.pinfo.xfsf[d][B][h]=n*M[h]*f[h]/d0,l.en.l[h]>0&&!N.ATHonly?a=a/l.en.l[h]:a=0,C.pinfo.thr[d][B][h]=n*Math.max(a*l.thm.l[h],C.ATH.l[h]),C.pinfo.LAMEsfb[d][B][h]=0,R.preflag!=0&&h>=11&&(C.pinfo.LAMEsfb[d][B][h]=-v*Q[h]),h<L.SBPSY_l&&(J(b[h]>=0),C.pinfo.LAMEsfb[d][B][h]-=v*b[h])}if(R.block_type==L.SHORT_TYPE)for(e=h,h=R.sfb_smin;h<L.SBMAX_s;h++)for(var o0=C.scalefac_band.s[h],c0=C.scalefac_band.s[h+1],d0=c0-o0,b0=0;b0<3;b0++){for(a=0,t=o0;t<c0;t++)a+=R.xr[P]*R.xr[P],P++;a=Math.max(a/d0,1e-20),n=1e15,C.pinfo.en_s[d][B][3*h+b0]=n*a,C.pinfo.xfsf_s[d][B][3*h+b0]=n*M[e]*f[e]/d0,l.en.s[h][b0]>0?a=a/l.en.s[h][b0]:a=0,(N.ATHonly||N.ATHshort)&&(a=0),C.pinfo.thr_s[d][B][3*h+b0]=n*Math.max(a*l.thm.s[h][b0],C.ATH.s[h]),C.pinfo.LAMEsfb_s[d][B][3*h+b0]=-2*R.subblock_gain[b0],h<L.SBPSY_s&&(C.pinfo.LAMEsfb_s[d][B][3*h+b0]-=v*b[e]),e++}C.pinfo.LAMEqss[d][B]=R.global_gain,C.pinfo.LAMEmainbits[d][B]=R.part2_3_length+R.part2_length,C.pinfo.LAMEsfbits[d][B]=R.part2_length,C.pinfo.over[d][B]=F.over_count,C.pinfo.max_noise[d][B]=F.max_noise*10,C.pinfo.over_noise[d][B]=F.over_noise*10,C.pinfo.tot_noise[d][B]=F.tot_noise*10,C.pinfo.over_SSD[d][B]=F.over_SSD}}return p1=E,p1}var R1,ca;function Va(){if(ca)return R1;ca=1;var _=$0(),p=_.System;_.VbrMode,_.Float,_.ShortBlock,_.Util;var r0=_.Arrays;_.new_array_n,_.new_byte,_.new_double,_.new_float,_.new_float_n;var K=_.new_int;_.new_int_n;var n0=_.assert,$=ie(),Y=O1(),J=N1(),L=La();function U(){var k=null;this.qupvt=null,this.setModules=function(h){this.qupvt=h,k=h};function E(h){this.bits=0|h}var I=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function a0(h,e,t,a,n,v){var b=.5946/e;for(n0(h>0),h=h>>1;h--!=0;)n[v++]=b>t[a++]?0:1,n[v++]=b>t[a++]?0:1}function e0(h,e,t,a,n,v){n0(h>0),h=h>>1;var b=h%2;for(h=h>>1;h--!=0;){var M,f,F,P,o0,c0,d0,b0;M=t[a++]*e,f=t[a++]*e,o0=0|M,F=t[a++]*e,c0=0|f,P=t[a++]*e,d0=0|F,M+=k.adj43[o0],b0=0|P,f+=k.adj43[c0],n[v++]=0|M,F+=k.adj43[d0],n[v++]=0|f,P+=k.adj43[b0],n[v++]=0|F,n[v++]=0|P}if(b!=0){var M,f,o0,c0;M=t[a++]*e,f=t[a++]*e,o0=0|M,c0=0|f,M+=k.adj43[o0],f+=k.adj43[c0],n[v++]=0|M,n[v++]=0|f}}function S(h,e,t,a,n){var v,b,M=0,f,F=0,P=0,o0=0,c0=e,d0=0,b0=c0,S0=0,V0=h,U0=0;for(f=n!=null&&a.global_gain==n.global_gain,a.block_type==$.SHORT_TYPE?b=38:b=21,v=0;v<=b;v++){var o=-1;if((f||a.block_type==$.NORM_TYPE)&&(o=a.global_gain-(a.scalefac[v]+(a.preflag!=0?k.pretab[v]:0)<<a.scalefac_scale+1)-a.subblock_gain[a.window[v]]*8),n0(a.width[v]>=0),f&&n.step[v]==o)F!=0&&(e0(F,t,V0,U0,b0,S0),F=0),P!=0&&(a0(P,t,V0,U0,b0,S0),P=0);else{var u=a.width[v];if(M+a.width[v]>a.max_nonzero_coeff){var x0;x0=a.max_nonzero_coeff-M+1,r0.fill(e,a.max_nonzero_coeff,576,0),u=x0,u<0&&(u=0),v=b+1}if(F==0&&P==0&&(b0=c0,S0=d0,V0=h,U0=o0),n!=null&&n.sfb_count1>0&&v>=n.sfb_count1&&n.step[v]>0&&o>=n.step[v]?(F!=0&&(e0(F,t,V0,U0,b0,S0),F=0,b0=c0,S0=d0,V0=h,U0=o0),P+=u):(P!=0&&(a0(P,t,V0,U0,b0,S0),P=0,b0=c0,S0=d0,V0=h,U0=o0),F+=u),u<=0){P!=0&&(a0(P,t,V0,U0,b0,S0),P=0),F!=0&&(e0(F,t,V0,U0,b0,S0),F=0);break}}v<=b&&(d0+=a.width[v],o0+=a.width[v],M+=a.width[v])}F!=0&&(e0(F,t,V0,U0,b0,S0),F=0),P!=0&&(a0(P,t,V0,U0,b0,S0),P=0)}function A(h,e,t){var a=0,n=0;do{var v=h[e++],b=h[e++];a<v&&(a=v),n<b&&(n=b)}while(e<t);return a<n&&(a=n),a}function c(h,e,t,a,n,v){var b=Y.ht[a].xlen*65536+Y.ht[n].xlen,M=0,f;do{var F=h[e++],P=h[e++];F!=0&&(F>14&&(F=15,M+=b),F*=16),P!=0&&(P>14&&(P=15,M+=b),F+=P),M+=Y.largetbl[F]}while(e<t);return f=M&65535,M>>=16,M>f&&(M=f,a=n),v.bits+=M,a}function H(h,e,t,a){var n=0,v=Y.ht[1].hlen;do{var b=h[e+0]*2+h[e+1];e+=2,n+=v[b]}while(e<t);return a.bits+=n,1}function r(h,e,t,a,n){var v=0,b,M=Y.ht[a].xlen,f;a==2?f=Y.table23:f=Y.table56;do{var F=h[e+0]*M+h[e+1];e+=2,v+=f[F]}while(e<t);return b=v&65535,v>>=16,v>b&&(v=b,a++),n.bits+=v,a}function V(h,e,t,a,n){var v=0,b=0,M=0,f=Y.ht[a].xlen,F=Y.ht[a].hlen,P=Y.ht[a+1].hlen,o0=Y.ht[a+2].hlen;do{var c0=h[e+0]*f+h[e+1];e+=2,v+=F[c0],b+=P[c0],M+=o0[c0]}while(e<t);var d0=a;return v>b&&(v=b,d0++),v>M&&(v=M,d0=a+2),n.bits+=v,d0}var y=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function Q(h,e,t,a){var n=A(h,e,t);switch(n){case 0:return n;case 1:return H(h,e,t,a);case 2:case 3:return r(h,e,t,y[n-1],a);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return V(h,e,t,y[n-1],a);default:if(n>L.IXMAX_VAL)return a.bits=L.LARGE_BITS,-1;n-=15;var v;for(v=24;v<32&&!(Y.ht[v].linmax>=n);v++);var b;for(b=v-8;b<24&&!(Y.ht[b].linmax>=n);b++);return c(h,e,t,b,v,a)}}this.noquant_count_bits=function(h,e,t){var a=e.l3_enc,n=Math.min(576,e.max_nonzero_coeff+2>>1<<1);for(t!=null&&(t.sfb_count1=0);n>1&&(a[n-1]|a[n-2])==0;n-=2);e.count1=n;for(var v=0,b=0;n>3;n-=4){var M;if(((a[n-1]|a[n-2]|a[n-3]|a[n-4])&2147483647)>1)break;M=((a[n-4]*2+a[n-3])*2+a[n-2])*2+a[n-1],v+=Y.t32l[M],b+=Y.t33l[M]}var f=v;if(e.count1table_select=0,v>b&&(f=b,e.count1table_select=1),e.count1bits=f,e.big_values=n,n==0)return f;if(e.block_type==$.SHORT_TYPE)v=3*h.scalefac_band.s[3],v>e.big_values&&(v=e.big_values),b=e.big_values;else if(e.block_type==$.NORM_TYPE){if(n0(n<=576),v=e.region0_count=h.bv_scf[n-2],b=e.region1_count=h.bv_scf[n-1],n0(v+b+2<$.SBPSY_l),b=h.scalefac_band.l[v+b+2],v=h.scalefac_band.l[v+1],b<n){var F=new E(f);e.table_select[2]=Q(a,b,n,F),f=F.bits}}else e.region0_count=7,e.region1_count=$.SBMAX_l-1-7-1,v=h.scalefac_band.l[8],b=n,v>b&&(v=b);if(v=Math.min(v,n),b=Math.min(b,n),n0(v>=0),n0(b>=0),0<v){var F=new E(f);e.table_select[0]=Q(a,0,v,F),f=F.bits}if(v<b){var F=new E(f);e.table_select[1]=Q(a,v,b,F),f=F.bits}if(h.use_best_huffman==2&&(e.part2_3_length=f,best_huffman_divide(h,e),f=e.part2_3_length),t!=null&&e.block_type==$.NORM_TYPE){for(var P=0;h.scalefac_band.l[P]<e.big_values;)P++;t.sfb_count1=P}return f},this.count_bits=function(h,e,t,a){var n=t.l3_enc,v=L.IXMAX_VAL/k.IPOW20(t.global_gain);if(t.xrpow_max>v)return L.LARGE_BITS;if(S(e,n,k.IPOW20(t.global_gain),t,a),(h.substep_shaping&2)!=0)for(var b=0,M=t.global_gain+t.scalefac_scale,f=.634521682242439/k.IPOW20(M),F=0;F<t.sfbmax;F++){var P=t.width[F];if(n0(P>=0),h.pseudohalf[F]==0)b+=P;else{var o0;for(o0=b,b+=P;o0<b;++o0)n[o0]=e[o0]>=f?n[o0]:0}}return this.noquant_count_bits(h,t,a)};function D(h,e,t,a,n,v,b){for(var M=e.big_values,f=0;f<=22;f++)a[f]=L.LARGE_BITS;for(var f=0;f<16;f++){var F=h.scalefac_band.l[f+1];if(F>=M)break;var P=0,o0=new E(P),c0=Q(t,0,F,o0);P=o0.bits;for(var d0=0;d0<8;d0++){var b0=h.scalefac_band.l[f+d0+2];if(b0>=M)break;var S0=P;o0=new E(S0);var V0=Q(t,F,b0,o0);S0=o0.bits,a[f+d0]>S0&&(a[f+d0]=S0,n[f+d0]=f,v[f+d0]=c0,b[f+d0]=V0)}}}function O(h,e,t,a,n,v,b,M){for(var f=e.big_values,F=2;F<$.SBMAX_l+1;F++){var P=h.scalefac_band.l[F];if(P>=f)break;var o0=n[F-2]+e.count1bits;if(t.part2_3_length<=o0)break;var c0=new E(o0),d0=Q(a,P,f,c0);o0=c0.bits,!(t.part2_3_length<=o0)&&(t.assign(e),t.part2_3_length=o0,t.region0_count=v[F-2],t.region1_count=F-2-v[F-2],t.table_select[0]=b[F-2],t.table_select[1]=M[F-2],t.table_select[2]=d0)}}this.best_huffman_divide=function(h,e){var t=new J,a=e.l3_enc,n=K(23),v=K(23),b=K(23),M=K(23);if(!(e.block_type==$.SHORT_TYPE&&h.mode_gr==1)){t.assign(e),e.block_type==$.NORM_TYPE&&(D(h,e,a,n,v,b,M),O(h,t,e,a,n,v,b,M));var f=t.big_values;if(!(f==0||(a[f-2]|a[f-1])>1)&&(f=e.count1+2,!(f>576))){t.assign(e),t.count1=f;var F=0,P=0;for(n0(f<=576);f>t.big_values;f-=4){var o0=((a[f-4]*2+a[f-3])*2+a[f-2])*2+a[f-1];F+=Y.t32l[o0],P+=Y.t33l[o0]}if(t.big_values=f,t.count1table_select=0,F>P&&(F=P,t.count1table_select=1),t.count1bits=F,t.block_type==$.NORM_TYPE)O(h,t,e,a,n,v,b,M);else{if(t.part2_3_length=F,F=h.scalefac_band.l[8],F>f&&(F=f),F>0){var c0=new E(t.part2_3_length);t.table_select[0]=Q(a,0,F,c0),t.part2_3_length=c0.bits}if(f>F){var c0=new E(t.part2_3_length);t.table_select[1]=Q(a,F,f,c0),t.part2_3_length=c0.bits}e.part2_3_length>t.part2_3_length&&e.assign(t)}}}};var l0=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],h0=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],W=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],m=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];U.slen1_tab=W,U.slen2_tab=m;function y0(h,e){for(var t,a=e.tt[1][h],n=e.tt[0][h],v=0;v<Y.scfsi_band.length-1;v++){for(t=Y.scfsi_band[v];t<Y.scfsi_band[v+1]&&!(n.scalefac[t]!=a.scalefac[t]&&a.scalefac[t]>=0);t++);if(t==Y.scfsi_band[v+1]){for(t=Y.scfsi_band[v];t<Y.scfsi_band[v+1];t++)a.scalefac[t]=-1;e.scfsi[h][v]=1}}var b=0,M=0;for(t=0;t<11;t++)a.scalefac[t]!=-1&&(M++,b<a.scalefac[t]&&(b=a.scalefac[t]));for(var f=0,F=0;t<$.SBPSY_l;t++)a.scalefac[t]!=-1&&(F++,f<a.scalefac[t]&&(f=a.scalefac[t]));for(var v=0;v<16;v++)if(b<l0[v]&&f<h0[v]){var P=W[v]*M+m[v]*F;a.part2_length>P&&(a.part2_length=P,a.scalefac_compress=v)}}this.best_scalefac_store=function(h,e,t,a){var n=a.tt[e][t],v,b,M,f,F=0;for(M=0,v=0;v<n.sfbmax;v++){var P=n.width[v];for(n0(P>=0),M+=P,f=-P;f<0&&n.l3_enc[f+M]==0;f++);f==0&&(n.scalefac[v]=F=-2)}if(n.scalefac_scale==0&&n.preflag==0){var o0=0;for(v=0;v<n.sfbmax;v++)n.scalefac[v]>0&&(o0|=n.scalefac[v]);if((o0&1)==0&&o0!=0){for(v=0;v<n.sfbmax;v++)n.scalefac[v]>0&&(n.scalefac[v]>>=1);n.scalefac_scale=F=1}}if(n.preflag==0&&n.block_type!=$.SHORT_TYPE&&h.mode_gr==2){for(v=11;v<$.SBPSY_l&&!(n.scalefac[v]<k.pretab[v]&&n.scalefac[v]!=-2);v++);if(v==$.SBPSY_l){for(v=11;v<$.SBPSY_l;v++)n.scalefac[v]>0&&(n.scalefac[v]-=k.pretab[v]);n.preflag=F=1}}for(b=0;b<4;b++)a.scfsi[t][b]=0;for(h.mode_gr==2&&e==1&&a.tt[0][t].block_type!=$.SHORT_TYPE&&a.tt[1][t].block_type!=$.SHORT_TYPE&&(y0(t,a),F=0),v=0;v<n.sfbmax;v++)n.scalefac[v]==-2&&(n.scalefac[v]=0);F!=0&&(h.mode_gr==2?this.scale_bitcount(n):this.scale_bitcount_lsf(h,n))};function N(h,e){for(var t=0;t<e;++t)if(h[t]<0)return!1;return!0}var R=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],l=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],d=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(h){var e,t,a=0,n=0,v,b=h.scalefac;if(n0(N(b,h.sfbmax)),h.block_type==$.SHORT_TYPE)v=R,h.mixed_block_flag!=0&&(v=l);else if(v=d,h.preflag==0){for(t=11;t<$.SBPSY_l&&!(b[t]<k.pretab[t]);t++);if(t==$.SBPSY_l)for(h.preflag=1,t=11;t<$.SBPSY_l;t++)b[t]-=k.pretab[t]}for(t=0;t<h.sfbdivide;t++)a<b[t]&&(a=b[t]);for(;t<h.sfbmax;t++)n<b[t]&&(n=b[t]);for(h.part2_length=L.LARGE_BITS,e=0;e<16;e++)a<l0[e]&&n<h0[e]&&h.part2_length>v[e]&&(h.part2_length=v[e],h.scalefac_compress=e);return h.part2_length==L.LARGE_BITS};var B=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(h,e){var t,a,n,v,b,M,f,F,P=K(4),o0=e.scalefac;for(e.preflag!=0?t=2:t=0,f=0;f<4;f++)P[f]=0;if(e.block_type==$.SHORT_TYPE){a=1;var c0=k.nr_of_sfb_block[t][a];for(F=0,n=0;n<4;n++)for(v=c0[n]/3,f=0;f<v;f++,F++)for(b=0;b<3;b++)o0[F*3+b]>P[n]&&(P[n]=o0[F*3+b])}else{a=0;var c0=k.nr_of_sfb_block[t][a];for(F=0,n=0;n<4;n++)for(v=c0[n],f=0;f<v;f++,F++)o0[F]>P[n]&&(P[n]=o0[F])}for(M=!1,n=0;n<4;n++)P[n]>B[t][n]&&(M=!0);if(!M){var d0,b0,S0,V0;for(e.sfb_partition_table=k.nr_of_sfb_block[t][a],n=0;n<4;n++)e.slen[n]=C[P[n]];switch(d0=e.slen[0],b0=e.slen[1],S0=e.slen[2],V0=e.slen[3],t){case 0:e.scalefac_compress=(d0*5+b0<<4)+(S0<<2)+V0;break;case 1:e.scalefac_compress=400+(d0*5+b0<<2)+S0;break;case 2:e.scalefac_compress=500+d0*3+b0;break;default:p.err.printf(`intensity stereo not implemented yet
`);break}}if(!M)for(n0(e.sfb_partition_table!=null),e.part2_length=0,n=0;n<4;n++)e.part2_length+=e.slen[n]*e.sfb_partition_table[n];return M};var C=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(h){for(var e=2;e<=576;e+=2){for(var t=0,a;h.scalefac_band.l[++t]<e;);for(a=I[t][0];h.scalefac_band.l[a+1]>e;)a--;for(a<0&&(a=I[t][0]),h.bv_scf[e-2]=a,a=I[t][1];h.scalefac_band.l[a+h.bv_scf[e-2]+2]>e;)a--;a<0&&(a=I[t][1]),h.bv_scf[e-1]=a}}}return R1=U,R1}var A1,ma;function Na(){if(ma)return A1;ma=1;var _=$0(),p=_.System;_.VbrMode,_.Float,_.ShortBlock,_.Util;var r0=_.Arrays;_.new_array_n;var K=_.new_byte;_.new_double,_.new_float;var n0=_.new_float_n,$=_.new_int;_.new_int_n;var Y=_.assert,J=Va(),L=O1(),U=ie(),k=Ye();E.EQ=function(I,a0){return Math.abs(I)>Math.abs(a0)?Math.abs(I-a0)<=Math.abs(I)*1e-6:Math.abs(I-a0)<=Math.abs(a0)*1e-6},E.NEQ=function(I,a0){return!E.EQ(I,a0)};function E(){var I=this,a0=32773,e0=32,S=null,A=null,c=null,H=null;this.setModules=function(e,t,a,n){S=e,A=t,c=a,H=n};var r=null,V=0,y=0,Q=0;this.getframebits=function(e){var t=e.internal_flags,a;t.bitrate_index!=0?a=L.bitrate_table[e.version][t.bitrate_index]:a=e.brate,Y(8<=a&&a<=640);var n=0|(e.version+1)*72e3*a/e.out_samplerate+t.padding;return 8*n};function D(e){p.arraycopy(e.header[e.w_ptr].buf,0,r,y,e.sideinfo_len),y+=e.sideinfo_len,V+=e.sideinfo_len*8,e.w_ptr=e.w_ptr+1&k.MAX_HEADER_BUF-1}function O(e,t,a){for(Y(a<e0-2);a>0;){var n;Q==0&&(Q=8,y++,Y(y<Lame.LAME_MAXMP3BUFFER),Y(e.header[e.w_ptr].write_timing>=V),e.header[e.w_ptr].write_timing==V&&D(e),r[y]=0),n=Math.min(a,Q),a-=n,Q-=n,Y(a<e0),Y(Q<e0),r[y]|=t>>a<<Q,V+=n}}function l0(e,t,a){for(Y(a<e0-2);a>0;){var n;Q==0&&(Q=8,y++,Y(y<Lame.LAME_MAXMP3BUFFER),r[y]=0),n=Math.min(a,Q),a-=n,Q-=n,Y(a<e0),Y(Q<e0),r[y]|=t>>a<<Q,V+=n}}function h0(e,t){var a=e.internal_flags,n;if(Y(t>=0),t>=8&&(O(a,76,8),t-=8),t>=8&&(O(a,65,8),t-=8),t>=8&&(O(a,77,8),t-=8),t>=8&&(O(a,69,8),t-=8),t>=32){var v=c.getLameShortVersion();if(t>=32)for(n=0;n<v.length&&t>=8;++n)t-=8,O(a,v.charAt(n),8)}for(;t>=1;t-=1)O(a,a.ancillary_flag,1),a.ancillary_flag^=e.disable_reservoir?0:1;Y(t==0)}function W(e,t,a){for(var n=e.header[e.h_ptr].ptr;a>0;){var v=Math.min(a,8-(n&7));a-=v,Y(a<e0),e.header[e.h_ptr].buf[n>>3]|=t>>a<<8-(n&7)-v,n+=v}e.header[e.h_ptr].ptr=n}function m(e,t){e<<=8;for(var a=0;a<8;a++)e<<=1,t<<=1,((t^e)&65536)!=0&&(t^=a0);return t}this.CRC_writeheader=function(e,t){var a=65535;a=m(t[2]&255,a),a=m(t[3]&255,a);for(var n=6;n<e.sideinfo_len;n++)a=m(t[n]&255,a);t[4]=byte(a>>8),t[5]=byte(a&255)};function y0(e,t){var a=e.internal_flags,n,v,b;if(n=a.l3_side,a.header[a.h_ptr].ptr=0,r0.fill(a.header[a.h_ptr].buf,0,a.sideinfo_len,0),e.out_samplerate<16e3?W(a,4094,12):W(a,4095,12),W(a,e.version,1),W(a,1,2),W(a,e.error_protection?0:1,1),W(a,a.bitrate_index,4),W(a,a.samplerate_index,2),W(a,a.padding,1),W(a,e.extension,1),W(a,e.mode.ordinal(),2),W(a,a.mode_ext,2),W(a,e.copyright,1),W(a,e.original,1),W(a,e.emphasis,2),e.error_protection&&W(a,0,16),e.version==1){for(Y(n.main_data_begin>=0),W(a,n.main_data_begin,9),a.channels_out==2?W(a,n.private_bits,3):W(a,n.private_bits,5),b=0;b<a.channels_out;b++){var M;for(M=0;M<4;M++)W(a,n.scfsi[b][M],1)}for(v=0;v<2;v++)for(b=0;b<a.channels_out;b++){var f=n.tt[v][b];W(a,f.part2_3_length+f.part2_length,12),W(a,f.big_values/2,9),W(a,f.global_gain,8),W(a,f.scalefac_compress,4),f.block_type!=U.NORM_TYPE?(W(a,1,1),W(a,f.block_type,2),W(a,f.mixed_block_flag,1),f.table_select[0]==14&&(f.table_select[0]=16),W(a,f.table_select[0],5),f.table_select[1]==14&&(f.table_select[1]=16),W(a,f.table_select[1],5),W(a,f.subblock_gain[0],3),W(a,f.subblock_gain[1],3),W(a,f.subblock_gain[2],3)):(W(a,0,1),f.table_select[0]==14&&(f.table_select[0]=16),W(a,f.table_select[0],5),f.table_select[1]==14&&(f.table_select[1]=16),W(a,f.table_select[1],5),f.table_select[2]==14&&(f.table_select[2]=16),W(a,f.table_select[2],5),Y(0<=f.region0_count&&f.region0_count<16),Y(0<=f.region1_count&&f.region1_count<8),W(a,f.region0_count,4),W(a,f.region1_count,3)),W(a,f.preflag,1),W(a,f.scalefac_scale,1),W(a,f.count1table_select,1)}}else for(Y(n.main_data_begin>=0),W(a,n.main_data_begin,8),W(a,n.private_bits,a.channels_out),v=0,b=0;b<a.channels_out;b++){var f=n.tt[v][b];W(a,f.part2_3_length+f.part2_length,12),W(a,f.big_values/2,9),W(a,f.global_gain,8),W(a,f.scalefac_compress,9),f.block_type!=U.NORM_TYPE?(W(a,1,1),W(a,f.block_type,2),W(a,f.mixed_block_flag,1),f.table_select[0]==14&&(f.table_select[0]=16),W(a,f.table_select[0],5),f.table_select[1]==14&&(f.table_select[1]=16),W(a,f.table_select[1],5),W(a,f.subblock_gain[0],3),W(a,f.subblock_gain[1],3),W(a,f.subblock_gain[2],3)):(W(a,0,1),f.table_select[0]==14&&(f.table_select[0]=16),W(a,f.table_select[0],5),f.table_select[1]==14&&(f.table_select[1]=16),W(a,f.table_select[1],5),f.table_select[2]==14&&(f.table_select[2]=16),W(a,f.table_select[2],5),Y(0<=f.region0_count&&f.region0_count<16),Y(0<=f.region1_count&&f.region1_count<8),W(a,f.region0_count,4),W(a,f.region1_count,3)),W(a,f.scalefac_scale,1),W(a,f.count1table_select,1)}e.error_protection&&CRC_writeheader(a,a.header[a.h_ptr].buf);{var F=a.h_ptr;Y(a.header[F].ptr==a.sideinfo_len*8),a.h_ptr=F+1&k.MAX_HEADER_BUF-1,a.header[a.h_ptr].write_timing=a.header[F].write_timing+t,a.h_ptr==a.w_ptr&&p.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function N(e,t){var a=L.ht[t.count1table_select+32],n,v=0,b=t.big_values,M=t.big_values;for(Y(t.count1table_select<2),n=(t.count1-t.big_values)/4;n>0;--n){var f=0,F=0,P;P=t.l3_enc[b+0],P!=0&&(F+=8,t.xr[M+0]<0&&f++,Y(P<=1)),P=t.l3_enc[b+1],P!=0&&(F+=4,f*=2,t.xr[M+1]<0&&f++,Y(P<=1)),P=t.l3_enc[b+2],P!=0&&(F+=2,f*=2,t.xr[M+2]<0&&f++,Y(P<=1)),P=t.l3_enc[b+3],P!=0&&(F++,f*=2,t.xr[M+3]<0&&f++,Y(P<=1)),b+=4,M+=4,O(e,f+a.table[F],a.hlen[F]),v+=a.hlen[F]}return v}function R(e,t,a,n,v){var b=L.ht[t],M=0;if(Y(t<32),t==0)return M;for(var f=a;f<n;f+=2){var F=0,P=0,o0=b.xlen,c0=b.xlen,d0=0,b0=v.l3_enc[f],S0=v.l3_enc[f+1];if(b0!=0&&(v.xr[f]<0&&d0++,F--),t>15){if(b0>14){var V0=b0-15;Y(V0<=b.linmax),d0|=V0<<1,P=o0,b0=15}if(S0>14){var U0=S0-15;Y(U0<=b.linmax),d0<<=o0,d0|=U0,P+=o0,S0=15}c0=16}S0!=0&&(d0<<=1,v.xr[f+1]<0&&d0++,F--),Y((b0|S0)<16),b0=b0*c0+S0,P-=F,F+=b.hlen[b0],Y(F<=e0),Y(P<=e0),O(e,b.table[b0],F),O(e,d0,P),M+=F+P}return M}function l(e,t){var a=3*e.scalefac_band.s[3];a>t.big_values&&(a=t.big_values);var n=R(e,t.table_select[0],0,a,t);return n+=R(e,t.table_select[1],a,t.big_values,t),n}function d(e,t){var a,n,v,b;a=t.big_values,Y(0<=a&&a<=576);var M=t.region0_count+1;return Y(0<=M),Y(M<e.scalefac_band.l.length),v=e.scalefac_band.l[M],M+=t.region1_count+1,Y(0<=M),Y(M<e.scalefac_band.l.length),b=e.scalefac_band.l[M],v>a&&(v=a),b>a&&(b=a),n=R(e,t.table_select[0],0,v,t),n+=R(e,t.table_select[1],v,b,t),n+=R(e,t.table_select[2],b,a,t),n}function B(e){var t,a,n,v,b=0,M=e.internal_flags,f=M.l3_side;if(e.version==1)for(t=0;t<2;t++)for(a=0;a<M.channels_out;a++){var F=f.tt[t][a],P=J.slen1_tab[F.scalefac_compress],o0=J.slen2_tab[F.scalefac_compress];for(v=0,n=0;n<F.sfbdivide;n++)F.scalefac[n]!=-1&&(O(M,F.scalefac[n],P),v+=P);for(;n<F.sfbmax;n++)F.scalefac[n]!=-1&&(O(M,F.scalefac[n],o0),v+=o0);Y(v==F.part2_length),F.block_type==U.SHORT_TYPE?v+=l(M,F):v+=d(M,F),v+=N(M,F),Y(v==F.part2_3_length+F.part2_length),b+=v}else for(t=0,a=0;a<M.channels_out;a++){var F=f.tt[t][a],c0,d0,b0=0;if(Y(F.sfb_partition_table!=null),v=0,n=0,d0=0,F.block_type==U.SHORT_TYPE){for(;d0<4;d0++){var S0=F.sfb_partition_table[d0]/3,V0=F.slen[d0];for(c0=0;c0<S0;c0++,n++)O(M,Math.max(F.scalefac[n*3+0],0),V0),O(M,Math.max(F.scalefac[n*3+1],0),V0),O(M,Math.max(F.scalefac[n*3+2],0),V0),b0+=3*V0}v+=l(M,F)}else{for(;d0<4;d0++){var S0=F.sfb_partition_table[d0],V0=F.slen[d0];for(c0=0;c0<S0;c0++,n++)O(M,Math.max(F.scalefac[n],0),V0),b0+=V0}v+=d(M,F)}v+=N(M,F),Y(v==F.part2_3_length),Y(b0==F.part2_length),b+=b0+v}return b}function C(){this.total=0}function h(e,t){var a=e.internal_flags,n,v,b,M,f;return f=a.w_ptr,M=a.h_ptr-1,M==-1&&(M=k.MAX_HEADER_BUF-1),n=a.header[M].write_timing-V,t.total=n,n>=0&&(v=1+M-f,M<f&&(v=1+M-f+k.MAX_HEADER_BUF),n-=v*8*a.sideinfo_len),b=I.getframebits(e),n+=b,t.total+=b,t.total%8!=0?t.total=1+t.total/8:t.total=t.total/8,t.total+=y+1,n<0&&p.err.println(`strange error flushing buffer ... 
`),n}this.flush_bitstream=function(e){var t=e.internal_flags,a,n,v=t.h_ptr-1;if(v==-1&&(v=k.MAX_HEADER_BUF-1),a=t.l3_side,!((n=h(e,new C))<0)){if(h0(e,n),Y(t.header[v].write_timing+this.getframebits(e)==V),t.ResvSize=0,a.main_data_begin=0,t.findReplayGain){var b=S.GetTitleGain(t.rgdata);Y(NEQ(b,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),t.RadioGain=Math.floor(b*10+.5)|0}t.findPeakSample&&(t.noclipGainChange=Math.ceil(Math.log10(t.PeakSample/32767)*20*10)|0,t.noclipGainChange>0&&(EQ(e.scale,1)||EQ(e.scale,0))?t.noclipScale=Math.floor(32767/t.PeakSample*100)/100:t.noclipScale=-1)}},this.add_dummy_byte=function(e,t,a){for(var n=e.internal_flags,v;a-- >0;)for(l0(n,t,8),v=0;v<k.MAX_HEADER_BUF;++v)n.header[v].write_timing+=8},this.format_bitstream=function(e){var t=e.internal_flags,a;a=t.l3_side;var n=this.getframebits(e);h0(e,a.resvDrain_pre),y0(e,n);var v=8*t.sideinfo_len;if(v+=B(e),h0(e,a.resvDrain_post),v+=a.resvDrain_post,a.main_data_begin+=(n-v)/8,h(e,new C)!=t.ResvSize&&p.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),a.main_data_begin*8!=t.ResvSize&&(p.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*a.main_data_begin,t.ResvSize,a.resvDrain_post,a.resvDrain_pre,8*t.sideinfo_len,v-a.resvDrain_post-8*t.sideinfo_len,v,v%8,n),p.err.println("This is a fatal error.  It has several possible causes:"),p.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),p.err.println(" 9%%  Your system is overclocked"),p.err.println(" 1%%  bug in LAME encoding library"),t.ResvSize=a.main_data_begin*8),Y(V%8==0),V>1e9){var b;for(b=0;b<k.MAX_HEADER_BUF;++b)t.header[b].write_timing-=V;V=0}return 0},this.copy_buffer=function(e,t,a,n,v){var b=y+1;if(b<=0)return 0;if(n!=0&&b>n)return-1;if(p.arraycopy(r,0,t,a,b),y=-1,Q=0,v!=0){var M=$(1);if(M[0]=e.nMusicCRC,H.updateMusicCRC(M,t,a,b),e.nMusicCRC=M[0],b>0&&(e.VBR_seek_table.nBytesWritten+=b),e.decode_on_the_fly){for(var f=n0([2,1152]),F=b,P=-1,o0;P!=0;)if(P=A.hip_decode1_unclipped(e.hip,t,a,F,f[0],f[1]),F=0,P==-1&&(P=0),P>0){if(Y(P<=1152),e.findPeakSample){for(o0=0;o0<P;o0++)f[0][o0]>e.PeakSample?e.PeakSample=f[0][o0]:-f[0][o0]>e.PeakSample&&(e.PeakSample=-f[0][o0]);if(e.channels_out>1)for(o0=0;o0<P;o0++)f[1][o0]>e.PeakSample?e.PeakSample=f[1][o0]:-f[1][o0]>e.PeakSample&&(e.PeakSample=-f[1][o0])}if(e.findReplayGain&&S.AnalyzeSamples(e.rgdata,f[0],0,f[1],0,P,e.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return b},this.init_bit_stream_w=function(e){r=K(Lame.LAME_MAXMP3BUFFER),e.h_ptr=e.w_ptr=0,e.header[e.h_ptr].write_timing=0,y=-1,Q=0,V=0}}return A1=E,A1}var y1,ba;function tt(){if(ba)return y1;ba=1;var _=$0(),p=_.System,r0=_.VbrMode;_.Float;var K=_.ShortBlock;_.Util,_.Arrays,_.new_array_n,_.new_byte,_.new_double;var n0=_.new_float;_.new_float_n,_.new_int;var $=_.new_int_n,Y=_.new_short_n,J=_.assert,L=za(),U=Qa(),k=Ye(),E=ga(),I=et(),a0=at(),e0=Na(),S=O1(),A=ie();function c(){var H=this,r=128*1024;c.V9=410,c.V8=420,c.V7=430,c.V6=440,c.V5=450,c.V4=460,c.V3=470,c.V2=480,c.V1=490,c.V0=500,c.R3MIX=1e3,c.STANDARD=1001,c.EXTREME=1002,c.INSANE=1003,c.STANDARD_FAST=1004,c.EXTREME_FAST=1005,c.MEDIUM=1006,c.MEDIUM_FAST=1007;var V=16384+r;c.LAME_MAXMP3BUFFER=V;var y,Q,D,O,l0,h0=new L,W,m,y0;this.enc=new A,this.setModules=function(o,u,x0,M0,L0,T0,E0,A0,D0){y=o,Q=u,D=x0,O=M0,l0=L0,W=T0,m=A0,y0=D0,this.enc.setModules(Q,h0,O,W)};function N(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=n0(A.SBMAX_l),this.bo_s_weight=n0(A.SBMAX_s)}function R(){this.lowerlimit=0}function l(o,u){this.lowpass=u}var d=4294479419;function B(o){var u;return o.class_id=d,u=o.internal_flags=new k,o.mode=MPEGMode.NOT_SET,o.original=1,o.in_samplerate=44100,o.num_channels=2,o.num_samples=-1,o.bWriteVbrTag=!0,o.quality=-1,o.short_blocks=null,u.subblock_gain=-1,o.lowpassfreq=0,o.highpassfreq=0,o.lowpasswidth=-1,o.highpasswidth=-1,o.VBR=r0.vbr_off,o.VBR_q=4,o.ATHcurve=-1,o.VBR_mean_bitrate_kbps=128,o.VBR_min_bitrate_kbps=0,o.VBR_max_bitrate_kbps=0,o.VBR_hard_min=0,u.VBR_min_bitrate=1,u.VBR_max_bitrate=13,o.quant_comp=-1,o.quant_comp_short=-1,o.msfix=-1,u.resample_ratio=1,u.OldValue[0]=180,u.OldValue[1]=180,u.CurrentStep[0]=4,u.CurrentStep[1]=4,u.masking_lower=1,u.nsPsy.attackthre=-1,u.nsPsy.attackthre_s=-1,o.scale=-1,o.athaa_type=-1,o.ATHtype=-1,o.athaa_loudapprox=-1,o.athaa_sensitivity=0,o.useTemporal=null,o.interChRatio=-1,u.mf_samples_to_encode=A.ENCDELAY+A.POSTDELAY,o.encoder_padding=0,u.mf_size=A.ENCDELAY-A.MDCTDELAY,o.findReplayGain=!1,o.decode_on_the_fly=!1,u.decode_on_the_fly=!1,u.findReplayGain=!1,u.findPeakSample=!1,u.RadioGain=0,u.AudiophileGain=0,u.noclipGainChange=0,u.noclipScale=-1,o.preset=0,o.write_id3tag_automatic=!0,0}this.lame_init=function(){var o=new U;return B(o),o.lame_allocated_gfp=1,o};function C(o){return o>1?0:o<=0?1:Math.cos(Math.PI/2*o)}this.nearestBitrateFullIndex=function(o){var u=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],x0=0,M0=0,L0=0,T0=0;T0=u[16],L0=16,M0=u[16],x0=16;for(var E0=0;E0<16;E0++)if(Math.max(o,u[E0+1])!=o){T0=u[E0+1],L0=E0+1,M0=u[E0],x0=E0;break}return T0-o>o-M0?x0:L0};function h(o,u){var x0=44100;return u>=48e3?x0=48e3:u>=44100?x0=44100:u>=32e3?x0=32e3:u>=24e3?x0=24e3:u>=22050?x0=22050:u>=16e3?x0=16e3:u>=12e3?x0=12e3:u>=11025?x0=11025:u>=8e3&&(x0=8e3),o==-1?x0:(o<=15960&&(x0=44100),o<=15250&&(x0=32e3),o<=11220&&(x0=24e3),o<=9970&&(x0=22050),o<=7230&&(x0=16e3),o<=5420&&(x0=12e3),o<=4510&&(x0=11025),o<=3970&&(x0=8e3),u<x0?u>44100?48e3:u>32e3?44100:u>24e3?32e3:u>22050?24e3:u>16e3?22050:u>12e3?16e3:u>11025?12e3:u>8e3?11025:8e3:x0)}function e(o,u){switch(o){case 44100:return u.version=1,0;case 48e3:return u.version=1,1;case 32e3:return u.version=1,2;case 22050:return u.version=0,0;case 24e3:return u.version=0,1;case 16e3:return u.version=0,2;case 11025:return u.version=0,0;case 12e3:return u.version=0,1;case 8e3:return u.version=0,2;default:return u.version=0,-1}}function t(o,u,x0){x0<16e3&&(u=2);for(var M0=S.bitrate_table[u][1],L0=2;L0<=14;L0++)S.bitrate_table[u][L0]>0&&Math.abs(S.bitrate_table[u][L0]-o)<Math.abs(M0-o)&&(M0=S.bitrate_table[u][L0]);return M0}function a(o,u,x0){x0<16e3&&(u=2);for(var M0=0;M0<=14;M0++)if(S.bitrate_table[u][M0]>0&&S.bitrate_table[u][M0]==o)return M0;return-1}function n(o,u){var x0=[new l(8,2e3),new l(16,3700),new l(24,3900),new l(32,5500),new l(40,7e3),new l(48,7500),new l(56,1e4),new l(64,11e3),new l(80,13500),new l(96,15100),new l(112,15600),new l(128,17e3),new l(160,17500),new l(192,18600),new l(224,19400),new l(256,19700),new l(320,20500)],M0=H.nearestBitrateFullIndex(u);o.lowerlimit=x0[M0].lowpass}function v(o){var u=o.internal_flags,x0=32,M0=-1;if(u.lowpass1>0){for(var L0=999,T0=0;T0<=31;T0++){var E0=T0/31;E0>=u.lowpass2&&(x0=Math.min(x0,T0)),u.lowpass1<E0&&E0<u.lowpass2&&(L0=Math.min(L0,T0))}L0==999?u.lowpass1=(x0-.75)/31:u.lowpass1=(L0-.75)/31,u.lowpass2=x0/31}if(u.highpass2>0&&u.highpass2<.9*(.75/31)&&(u.highpass1=0,u.highpass2=0,p.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),u.highpass2>0){for(var A0=-1,T0=0;T0<=31;T0++){var E0=T0/31;E0<=u.highpass1&&(M0=Math.max(M0,T0)),u.highpass1<E0&&E0<u.highpass2&&(A0=Math.max(A0,T0))}u.highpass1=M0/31,A0==-1?u.highpass2=(M0+.75)/31:u.highpass2=(A0+.75)/31}for(var T0=0;T0<32;T0++){var D0,k0,E0=T0/31;u.highpass2>u.highpass1?D0=C((u.highpass2-E0)/(u.highpass2-u.highpass1+1e-20)):D0=1,u.lowpass2>u.lowpass1?k0=C((E0-u.lowpass1)/(u.lowpass2-u.lowpass1+1e-20)):k0=1,u.amp_filter[T0]=D0*k0}}function b(o){var u=o.internal_flags;switch(o.quality){default:case 9:u.psymodel=0,u.noise_shaping=0,u.noise_shaping_amp=0,u.noise_shaping_stop=0,u.use_best_huffman=0,u.full_outer_loop=0;break;case 8:o.quality=7;case 7:u.psymodel=1,u.noise_shaping=0,u.noise_shaping_amp=0,u.noise_shaping_stop=0,u.use_best_huffman=0,u.full_outer_loop=0;break;case 6:u.psymodel=1,u.noise_shaping==0&&(u.noise_shaping=1),u.noise_shaping_amp=0,u.noise_shaping_stop=0,u.subblock_gain==-1&&(u.subblock_gain=1),u.use_best_huffman=0,u.full_outer_loop=0;break;case 5:u.psymodel=1,u.noise_shaping==0&&(u.noise_shaping=1),u.noise_shaping_amp=0,u.noise_shaping_stop=0,u.subblock_gain==-1&&(u.subblock_gain=1),u.use_best_huffman=0,u.full_outer_loop=0;break;case 4:u.psymodel=1,u.noise_shaping==0&&(u.noise_shaping=1),u.noise_shaping_amp=0,u.noise_shaping_stop=0,u.subblock_gain==-1&&(u.subblock_gain=1),u.use_best_huffman=1,u.full_outer_loop=0;break;case 3:u.psymodel=1,u.noise_shaping==0&&(u.noise_shaping=1),u.noise_shaping_amp=1,u.noise_shaping_stop=1,u.subblock_gain==-1&&(u.subblock_gain=1),u.use_best_huffman=1,u.full_outer_loop=0;break;case 2:u.psymodel=1,u.noise_shaping==0&&(u.noise_shaping=1),u.substep_shaping==0&&(u.substep_shaping=2),u.noise_shaping_amp=1,u.noise_shaping_stop=1,u.subblock_gain==-1&&(u.subblock_gain=1),u.use_best_huffman=1,u.full_outer_loop=0;break;case 1:u.psymodel=1,u.noise_shaping==0&&(u.noise_shaping=1),u.substep_shaping==0&&(u.substep_shaping=2),u.noise_shaping_amp=2,u.noise_shaping_stop=1,u.subblock_gain==-1&&(u.subblock_gain=1),u.use_best_huffman=1,u.full_outer_loop=0;break;case 0:u.psymodel=1,u.noise_shaping==0&&(u.noise_shaping=1),u.substep_shaping==0&&(u.substep_shaping=2),u.noise_shaping_amp=2,u.noise_shaping_stop=1,u.subblock_gain==-1&&(u.subblock_gain=1),u.use_best_huffman=1,u.full_outer_loop=0;break}}function M(o){var u=o.internal_flags;o.frameNum=0,o.write_id3tag_automatic&&m.id3tag_write_v2(o),u.bitrate_stereoMode_Hist=$([16,5]),u.bitrate_blockType_Hist=$([16,6]),u.PeakSample=0,o.bWriteVbrTag&&W.InitVbrTag(o)}this.lame_init_params=function(o){var u=o.internal_flags;if(u.Class_ID=0,u.ATH==null&&(u.ATH=new E),u.PSY==null&&(u.PSY=new N),u.rgdata==null&&(u.rgdata=new I),u.channels_in=o.num_channels,u.channels_in==1&&(o.mode=MPEGMode.MONO),u.channels_out=o.mode==MPEGMode.MONO?1:2,u.mode_ext=A.MPG_MD_MS_LR,o.mode==MPEGMode.MONO&&(o.force_ms=!1),o.VBR==r0.vbr_off&&o.VBR_mean_bitrate_kbps!=128&&o.brate==0&&(o.brate=o.VBR_mean_bitrate_kbps),o.VBR==r0.vbr_off||o.VBR==r0.vbr_mtrh||o.VBR==r0.vbr_mt||(o.free_format=!1),o.VBR==r0.vbr_off&&o.brate==0&&e0.EQ(o.compression_ratio,0)&&(o.compression_ratio=11.025),o.VBR==r0.vbr_off&&o.compression_ratio>0&&(o.out_samplerate==0&&(o.out_samplerate=map2MP3Frequency(int(.97*o.in_samplerate))),o.brate=0|o.out_samplerate*16*u.channels_out/(1e3*o.compression_ratio),u.samplerate_index=e(o.out_samplerate,o),o.free_format||(o.brate=t(o.brate,o.version,o.out_samplerate))),o.out_samplerate!=0&&(o.out_samplerate<16e3?(o.VBR_mean_bitrate_kbps=Math.max(o.VBR_mean_bitrate_kbps,8),o.VBR_mean_bitrate_kbps=Math.min(o.VBR_mean_bitrate_kbps,64)):o.out_samplerate<32e3?(o.VBR_mean_bitrate_kbps=Math.max(o.VBR_mean_bitrate_kbps,8),o.VBR_mean_bitrate_kbps=Math.min(o.VBR_mean_bitrate_kbps,160)):(o.VBR_mean_bitrate_kbps=Math.max(o.VBR_mean_bitrate_kbps,32),o.VBR_mean_bitrate_kbps=Math.min(o.VBR_mean_bitrate_kbps,320))),o.lowpassfreq==0){var x0=16e3;switch(o.VBR){case r0.vbr_off:{var M0=new R;n(M0,o.brate),x0=M0.lowerlimit;break}case r0.vbr_abr:{var M0=new R;n(M0,o.VBR_mean_bitrate_kbps),x0=M0.lowerlimit;break}case r0.vbr_rh:{var L0=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=o.VBR_q&&o.VBR_q<=9){var T0=L0[o.VBR_q],E0=L0[o.VBR_q+1],A0=o.VBR_q_frac;x0=linear_int(T0,E0,A0)}else x0=19500;break}default:{var L0=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=o.VBR_q&&o.VBR_q<=9){var T0=L0[o.VBR_q],E0=L0[o.VBR_q+1],A0=o.VBR_q_frac;x0=linear_int(T0,E0,A0)}else x0=19500}}o.mode==MPEGMode.MONO&&(o.VBR==r0.vbr_off||o.VBR==r0.vbr_abr)&&(x0*=1.5),o.lowpassfreq=x0|0}if(o.out_samplerate==0&&(2*o.lowpassfreq>o.in_samplerate&&(o.lowpassfreq=o.in_samplerate/2),o.out_samplerate=h(o.lowpassfreq|0,o.in_samplerate)),o.lowpassfreq=Math.min(20500,o.lowpassfreq),o.lowpassfreq=Math.min(o.out_samplerate/2,o.lowpassfreq),o.VBR==r0.vbr_off&&(o.compression_ratio=o.out_samplerate*16*u.channels_out/(1e3*o.brate)),o.VBR==r0.vbr_abr&&(o.compression_ratio=o.out_samplerate*16*u.channels_out/(1e3*o.VBR_mean_bitrate_kbps)),o.bWriteVbrTag||(o.findReplayGain=!1,o.decode_on_the_fly=!1,u.findPeakSample=!1),u.findReplayGain=o.findReplayGain,u.decode_on_the_fly=o.decode_on_the_fly,u.decode_on_the_fly&&(u.findPeakSample=!0),u.findReplayGain&&y.InitGainAnalysis(u.rgdata,o.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return o.internal_flags=null,-6;switch(u.decode_on_the_fly&&!o.decode_only&&(u.hip!=null&&y0.hip_decode_exit(u.hip),u.hip=y0.hip_decode_init()),u.mode_gr=o.out_samplerate<=24e3?1:2,o.framesize=576*u.mode_gr,o.encoder_delay=A.ENCDELAY,u.resample_ratio=o.in_samplerate/o.out_samplerate,o.VBR){case r0.vbr_mt:case r0.vbr_rh:case r0.vbr_mtrh:{var D0=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];o.compression_ratio=D0[o.VBR_q]}break;case r0.vbr_abr:o.compression_ratio=o.out_samplerate*16*u.channels_out/(1e3*o.VBR_mean_bitrate_kbps);break;default:o.compression_ratio=o.out_samplerate*16*u.channels_out/(1e3*o.brate);break}if(o.mode==MPEGMode.NOT_SET&&(o.mode=MPEGMode.JOINT_STEREO),o.highpassfreq>0?(u.highpass1=2*o.highpassfreq,o.highpasswidth>=0?u.highpass2=2*(o.highpassfreq+o.highpasswidth):u.highpass2=2*o.highpassfreq,u.highpass1/=o.out_samplerate,u.highpass2/=o.out_samplerate):(u.highpass1=0,u.highpass2=0),o.lowpassfreq>0?(u.lowpass2=2*o.lowpassfreq,o.lowpasswidth>=0?(u.lowpass1=2*(o.lowpassfreq-o.lowpasswidth),u.lowpass1<0&&(u.lowpass1=0)):u.lowpass1=2*o.lowpassfreq,u.lowpass1/=o.out_samplerate,u.lowpass2/=o.out_samplerate):(u.lowpass1=0,u.lowpass2=0),v(o),u.samplerate_index=e(o.out_samplerate,o),u.samplerate_index<0)return o.internal_flags=null,-1;if(o.VBR==r0.vbr_off){if(o.free_format)u.bitrate_index=0;else if(o.brate=t(o.brate,o.version,o.out_samplerate),u.bitrate_index=a(o.brate,o.version,o.out_samplerate),u.bitrate_index<=0)return o.internal_flags=null,-1}else u.bitrate_index=1;o.analysis&&(o.bWriteVbrTag=!1),u.pinfo!=null&&(o.bWriteVbrTag=!1),Q.init_bit_stream_w(u);for(var k0=u.samplerate_index+3*o.version+6*(o.out_samplerate<16e3?1:0),m0=0;m0<A.SBMAX_l+1;m0++)u.scalefac_band.l[m0]=O.sfBandIndex[k0].l[m0];for(var m0=0;m0<A.PSFB21+1;m0++){var X0=(u.scalefac_band.l[22]-u.scalefac_band.l[21])/A.PSFB21,J0=u.scalefac_band.l[21]+m0*X0;u.scalefac_band.psfb21[m0]=J0}u.scalefac_band.psfb21[A.PSFB21]=576;for(var m0=0;m0<A.SBMAX_s+1;m0++)u.scalefac_band.s[m0]=O.sfBandIndex[k0].s[m0];for(var m0=0;m0<A.PSFB12+1;m0++){var X0=(u.scalefac_band.s[13]-u.scalefac_band.s[12])/A.PSFB12,J0=u.scalefac_band.s[12]+m0*X0;u.scalefac_band.psfb12[m0]=J0}u.scalefac_band.psfb12[A.PSFB12]=192,o.version==1?u.sideinfo_len=u.channels_out==1?21:36:u.sideinfo_len=u.channels_out==1?13:21,o.error_protection&&(u.sideinfo_len+=2),M(o),u.Class_ID=d;{var Y0;for(Y0=0;Y0<19;Y0++)u.nsPsy.pefirbuf[Y0]=700*u.mode_gr*u.channels_out;o.ATHtype==-1&&(o.ATHtype=4)}switch(J(o.VBR_q<=9),J(o.VBR_q>=0),o.VBR){case r0.vbr_mt:o.VBR=r0.vbr_mtrh;case r0.vbr_mtrh:{o.useTemporal==null&&(o.useTemporal=!1),D.apply_preset(o,500-o.VBR_q*10,0),o.quality<0&&(o.quality=LAME_DEFAULT_QUALITY),o.quality<5&&(o.quality=0),o.quality>5&&(o.quality=5),u.PSY.mask_adjust=o.maskingadjust,u.PSY.mask_adjust_short=o.maskingadjust_short,o.experimentalY?u.sfb21_extra=!1:u.sfb21_extra=o.out_samplerate>44e3,u.iteration_loop=new VBRNewIterationLoop(l0);break}case r0.vbr_rh:{D.apply_preset(o,500-o.VBR_q*10,0),u.PSY.mask_adjust=o.maskingadjust,u.PSY.mask_adjust_short=o.maskingadjust_short,o.experimentalY?u.sfb21_extra=!1:u.sfb21_extra=o.out_samplerate>44e3,o.quality>6&&(o.quality=6),o.quality<0&&(o.quality=LAME_DEFAULT_QUALITY),u.iteration_loop=new VBROldIterationLoop(l0);break}default:{var Z0;u.sfb21_extra=!1,o.quality<0&&(o.quality=LAME_DEFAULT_QUALITY),Z0=o.VBR,Z0==r0.vbr_off&&(o.VBR_mean_bitrate_kbps=o.brate),D.apply_preset(o,o.VBR_mean_bitrate_kbps,0),o.VBR=Z0,u.PSY.mask_adjust=o.maskingadjust,u.PSY.mask_adjust_short=o.maskingadjust_short,Z0==r0.vbr_off?u.iteration_loop=new a0(l0):u.iteration_loop=new ABRIterationLoop(l0);break}}if(J(o.scale>=0),o.VBR!=r0.vbr_off){if(u.VBR_min_bitrate=1,u.VBR_max_bitrate=14,o.out_samplerate<16e3&&(u.VBR_max_bitrate=8),o.VBR_min_bitrate_kbps!=0&&(o.VBR_min_bitrate_kbps=t(o.VBR_min_bitrate_kbps,o.version,o.out_samplerate),u.VBR_min_bitrate=a(o.VBR_min_bitrate_kbps,o.version,o.out_samplerate),u.VBR_min_bitrate<0)||o.VBR_max_bitrate_kbps!=0&&(o.VBR_max_bitrate_kbps=t(o.VBR_max_bitrate_kbps,o.version,o.out_samplerate),u.VBR_max_bitrate=a(o.VBR_max_bitrate_kbps,o.version,o.out_samplerate),u.VBR_max_bitrate<0))return-1;o.VBR_min_bitrate_kbps=S.bitrate_table[o.version][u.VBR_min_bitrate],o.VBR_max_bitrate_kbps=S.bitrate_table[o.version][u.VBR_max_bitrate],o.VBR_mean_bitrate_kbps=Math.min(S.bitrate_table[o.version][u.VBR_max_bitrate],o.VBR_mean_bitrate_kbps),o.VBR_mean_bitrate_kbps=Math.max(S.bitrate_table[o.version][u.VBR_min_bitrate],o.VBR_mean_bitrate_kbps)}return o.tune&&(u.PSY.mask_adjust+=o.tune_value_a,u.PSY.mask_adjust_short+=o.tune_value_a),b(o),J(o.scale>=0),o.athaa_type<0?u.ATH.useAdjust=3:u.ATH.useAdjust=o.athaa_type,u.ATH.aaSensitivityP=Math.pow(10,o.athaa_sensitivity/-10),o.short_blocks==null&&(o.short_blocks=K.short_block_allowed),o.short_blocks==K.short_block_allowed&&(o.mode==MPEGMode.JOINT_STEREO||o.mode==MPEGMode.STEREO)&&(o.short_blocks=K.short_block_coupled),o.quant_comp<0&&(o.quant_comp=1),o.quant_comp_short<0&&(o.quant_comp_short=0),o.msfix<0&&(o.msfix=0),o.exp_nspsytune=o.exp_nspsytune|1,o.internal_flags.nsPsy.attackthre<0&&(o.internal_flags.nsPsy.attackthre=L.NSATTACKTHRE),o.internal_flags.nsPsy.attackthre_s<0&&(o.internal_flags.nsPsy.attackthre_s=L.NSATTACKTHRE_S),J(o.scale>=0),o.scale<0&&(o.scale=1),o.ATHtype<0&&(o.ATHtype=4),o.ATHcurve<0&&(o.ATHcurve=4),o.athaa_loudapprox<0&&(o.athaa_loudapprox=2),o.interChRatio<0&&(o.interChRatio=0),o.useTemporal==null&&(o.useTemporal=!0),u.slot_lag=u.frac_SpF=0,o.VBR==r0.vbr_off&&(u.slot_lag=u.frac_SpF=(o.version+1)*72e3*o.brate%o.out_samplerate|0),O.iteration_init(o),h0.psymodel_init(o),J(o.scale>=0),0};function f(o,u){(o.in_buffer_0==null||o.in_buffer_nsamples<u)&&(o.in_buffer_0=n0(u),o.in_buffer_1=n0(u),o.in_buffer_nsamples=u)}this.lame_encode_flush=function(o,u,x0,M0){var L0=o.internal_flags,T0=Y([2,1152]),E0=0,A0,D0,k0,m0,X0=L0.mf_samples_to_encode-A.POSTDELAY,J0=F(o);if(L0.mf_samples_to_encode<1)return 0;for(A0=0,o.in_samplerate!=o.out_samplerate&&(X0+=16*o.out_samplerate/o.in_samplerate),k0=o.framesize-X0%o.framesize,k0<576&&(k0+=o.framesize),o.encoder_padding=k0,m0=(X0+k0)/o.framesize;m0>0&&E0>=0;){var Y0=J0-L0.mf_size,Z0=o.frameNum;Y0*=o.in_samplerate,Y0/=o.out_samplerate,Y0>1152&&(Y0=1152),Y0<1&&(Y0=1),D0=M0-A0,M0==0&&(D0=0),E0=this.lame_encode_buffer(o,T0[0],T0[1],Y0,u,x0,D0),x0+=E0,A0+=E0,m0-=Z0!=o.frameNum?1:0}if(L0.mf_samples_to_encode=0,E0<0||(D0=M0-A0,M0==0&&(D0=0),Q.flush_bitstream(o),E0=Q.copy_buffer(L0,u,x0,D0,1),E0<0))return E0;if(x0+=E0,A0+=E0,D0=M0-A0,M0==0&&(D0=0),o.write_id3tag_automatic){if(m.id3tag_write_v1(o),E0=Q.copy_buffer(L0,u,x0,D0,0),E0<0)return E0;A0+=E0}return A0},this.lame_encode_buffer=function(o,u,x0,M0,L0,T0,E0){var A0=o.internal_flags,D0=[null,null];if(A0.Class_ID!=d)return-3;if(M0==0)return 0;f(A0,M0),D0[0]=A0.in_buffer_0,D0[1]=A0.in_buffer_1;for(var k0=0;k0<M0;k0++)D0[0][k0]=u[k0],A0.channels_in>1&&(D0[1][k0]=x0[k0]);return P(o,D0[0],D0[1],M0,L0,T0,E0)};function F(o){var u=A.BLKSIZE+o.framesize-A.FFTOFFSET;return u=Math.max(u,512+o.framesize-32),J(k.MFSIZE>=u),u}function P(o,u,x0,M0,L0,T0,E0){var A0=o.internal_flags,D0=0,k0,m0,X0,J0,Y0,Z0=[null,null],g0=[null,null];if(A0.Class_ID!=d)return-3;if(M0==0)return 0;if(Y0=Q.copy_buffer(A0,L0,T0,E0,0),Y0<0)return Y0;if(T0+=Y0,D0+=Y0,g0[0]=u,g0[1]=x0,e0.NEQ(o.scale,0)&&e0.NEQ(o.scale,1))for(m0=0;m0<M0;++m0)g0[0][m0]*=o.scale,A0.channels_out==2&&(g0[1][m0]*=o.scale);if(e0.NEQ(o.scale_left,0)&&e0.NEQ(o.scale_left,1))for(m0=0;m0<M0;++m0)g0[0][m0]*=o.scale_left;if(e0.NEQ(o.scale_right,0)&&e0.NEQ(o.scale_right,1))for(m0=0;m0<M0;++m0)g0[1][m0]*=o.scale_right;if(o.num_channels==2&&A0.channels_out==1)for(m0=0;m0<M0;++m0)g0[0][m0]=.5*(g0[0][m0]+g0[1][m0]),g0[1][m0]=0;J0=F(o),Z0[0]=A0.mfbuf[0],Z0[1]=A0.mfbuf[1];for(var j0=0;M0>0;){var ee=[null,null],le=0,te=0;ee[0]=g0[0],ee[1]=g0[1];var oe=new c0;if(U0(o,Z0,ee,j0,M0,oe),le=oe.n_in,te=oe.n_out,A0.findReplayGain&&!A0.decode_on_the_fly&&y.AnalyzeSamples(A0.rgdata,Z0[0],A0.mf_size,Z0[1],A0.mf_size,te,A0.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(M0-=le,j0+=le,A0.channels_out==2,A0.mf_size+=te,J(A0.mf_size<=k.MFSIZE),A0.mf_samples_to_encode<1&&(A0.mf_samples_to_encode=A.ENCDELAY+A.POSTDELAY),A0.mf_samples_to_encode+=te,A0.mf_size>=J0){var xe=E0-D0;if(E0==0&&(xe=0),k0=o0(o,Z0[0],Z0[1],L0,T0,xe),k0<0)return k0;for(T0+=k0,D0+=k0,A0.mf_size-=o.framesize,A0.mf_samples_to_encode-=o.framesize,X0=0;X0<A0.channels_out;X0++)for(m0=0;m0<A0.mf_size;m0++)Z0[X0][m0]=Z0[X0][m0+o.framesize]}}return J(M0==0),D0}function o0(o,u,x0,M0,L0,T0){var E0=H.enc.lame_encode_mp3_frame(o,u,x0,M0,L0,T0);return o.frameNum++,E0}function c0(){this.n_in=0,this.n_out=0}function d0(){this.num_used=0}function b0(o,u){return u!=0?b0(u,o%u):o}function S0(o,u,x0){var M0=Math.PI*u;o/=x0,o<0&&(o=0),o>1&&(o=1);var L0=o-.5,T0=.42-.5*Math.cos(2*o*Math.PI)+.08*Math.cos(4*o*Math.PI);return Math.abs(L0)<1e-9?M0/Math.PI:T0*Math.sin(x0*M0*L0)/(Math.PI*x0*L0)}function V0(o,u,x0,M0,L0,T0,E0,A0,D0){var k0=o.internal_flags,m0,X0=0,J0,Y0=o.out_samplerate/b0(o.out_samplerate,o.in_samplerate);Y0>k.BPC&&(Y0=k.BPC);var Z0=Math.abs(k0.resample_ratio-Math.floor(.5+k0.resample_ratio))<1e-4?1:0,g0=1/k0.resample_ratio;g0>1&&(g0=1);var j0=31;j0%2==0&&--j0,j0+=Z0;var ee=j0+1;if(k0.fill_buffer_resample_init==0){for(k0.inbuf_old[0]=n0(ee),k0.inbuf_old[1]=n0(ee),m0=0;m0<=2*Y0;++m0)k0.blackfilt[m0]=n0(ee);for(k0.itime[0]=0,k0.itime[1]=0,X0=0;X0<=2*Y0;X0++){var le=0,te=(X0-Y0)/(2*Y0);for(m0=0;m0<=j0;m0++)le+=k0.blackfilt[X0][m0]=S0(m0-te,g0,j0);for(m0=0;m0<=j0;m0++)k0.blackfilt[X0][m0]/=le}k0.fill_buffer_resample_init=1}var oe=k0.inbuf_old[D0];for(J0=0;J0<M0;J0++){var xe,_e;if(xe=J0*k0.resample_ratio,X0=0|Math.floor(xe-k0.itime[D0]),j0+X0-j0/2>=E0)break;var te=xe-k0.itime[D0]-(X0+.5*(j0%2));J(Math.abs(te)<=.501),_e=0|Math.floor(te*2*Y0+Y0+.5);var Ae=0;for(m0=0;m0<=j0;++m0){var we=0|m0+X0-j0/2,ye;J(we<E0),J(we+ee>=0),ye=we<0?oe[ee+we]:L0[T0+we],Ae+=ye*k0.blackfilt[_e][m0]}u[x0+J0]=Ae}if(A0.num_used=Math.min(E0,j0+X0-j0/2),k0.itime[D0]+=A0.num_used-J0*k0.resample_ratio,A0.num_used>=ee)for(m0=0;m0<ee;m0++)oe[m0]=L0[T0+A0.num_used+m0-ee];else{var g=ee-A0.num_used;for(m0=0;m0<g;++m0)oe[m0]=oe[m0+A0.num_used];for(X0=0;m0<ee;++m0,++X0)oe[m0]=L0[T0+X0];J(X0==A0.num_used)}return J0}function U0(o,u,x0,M0,L0,T0){var E0=o.internal_flags;if(E0.resample_ratio<.9999||E0.resample_ratio>1.0001)for(var A0=0;A0<E0.channels_out;A0++){var D0=new d0;T0.n_out=V0(o,u[A0],E0.mf_size,o.framesize,x0[A0],M0,L0,D0,A0),T0.n_in=D0.num_used}else{T0.n_out=Math.min(o.framesize,L0),T0.n_in=T0.n_out;for(var k0=0;k0<T0.n_out;++k0)u[0][E0.mf_size+k0]=x0[0][M0+k0],E0.channels_out==2&&(u[1][E0.mf_size+k0]=x0[1][M0+k0])}}}return y1=c,y1}var E1,xa;function rt(){if(xa)return E1;xa=1;var _=$0();_.System;var p=_.VbrMode;_.Float,_.ShortBlock,_.Util,_.Arrays,_.new_array_n,_.new_byte,_.new_double,_.new_float,_.new_float_n,_.new_int,_.new_int_n,_.assert;function r0(){function K(I,a0,e0,S,A,c,H,r,V,y,Q,D,O,l0,h0){this.vbr_q=I,this.quant_comp=a0,this.quant_comp_s=e0,this.expY=S,this.st_lrm=A,this.st_s=c,this.masking_adj=H,this.masking_adj_short=r,this.ath_lower=V,this.ath_curve=y,this.ath_sensitivity=Q,this.interch=D,this.safejoint=O,this.sfb21mod=l0,this.msfix=h0}function n0(I,a0,e0,S,A,c,H,r,V,y,Q,D,O,l0){this.quant_comp=a0,this.quant_comp_s=e0,this.safejoint=S,this.nsmsfix=A,this.st_lrm=c,this.st_s=H,this.nsbass=r,this.scale=V,this.masking_adj=y,this.ath_lower=Q,this.ath_curve=D,this.interch=O,this.sfscale=l0}var $;this.setModules=function(I){$=I};var Y=[new K(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new K(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new K(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new K(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new K(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new K(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new K(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new K(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new K(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new K(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new K(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],J=[new K(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new K(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new K(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new K(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new K(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new K(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new K(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new K(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new K(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new K(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new K(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function L(I,a0,e0){var S=I.VBR==p.vbr_rh?Y:J,A=I.VBR_q_frac,c=S[a0],H=S[a0+1],r=c;c.st_lrm=c.st_lrm+A*(H.st_lrm-c.st_lrm),c.st_s=c.st_s+A*(H.st_s-c.st_s),c.masking_adj=c.masking_adj+A*(H.masking_adj-c.masking_adj),c.masking_adj_short=c.masking_adj_short+A*(H.masking_adj_short-c.masking_adj_short),c.ath_lower=c.ath_lower+A*(H.ath_lower-c.ath_lower),c.ath_curve=c.ath_curve+A*(H.ath_curve-c.ath_curve),c.ath_sensitivity=c.ath_sensitivity+A*(H.ath_sensitivity-c.ath_sensitivity),c.interch=c.interch+A*(H.interch-c.interch),c.msfix=c.msfix+A*(H.msfix-c.msfix),E(I,r.vbr_q),e0!=0?I.quant_comp=r.quant_comp:Math.abs(I.quant_comp- -1)>0||(I.quant_comp=r.quant_comp),e0!=0?I.quant_comp_short=r.quant_comp_s:Math.abs(I.quant_comp_short- -1)>0||(I.quant_comp_short=r.quant_comp_s),r.expY!=0&&(I.experimentalY=r.expY!=0),e0!=0?I.internal_flags.nsPsy.attackthre=r.st_lrm:Math.abs(I.internal_flags.nsPsy.attackthre- -1)>0||(I.internal_flags.nsPsy.attackthre=r.st_lrm),e0!=0?I.internal_flags.nsPsy.attackthre_s=r.st_s:Math.abs(I.internal_flags.nsPsy.attackthre_s- -1)>0||(I.internal_flags.nsPsy.attackthre_s=r.st_s),e0!=0?I.maskingadjust=r.masking_adj:Math.abs(I.maskingadjust-0)>0||(I.maskingadjust=r.masking_adj),e0!=0?I.maskingadjust_short=r.masking_adj_short:Math.abs(I.maskingadjust_short-0)>0||(I.maskingadjust_short=r.masking_adj_short),e0!=0?I.ATHlower=-r.ath_lower/10:Math.abs(-I.ATHlower*10-0)>0||(I.ATHlower=-r.ath_lower/10),e0!=0?I.ATHcurve=r.ath_curve:Math.abs(I.ATHcurve- -1)>0||(I.ATHcurve=r.ath_curve),e0!=0?I.athaa_sensitivity=r.ath_sensitivity:Math.abs(I.athaa_sensitivity- -1)>0||(I.athaa_sensitivity=r.ath_sensitivity),r.interch>0&&(e0!=0?I.interChRatio=r.interch:Math.abs(I.interChRatio- -1)>0||(I.interChRatio=r.interch)),r.safejoint>0&&(I.exp_nspsytune=I.exp_nspsytune|r.safejoint),r.sfb21mod>0&&(I.exp_nspsytune=I.exp_nspsytune|r.sfb21mod<<20),e0!=0?I.msfix=r.msfix:Math.abs(I.msfix- -1)>0||(I.msfix=r.msfix),e0==0&&(I.VBR_q=a0,I.VBR_q_frac=A)}var U=[new n0(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new n0(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new n0(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new n0(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new n0(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new n0(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new n0(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new n0(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new n0(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new n0(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new n0(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new n0(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new n0(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new n0(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new n0(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new n0(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new n0(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function k(I,a0,e0){var S=a0,A=$.nearestBitrateFullIndex(a0);if(I.VBR=p.vbr_abr,I.VBR_mean_bitrate_kbps=S,I.VBR_mean_bitrate_kbps=Math.min(I.VBR_mean_bitrate_kbps,320),I.VBR_mean_bitrate_kbps=Math.max(I.VBR_mean_bitrate_kbps,8),I.brate=I.VBR_mean_bitrate_kbps,I.VBR_mean_bitrate_kbps>320&&(I.disable_reservoir=!0),U[A].safejoint>0&&(I.exp_nspsytune=I.exp_nspsytune|2),U[A].sfscale>0&&(I.internal_flags.noise_shaping=2),Math.abs(U[A].nsbass)>0){var c=int(U[A].nsbass*4);c<0&&(c+=64),I.exp_nspsytune=I.exp_nspsytune|c<<2}return e0!=0?I.quant_comp=U[A].quant_comp:Math.abs(I.quant_comp- -1)>0||(I.quant_comp=U[A].quant_comp),e0!=0?I.quant_comp_short=U[A].quant_comp_s:Math.abs(I.quant_comp_short- -1)>0||(I.quant_comp_short=U[A].quant_comp_s),e0!=0?I.msfix=U[A].nsmsfix:Math.abs(I.msfix- -1)>0||(I.msfix=U[A].nsmsfix),e0!=0?I.internal_flags.nsPsy.attackthre=U[A].st_lrm:Math.abs(I.internal_flags.nsPsy.attackthre- -1)>0||(I.internal_flags.nsPsy.attackthre=U[A].st_lrm),e0!=0?I.internal_flags.nsPsy.attackthre_s=U[A].st_s:Math.abs(I.internal_flags.nsPsy.attackthre_s- -1)>0||(I.internal_flags.nsPsy.attackthre_s=U[A].st_s),e0!=0?I.scale=U[A].scale:Math.abs(I.scale- -1)>0||(I.scale=U[A].scale),e0!=0?I.maskingadjust=U[A].masking_adj:Math.abs(I.maskingadjust-0)>0||(I.maskingadjust=U[A].masking_adj),U[A].masking_adj>0?e0!=0?I.maskingadjust_short=U[A].masking_adj*.9:Math.abs(I.maskingadjust_short-0)>0||(I.maskingadjust_short=U[A].masking_adj*.9):e0!=0?I.maskingadjust_short=U[A].masking_adj*1.1:Math.abs(I.maskingadjust_short-0)>0||(I.maskingadjust_short=U[A].masking_adj*1.1),e0!=0?I.ATHlower=-U[A].ath_lower/10:Math.abs(-I.ATHlower*10-0)>0||(I.ATHlower=-U[A].ath_lower/10),e0!=0?I.ATHcurve=U[A].ath_curve:Math.abs(I.ATHcurve- -1)>0||(I.ATHcurve=U[A].ath_curve),e0!=0?I.interChRatio=U[A].interch:Math.abs(I.interChRatio- -1)>0||(I.interChRatio=U[A].interch),a0}this.apply_preset=function(I,a0,e0){switch(a0){case Lame.R3MIX:{a0=Lame.V3,I.VBR=p.vbr_mtrh;break}case Lame.MEDIUM:{a0=Lame.V4,I.VBR=p.vbr_rh;break}case Lame.MEDIUM_FAST:{a0=Lame.V4,I.VBR=p.vbr_mtrh;break}case Lame.STANDARD:{a0=Lame.V2,I.VBR=p.vbr_rh;break}case Lame.STANDARD_FAST:{a0=Lame.V2,I.VBR=p.vbr_mtrh;break}case Lame.EXTREME:{a0=Lame.V0,I.VBR=p.vbr_rh;break}case Lame.EXTREME_FAST:{a0=Lame.V0,I.VBR=p.vbr_mtrh;break}case Lame.INSANE:return a0=320,I.preset=a0,k(I,a0,e0),I.VBR=p.vbr_off,a0}switch(I.preset=a0,a0){case Lame.V9:return L(I,9,e0),a0;case Lame.V8:return L(I,8,e0),a0;case Lame.V7:return L(I,7,e0),a0;case Lame.V6:return L(I,6,e0),a0;case Lame.V5:return L(I,5,e0),a0;case Lame.V4:return L(I,4,e0),a0;case Lame.V3:return L(I,3,e0),a0;case Lame.V2:return L(I,2,e0),a0;case Lame.V1:return L(I,1,e0),a0;case Lame.V0:return L(I,0,e0),a0}return 8<=a0&&a0<=320?k(I,a0,e0):(I.preset=0,a0)};function E(I,a0){var e0=0;return 0>a0&&(e0=-1,a0=0),9<a0&&(e0=-1,a0=9),I.VBR_q=a0,I.VBR_q_frac=0,e0}}return E1=r0,E1}var B1,wa;function st(){if(wa)return B1;wa=1;function _(){this.setModules=function(p,r0){}}return B1=_,B1}var T1,Ma;function nt(){if(Ma)return T1;Ma=1;function _(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}return T1=_,T1}var I1,Sa;function it(){if(Sa)return I1;Sa=1;var _=$0(),p=_.new_float,r0=_.new_int;_.assert;function K(){this.global_gain=0,this.sfb_count1=0,this.step=r0(39),this.noise=p(39),this.noise_log=p(39)}return I1=K,I1}var k1,pa;function lt(){if(pa)return k1;pa=1;var _=$0(),p=_.System,r0=_.VbrMode;_.Float,_.ShortBlock;var K=_.Util,n0=_.Arrays;_.new_array_n,_.new_byte,_.new_double;var $=_.new_float;_.new_float_n,_.new_int,_.new_int_n;var Y=_.assert,J=st(),L=nt(),U=it(),k=ie(),E=N1(),I=Xe();function a0(){var e0;this.rv=null;var S;this.qupvt=null;var A,c=new J,H;this.setModules=function(R,l,d,B){e0=R,S=l,this.rv=l,A=d,this.qupvt=d,H=B,c.setModules(A,H)},this.ms_convert=function(R,l){for(var d=0;d<576;++d){var B=R.tt[l][0].xr[d],C=R.tt[l][1].xr[d];R.tt[l][0].xr[d]=(B+C)*(K.SQRT2*.5),R.tt[l][1].xr[d]=(B-C)*(K.SQRT2*.5)}};function r(R,l,d,B){B=0;for(var C=0;C<=d;++C){var h=Math.abs(R.xr[C]);B+=h,l[C]=Math.sqrt(h*Math.sqrt(h)),l[C]>R.xrpow_max&&(R.xrpow_max=l[C])}return B}this.init_xrpow=function(R,l,d){var B=0,C=0|l.max_nonzero_coeff;if(Y(d!=null),l.xrpow_max=0,Y(0<=C&&C<=575),n0.fill(d,C,576,0),B=r(l,d,C,B),B>1e-20){var h=0;(R.substep_shaping&2)!=0&&(h=1);for(var e=0;e<l.psymax;e++)R.pseudohalf[e]=h;return!0}return n0.fill(l.l3_enc,0,576,0),!1};function V(R,l){var d=R.ATH,B=l.xr;if(l.block_type!=k.SHORT_TYPE)for(var C=!1,h=k.PSFB21-1;h>=0&&!C;h--){var e=R.scalefac_band.psfb21[h],t=R.scalefac_band.psfb21[h+1],a=A.athAdjust(d.adjust,d.psfb21[h],d.floor);R.nsPsy.longfact[21]>1e-12&&(a*=R.nsPsy.longfact[21]);for(var n=t-1;n>=e;n--)if(Math.abs(B[n])<a)B[n]=0;else{C=!0;break}}else for(var v=0;v<3;v++)for(var C=!1,h=k.PSFB12-1;h>=0&&!C;h--){var e=R.scalefac_band.s[12]*3+(R.scalefac_band.s[13]-R.scalefac_band.s[12])*v+(R.scalefac_band.psfb12[h]-R.scalefac_band.psfb12[0]),t=e+(R.scalefac_band.psfb12[h+1]-R.scalefac_band.psfb12[h]),b=A.athAdjust(d.adjust,d.psfb12[h],d.floor);R.nsPsy.shortfact[12]>1e-12&&(b*=R.nsPsy.shortfact[12]);for(var n=t-1;n>=e;n--)if(Math.abs(B[n])<b)B[n]=0;else{C=!0;break}}}this.init_outer_loop=function(R,l){l.part2_3_length=0,l.big_values=0,l.count1=0,l.global_gain=210,l.scalefac_compress=0,l.table_select[0]=0,l.table_select[1]=0,l.table_select[2]=0,l.subblock_gain[0]=0,l.subblock_gain[1]=0,l.subblock_gain[2]=0,l.subblock_gain[3]=0,l.region0_count=0,l.region1_count=0,l.preflag=0,l.scalefac_scale=0,l.count1table_select=0,l.part2_length=0,l.sfb_lmax=k.SBPSY_l,l.sfb_smin=k.SBPSY_s,l.psy_lmax=R.sfb21_extra?k.SBMAX_l:k.SBPSY_l,l.psymax=l.psy_lmax,l.sfbmax=l.sfb_lmax,l.sfbdivide=11;for(var d=0;d<k.SBMAX_l;d++)l.width[d]=R.scalefac_band.l[d+1]-R.scalefac_band.l[d],l.window[d]=3;if(l.block_type==k.SHORT_TYPE){var B=$(576);l.sfb_smin=0,l.sfb_lmax=0,l.mixed_block_flag!=0&&(l.sfb_smin=3,l.sfb_lmax=R.mode_gr*2+4),l.psymax=l.sfb_lmax+3*((R.sfb21_extra?k.SBMAX_s:k.SBPSY_s)-l.sfb_smin),l.sfbmax=l.sfb_lmax+3*(k.SBPSY_s-l.sfb_smin),l.sfbdivide=l.sfbmax-18,l.psy_lmax=l.sfb_lmax;var C=R.scalefac_band.l[l.sfb_lmax];p.arraycopy(l.xr,0,B,0,576);for(var d=l.sfb_smin;d<k.SBMAX_s;d++)for(var h=R.scalefac_band.s[d],e=R.scalefac_band.s[d+1],t=0;t<3;t++)for(var a=h;a<e;a++)l.xr[C++]=B[3*a+t];for(var n=l.sfb_lmax,d=l.sfb_smin;d<k.SBMAX_s;d++)l.width[n]=l.width[n+1]=l.width[n+2]=R.scalefac_band.s[d+1]-R.scalefac_band.s[d],l.window[n]=0,l.window[n+1]=1,l.window[n+2]=2,n+=3}l.count1bits=0,l.sfb_partition_table=A.nr_of_sfb_block[0][0],l.slen[0]=0,l.slen[1]=0,l.slen[2]=0,l.slen[3]=0,l.max_nonzero_coeff=575,n0.fill(l.scalefac,0),V(R,l)};function y(R){this.ordinal=R}y.BINSEARCH_NONE=new y(0),y.BINSEARCH_UP=new y(1),y.BINSEARCH_DOWN=new y(2);function Q(R,l,d,B,C){var h,e=R.CurrentStep[B],t=!1,a=R.OldValue[B],n=y.BINSEARCH_NONE;for(l.global_gain=a,d-=l.part2_length,Y(e!=0);;){var v;if(h=H.count_bits(R,C,l,null),e==1||h==d)break;h>d?(n==y.BINSEARCH_DOWN&&(t=!0),t&&(e/=2),n=y.BINSEARCH_UP,v=e):(n==y.BINSEARCH_UP&&(t=!0),t&&(e/=2),n=y.BINSEARCH_DOWN,v=-e),l.global_gain+=v,l.global_gain<0&&(l.global_gain=0,t=!0),l.global_gain>255&&(l.global_gain=255,t=!0)}for(Y(l.global_gain>=0),Y(l.global_gain<256);h>d&&l.global_gain<255;)l.global_gain++,h=H.count_bits(R,C,l,null);return R.CurrentStep[B]=a-l.global_gain>=4?4:2,R.OldValue[B]=l.global_gain,l.part2_3_length=h,h}this.trancate_smallspectrums=function(R,l,d,B){var C=$(I.SFBMAX);if(!((R.substep_shaping&4)==0&&l.block_type==k.SHORT_TYPE||(R.substep_shaping&128)!=0)){A.calc_noise(l,d,C,new L,null);for(var e=0;e<576;e++){var h=0;l.l3_enc[e]!=0&&(h=Math.abs(l.xr[e])),B[e]=h}var e=0,t=8;l.block_type==k.SHORT_TYPE&&(t=6);do{var a,n,v,b,M=l.width[t];if(e+=M,!(C[t]>=1)&&(n0.sort(B,e-M,M),!BitStream.EQ(B[e-1],0))){a=(1-C[t])*d[t],n=0,b=0;do{var f;for(v=1;b+v<M&&!BitStream.NEQ(B[b+e-M],B[b+e+v-M]);v++);if(f=B[b+e-M]*B[b+e-M]*v,a<f){b!=0&&(n=B[b+e-M-1]);break}a-=f,b+=v}while(b<M);if(!BitStream.EQ(n,0))do Math.abs(l.xr[e-M])<=n&&(l.l3_enc[e-M]=0);while(--M>0)}}while(++t<l.psymax);l.part2_3_length=H.noquant_count_bits(R,l,null)}};function D(R){for(var l=0;l<R.sfbmax;l++)if(R.scalefac[l]+R.subblock_gain[R.window[l]]==0)return!1;return!0}function O(R){return K.FAST_LOG10(.368+.632*R*R*R)}function l0(R,l){for(var d=1e-37,B=0;B<l.psymax;B++)d+=O(R[B]);return Math.max(1e-20,d)}function h0(R,l,d,B,C){var h;switch(R){default:case 9:{l.over_count>0?(h=d.over_SSD<=l.over_SSD,d.over_SSD==l.over_SSD&&(h=d.bits<l.bits)):h=d.max_noise<0&&d.max_noise*10+d.bits<=l.max_noise*10+l.bits;break}case 0:h=d.over_count<l.over_count||d.over_count==l.over_count&&d.over_noise<l.over_noise||d.over_count==l.over_count&&BitStream.EQ(d.over_noise,l.over_noise)&&d.tot_noise<l.tot_noise;break;case 8:d.max_noise=l0(C,B);case 1:h=d.max_noise<l.max_noise;break;case 2:h=d.tot_noise<l.tot_noise;break;case 3:h=d.tot_noise<l.tot_noise&&d.max_noise<l.max_noise;break;case 4:h=d.max_noise<=0&&l.max_noise>.2||d.max_noise<=0&&l.max_noise<0&&l.max_noise>d.max_noise-.2&&d.tot_noise<l.tot_noise||d.max_noise<=0&&l.max_noise>0&&l.max_noise>d.max_noise-.2&&d.tot_noise<l.tot_noise+l.over_noise||d.max_noise>0&&l.max_noise>-.05&&l.max_noise>d.max_noise-.1&&d.tot_noise+d.over_noise<l.tot_noise+l.over_noise||d.max_noise>0&&l.max_noise>-.1&&l.max_noise>d.max_noise-.15&&d.tot_noise+d.over_noise+d.over_noise<l.tot_noise+l.over_noise+l.over_noise;break;case 5:h=d.over_noise<l.over_noise||BitStream.EQ(d.over_noise,l.over_noise)&&d.tot_noise<l.tot_noise;break;case 6:h=d.over_noise<l.over_noise||BitStream.EQ(d.over_noise,l.over_noise)&&(d.max_noise<l.max_noise||BitStream.EQ(d.max_noise,l.max_noise)&&d.tot_noise<=l.tot_noise);break;case 7:h=d.over_count<l.over_count||d.over_noise<l.over_noise;break}return l.over_count==0&&(h=h&&d.bits<l.bits),h}function W(R,l,d,B,C){var h=R.internal_flags,e;l.scalefac_scale==0?e=1.2968395546510096:e=1.6817928305074292;for(var t=0,a=0;a<l.sfbmax;a++)t<d[a]&&(t=d[a]);var n=h.noise_shaping_amp;switch(n==3&&(C?n=2:n=1),n){case 2:break;case 1:t>1?t=Math.pow(t,.5):t*=.95;break;default:t>1?t=1:t*=.95;break}for(var v=0,a=0;a<l.sfbmax;a++){var b=l.width[a],M;if(v+=b,!(d[a]<t)){if((h.substep_shaping&2)!=0&&(h.pseudohalf[a]=h.pseudohalf[a]==0?1:0,h.pseudohalf[a]==0&&h.noise_shaping_amp==2))return;for(l.scalefac[a]++,M=-b;M<0;M++)B[v+M]*=e,B[v+M]>l.xrpow_max&&(l.xrpow_max=B[v+M]);if(h.noise_shaping_amp==2)return}}}function m(R,l){for(var d=1.2968395546510096,B=0,C=0;C<R.sfbmax;C++){var h=R.width[C],e=R.scalefac[C];if(R.preflag!=0&&(e+=A.pretab[C]),B+=h,(e&1)!=0){e++;for(var t=-h;t<0;t++)l[B+t]*=d,l[B+t]>R.xrpow_max&&(R.xrpow_max=l[B+t])}R.scalefac[C]=e>>1}R.preflag=0,R.scalefac_scale=1}function y0(R,l,d){var B,C=l.scalefac;for(B=0;B<l.sfb_lmax;B++)if(C[B]>=16)return!0;for(var h=0;h<3;h++){var e=0,t=0;for(B=l.sfb_lmax+h;B<l.sfbdivide;B+=3)e<C[B]&&(e=C[B]);for(;B<l.sfbmax;B+=3)t<C[B]&&(t=C[B]);if(!(e<16&&t<8)){if(l.subblock_gain[h]>=7)return!0;l.subblock_gain[h]++;var a=R.scalefac_band.l[l.sfb_lmax];for(B=l.sfb_lmax+h;B<l.sfbmax;B+=3){var n,v=l.width[B],b=C[B];if(Y(b>=0),b=b-(4>>l.scalefac_scale),b>=0){C[B]=b,a+=v*3;continue}C[B]=0;{var M=210+(b<<l.scalefac_scale+1);n=A.IPOW20(M)}a+=v*(h+1);for(var f=-v;f<0;f++)d[a+f]*=n,d[a+f]>l.xrpow_max&&(l.xrpow_max=d[a+f]);a+=v*(3-h-1)}{var n=A.IPOW20(202);a+=l.width[B]*(h+1);for(var f=-l.width[B];f<0;f++)d[a+f]*=n,d[a+f]>l.xrpow_max&&(l.xrpow_max=d[a+f])}}}return!1}function N(R,l,d,B,C){var h=R.internal_flags;W(R,l,d,B,C);var e=D(l);return e?!1:(h.mode_gr==2?e=H.scale_bitcount(l):e=H.scale_bitcount_lsf(h,l),e?(h.noise_shaping>1&&(n0.fill(h.pseudohalf,0),l.scalefac_scale==0?(m(l,B),e=!1):l.block_type==k.SHORT_TYPE&&h.subblock_gain>0&&(e=y0(h,l,B)||D(l))),e||(h.mode_gr==2?e=H.scale_bitcount(l):e=H.scale_bitcount_lsf(h,l)),!e):!0)}this.outer_loop=function(R,l,d,B,C,h){var e=R.internal_flags,t=new E,a=$(576),n=$(I.SFBMAX),v=new L,b,M=new U,f=9999999,F=!1,P=!1,o0=0;if(Q(e,l,h,C,B),e.noise_shaping==0)return 100;A.calc_noise(l,d,n,v,M),v.bits=l.part2_3_length,t.assign(l);var c0=0;for(p.arraycopy(B,0,a,0,576);!F;){do{var d0=new L,b0,S0=255;if((e.substep_shaping&2)!=0?b0=20:b0=3,e.sfb21_extra&&(n[t.sfbmax]>1||t.block_type==k.SHORT_TYPE&&(n[t.sfbmax+1]>1||n[t.sfbmax+2]>1))||!N(R,t,n,B,P))break;t.scalefac_scale!=0&&(S0=254);var V0=h-t.part2_length;if(V0<=0)break;for(;(t.part2_3_length=H.count_bits(e,B,t,M))>V0&&t.global_gain<=S0;)t.global_gain++;if(t.global_gain>S0)break;if(v.over_count==0){for(;(t.part2_3_length=H.count_bits(e,B,t,M))>f&&t.global_gain<=S0;)t.global_gain++;if(t.global_gain>S0)break}if(A.calc_noise(t,d,n,d0,M),d0.bits=t.part2_3_length,l.block_type!=k.SHORT_TYPE?b=R.quant_comp:b=R.quant_comp_short,b=h0(b,v,d0,t,n)?1:0,b!=0)f=l.part2_3_length,v=d0,l.assign(t),c0=0,p.arraycopy(B,0,a,0,576);else if(e.full_outer_loop==0&&(++c0>b0&&v.over_count==0||e.noise_shaping_amp==3&&P&&c0>30||e.noise_shaping_amp==3&&P&&t.global_gain-o0>15))break}while(t.global_gain+t.scalefac_scale<255);e.noise_shaping_amp==3?P?F=!0:(t.assign(l),p.arraycopy(a,0,B,0,576),c0=0,o0=t.global_gain,P=!0):F=!0}return Y(l.global_gain+l.scalefac_scale<=255),R.VBR==r0.vbr_rh||R.VBR==r0.vbr_mtrh?p.arraycopy(a,0,B,0,576):(e.substep_shaping&1)!=0&&trancate_smallspectrums(e,l,d,B),v.over_count},this.iteration_finish_one=function(R,l,d){var B=R.l3_side,C=B.tt[l][d];H.best_scalefac_store(R,l,d,B),R.use_best_huffman==1&&H.best_huffman_divide(R,C),S.ResvAdjust(R,C)},this.VBR_encode_granule=function(R,l,d,B,C,h,e){var t=R.internal_flags,a=new E,n=$(576),v=e,b=e+1,M=(e+h)/2,f,F,P=0,o0=t.sfb21_extra;Y(v<=LameInternalFlags.MAX_BITS_PER_CHANNEL),n0.fill(a.l3_enc,0);do Y(M>=h),Y(M<=e),Y(h<=e),M>v-42?t.sfb21_extra=!1:t.sfb21_extra=o0,F=outer_loop(R,l,d,B,C,M),F<=0?(P=1,b=l.part2_3_length,a.assign(l),p.arraycopy(B,0,n,0,576),e=b-32,f=e-h,M=(e+h)/2):(h=M+32,f=e-h,M=(e+h)/2,P!=0&&(P=2,l.assign(a),p.arraycopy(n,0,B,0,576)));while(f>12);t.sfb21_extra=o0,P==2&&p.arraycopy(a.l3_enc,0,l.l3_enc,0,576),Y(l.part2_3_length<=v)},this.get_framebits=function(R,l){var d=R.internal_flags;d.bitrate_index=d.VBR_min_bitrate;var B=e0.getframebits(R);d.bitrate_index=1,B=e0.getframebits(R);for(var C=1;C<=d.VBR_max_bitrate;C++){d.bitrate_index=C;var h=new MeanBits(B);l[C]=S.ResvFrameBegin(R,h),B=h.bits}},this.VBR_old_prepare=function(R,l,d,B,C,h,e,t,a){var n=R.internal_flags,v,b=0,M=1,f=0;n.bitrate_index=n.VBR_max_bitrate;var F=S.ResvFrameBegin(R,new MeanBits(0))/n.mode_gr;get_framebits(R,h);for(var P=0;P<n.mode_gr;P++){var o0=A.on_pe(R,l,t[P],F,P,0);n.mode_ext==k.MPG_MD_MS_LR&&(ms_convert(n.l3_side,P),A.reduce_side(t[P],d[P],F,o0));for(var c0=0;c0<n.channels_out;++c0){var d0=n.l3_side.tt[P][c0];d0.block_type!=k.SHORT_TYPE?(b=1.28/(1+Math.exp(3.5-l[P][c0]/300))-.05,v=n.PSY.mask_adjust-b):(b=2.56/(1+Math.exp(3.5-l[P][c0]/300))-.14,v=n.PSY.mask_adjust_short-b),n.masking_lower=Math.pow(10,v*.1),init_outer_loop(n,d0),a[P][c0]=A.calc_xmin(R,B[P][c0],d0,C[P][c0]),a[P][c0]!=0&&(M=0),e[P][c0]=126,f+=t[P][c0]}}for(var P=0;P<n.mode_gr;P++)for(var c0=0;c0<n.channels_out;c0++)f>h[n.VBR_max_bitrate]&&(t[P][c0]*=h[n.VBR_max_bitrate],t[P][c0]/=f),e[P][c0]>t[P][c0]&&(e[P][c0]=t[P][c0]);return M},this.bitpressure_strategy=function(R,l,d,B){for(var C=0;C<R.mode_gr;C++)for(var h=0;h<R.channels_out;h++){for(var e=R.l3_side.tt[C][h],t=l[C][h],a=0,n=0;n<e.psy_lmax;n++)t[a++]*=1+.029*n*n/k.SBMAX_l/k.SBMAX_l;if(e.block_type==k.SHORT_TYPE)for(var n=e.sfb_smin;n<k.SBMAX_s;n++)t[a++]*=1+.029*n*n/k.SBMAX_s/k.SBMAX_s,t[a++]*=1+.029*n*n/k.SBMAX_s/k.SBMAX_s,t[a++]*=1+.029*n*n/k.SBMAX_s/k.SBMAX_s;B[C][h]=0|Math.max(d[C][h],.9*B[C][h])}},this.VBR_new_prepare=function(R,l,d,B,C,h){var e=R.internal_flags,t=1,a=0,n=0,v;if(R.free_format){e.bitrate_index=0;var b=new MeanBits(a);v=S.ResvFrameBegin(R,b),a=b.bits,C[0]=v}else{e.bitrate_index=e.VBR_max_bitrate;var b=new MeanBits(a);S.ResvFrameBegin(R,b),a=b.bits,get_framebits(R,C),v=C[e.VBR_max_bitrate]}for(var M=0;M<e.mode_gr;M++){A.on_pe(R,l,h[M],a,M,0),e.mode_ext==k.MPG_MD_MS_LR&&ms_convert(e.l3_side,M);for(var f=0;f<e.channels_out;++f){var F=e.l3_side.tt[M][f];e.masking_lower=Math.pow(10,e.PSY.mask_adjust*.1),init_outer_loop(e,F),A.calc_xmin(R,d[M][f],F,B[M][f])!=0&&(t=0),n+=h[M][f]}}for(var M=0;M<e.mode_gr;M++)for(var f=0;f<e.channels_out;f++)n>v&&(h[M][f]*=v,h[M][f]/=n);return t},this.calc_target_bits=function(R,l,d,B,C,h){var e=R.internal_flags,t=e.l3_side,a,n,v,b,M=0;e.bitrate_index=e.VBR_max_bitrate;var f=new MeanBits(M);for(h[0]=S.ResvFrameBegin(R,f),M=f.bits,e.bitrate_index=1,M=e0.getframebits(R)-e.sideinfo_len*8,C[0]=M/(e.mode_gr*e.channels_out),M=R.VBR_mean_bitrate_kbps*R.framesize*1e3,(e.substep_shaping&1)!=0&&(M*=1.09),M/=R.out_samplerate,M-=e.sideinfo_len*8,M/=e.mode_gr*e.channels_out,a=.93+.07*(11-R.compression_ratio)/(11-5.5),a<.9&&(a=.9),a>1&&(a=1),n=0;n<e.mode_gr;n++){var F=0;for(v=0;v<e.channels_out;v++){if(B[n][v]=int(a*M),l[n][v]>700){var P=int((l[n][v]-700)/1.4),o0=t.tt[n][v];B[n][v]=int(a*M),o0.block_type==k.SHORT_TYPE&&P<M/2&&(P=M/2),P>M*3/2?P=M*3/2:P<0&&(P=0),B[n][v]+=P}B[n][v]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(B[n][v]=LameInternalFlags.MAX_BITS_PER_CHANNEL),F+=B[n][v]}if(F>LameInternalFlags.MAX_BITS_PER_GRANULE)for(v=0;v<e.channels_out;++v)B[n][v]*=LameInternalFlags.MAX_BITS_PER_GRANULE,B[n][v]/=F}if(e.mode_ext==k.MPG_MD_MS_LR)for(n=0;n<e.mode_gr;n++)A.reduce_side(B[n],d[n],M*e.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(b=0,n=0;n<e.mode_gr;n++)for(v=0;v<e.channels_out;v++)B[n][v]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(B[n][v]=LameInternalFlags.MAX_BITS_PER_CHANNEL),b+=B[n][v];if(b>h[0])for(n=0;n<e.mode_gr;n++)for(v=0;v<e.channels_out;v++)B[n][v]*=h[0],B[n][v]/=b}}return k1=a0,k1}var C1,Ra;function ot(){if(Ra)return C1;Ra=1;var _=$0(),p=_.assert;function r0(){var K;this.setModules=function(n0){K=n0},this.ResvFrameBegin=function(n0,$){var Y=n0.internal_flags,J,L=Y.l3_side,U=K.getframebits(n0);$.bits=(U-Y.sideinfo_len*8)/Y.mode_gr;var k=8*256*Y.mode_gr-8;n0.brate>320?J=8*int(n0.brate*1e3/(n0.out_samplerate/1152)/8+.5):(J=8*1440,n0.strict_ISO&&(J=8*int(32e4/(n0.out_samplerate/1152)/8+.5))),Y.ResvMax=J-U,Y.ResvMax>k&&(Y.ResvMax=k),(Y.ResvMax<0||n0.disable_reservoir)&&(Y.ResvMax=0);var E=$.bits*Y.mode_gr+Math.min(Y.ResvSize,Y.ResvMax);return E>J&&(E=J),p(Y.ResvMax%8==0),p(Y.ResvMax>=0),L.resvDrain_pre=0,Y.pinfo!=null&&(Y.pinfo.mean_bits=$.bits/2,Y.pinfo.resvsize=Y.ResvSize),E},this.ResvMaxBits=function(n0,$,Y,J){var L=n0.internal_flags,U,k=L.ResvSize,E=L.ResvMax;J!=0&&(k+=$),(L.substep_shaping&1)!=0&&(E*=.9),Y.bits=$,k*10>E*9?(U=k-E*9/10,Y.bits+=U,L.substep_shaping|=128):(U=0,L.substep_shaping&=127,!n0.disable_reservoir&&(L.substep_shaping&1)==0&&(Y.bits-=.1*$));var I=k<L.ResvMax*6/10?k:L.ResvMax*6/10;return I-=U,I<0&&(I=0),I},this.ResvAdjust=function(n0,$){n0.ResvSize-=$.part2_3_length+$.part2_length},this.ResvFrameEnd=function(n0,$){var Y,J=n0.l3_side;n0.ResvSize+=$*n0.mode_gr;var L=0;J.resvDrain_post=0,J.resvDrain_pre=0,(Y=n0.ResvSize%8)!=0&&(L+=Y),Y=n0.ResvSize-L-n0.ResvMax,Y>0&&(p(Y%8==0),p(Y>=0),L+=Y);{var U=Math.min(J.main_data_begin*8,L)/8;J.resvDrain_pre+=8*U,L-=8*U,n0.ResvSize-=8*U,J.main_data_begin-=U}J.resvDrain_post+=L,n0.ResvSize-=L}}return C1=r0,C1}var L1,Aa;function _t(){if(Aa)return L1;Aa=1;function _(){var p="http://www.mp3dev.org/",r0=3,K=98,n0=4,$=0,Y=93;this.getLameVersion=function(){return r0+"."+K+"."+n0},this.getLameShortVersion=function(){return r0+"."+K+"."+n0},this.getLameVeryShortVersion=function(){return"LAME"+r0+"."+K+"r"},this.getPsyVersion=function(){return $+"."+Y},this.getLameUrl=function(){return p},this.getLameOsBitness=function(){return"32bits"}}return L1=_,L1}var V1,ya;function vt(){if(ya)return V1;ya=1;var _=$0(),p=_.System,r0=_.VbrMode;_.Float;var K=_.ShortBlock;_.Util;var n0=_.Arrays;_.new_array_n;var $=_.new_byte;_.new_double,_.new_float,_.new_float_n,_.new_int,_.new_int_n;var Y=_.assert;J.NUMTOCENTRIES=100,J.MAXFRAMESIZE=2880;function J(){var L,U,k;this.setModules=function(e,t,a){L=e,U=t,k=a};var E=1,I=2,a0=4,e0=8,S=J.NUMTOCENTRIES,A=J.MAXFRAMESIZE,c=S+4+4+4+4+4,H=c+9+1+1+8+1+1+3+1+1+2+4+2+2,r=128,V=64,y=32,Q=null,D="Xing",O="Info",l0=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function h0(e,t){if(e.nVbrNumFrames++,e.sum+=t,e.seen++,!(e.seen<e.want)&&(e.pos<e.size&&(e.bag[e.pos]=e.sum,e.pos++,e.seen=0),e.pos==e.size)){for(var a=1;a<e.size;a+=2)e.bag[a/2]=e.bag[a];e.want*=2,e.pos/=2}}function W(e,t){if(!(e.pos<=0))for(var a=1;a<S;++a){var n=a/S,v,b,M=0|Math.floor(n*e.pos);M>e.pos-1&&(M=e.pos-1),v=e.bag[M],b=e.sum;var f=0|256*v/b;f>255&&(f=255),t[a]=255&f}}this.addVbrFrame=function(e){var t=e.internal_flags,a=Tables.bitrate_table[e.version][t.bitrate_index];Y(t.VBR_seek_table.bag!=null),h0(t.VBR_seek_table,a)};function m(e,t){var a=e[t+0]&255;return a<<=8,a|=e[t+1]&255,a<<=8,a|=e[t+2]&255,a<<=8,a|=e[t+3]&255,a}function y0(e,t,a){e[t+0]=255&(a>>24&255),e[t+1]=255&(a>>16&255),e[t+2]=255&(a>>8&255),e[t+3]=255&(a&255)}function N(e,t,a){e[t+0]=255&(a>>8&255),e[t+1]=255&(a&255)}function R(e,t){return new String(e,t,D.length(),Q).equals(D)||new String(e,t,O.length(),Q).equals(O)}function l(e,t,a){return 255&(e<<t|a&~(-1<<t))}function d(e,t){var a=e.internal_flags;t[0]=l(t[0],8,255),t[1]=l(t[1],3,7),t[1]=l(t[1],1,e.out_samplerate<16e3?0:1),t[1]=l(t[1],1,e.version),t[1]=l(t[1],2,1),t[1]=l(t[1],1,e.error_protection?0:1),t[2]=l(t[2],4,a.bitrate_index),t[2]=l(t[2],2,a.samplerate_index),t[2]=l(t[2],1,0),t[2]=l(t[2],1,e.extension),t[3]=l(t[3],2,e.mode.ordinal()),t[3]=l(t[3],2,a.mode_ext),t[3]=l(t[3],1,e.copyright),t[3]=l(t[3],1,e.original),t[3]=l(t[3],2,e.emphasis),t[0]=255;var n=255&(t[1]&241),v;e.version==1?v=r:e.out_samplerate<16e3?v=y:v=V,e.VBR==r0.vbr_off&&(v=e.brate);var b;e.free_format?b=0:b=255&16*L.BitrateIndex(v,e.version,e.out_samplerate),e.version==1?(t[1]=255&(n|10),n=255&(t[2]&13),t[2]=255&(b|n)):(t[1]=255&(n|2),n=255&(t[2]&13),t[2]=255&(b|n))}this.getVbrTag=function(e){var t=new VBRTagData,a=0;t.flags=0;var n=e[a+1]>>3&1,v=e[a+2]>>2&3,b=e[a+3]>>6&3,M=e[a+2]>>4&15;if(M=Tables.bitrate_table[n][M],e[a+1]>>4==14?t.samprate=Tables.samplerate_table[2][v]:t.samprate=Tables.samplerate_table[n][v],n!=0?b!=3?a+=36:a+=21:b!=3?a+=21:a+=13,!R(e,a))return null;a+=4,t.hId=n;var f=t.flags=m(e,a);if(a+=4,(f&E)!=0&&(t.frames=m(e,a),a+=4),(f&I)!=0&&(t.bytes=m(e,a),a+=4),(f&a0)!=0){if(t.toc!=null)for(var F=0;F<S;F++)t.toc[F]=e[a+F];a+=S}t.vbrScale=-1,(f&e0)!=0&&(t.vbrScale=m(e,a),a+=4),t.headersize=(n+1)*72e3*M/t.samprate,a+=21;var P=e[a+0]<<4;P+=e[a+1]>>4;var o0=(e[a+1]&15)<<8;return o0+=e[a+2]&255,(P<0||P>3e3)&&(P=-1),(o0<0||o0>3e3)&&(o0=-1),t.encDelay=P,t.encPadding=o0,t},this.InitVbrTag=function(e){var t=e.internal_flags,a;e.version==1?a=r:e.out_samplerate<16e3?a=y:a=V,e.VBR==r0.vbr_off&&(a=e.brate);var n=(e.version+1)*72e3*a/e.out_samplerate,v=t.sideinfo_len+H;if(t.VBR_seek_table.TotalFrameSize=n,n<v||n>A){e.bWriteVbrTag=!1;return}t.VBR_seek_table.nVbrNumFrames=0,t.VBR_seek_table.nBytesWritten=0,t.VBR_seek_table.sum=0,t.VBR_seek_table.seen=0,t.VBR_seek_table.want=1,t.VBR_seek_table.pos=0,t.VBR_seek_table.bag==null&&(t.VBR_seek_table.bag=new int[400],t.VBR_seek_table.size=400);var b=$(A);d(e,b);for(var M=t.VBR_seek_table.TotalFrameSize,f=0;f<M;++f)U.add_dummy_byte(e,b[f]&255,1)};function B(e,t){var a=t^e;return t=t>>8^l0[a&255],t}this.updateMusicCRC=function(e,t,a,n){for(var v=0;v<n;++v)e[0]=B(t[a+v],e[0])};function C(e,t,a,n,v){var b=e.internal_flags,M=0,f=e.encoder_delay,F=e.encoder_padding,P=100-10*e.VBR_q-e.quality,o0=k.getLameVeryShortVersion(),c0,d0=0,b0,S0=[1,5,3,2,4,0,3],V0=0|(e.lowpassfreq/100+.5>255?255:e.lowpassfreq/100+.5),U0=0,o=0,u=0,x0=e.internal_flags.noise_shaping,M0=0,L0=0,T0=0,E0=0,A0=0,D0=(e.exp_nspsytune&1)!=0,k0=(e.exp_nspsytune&2)!=0,m0=!1,X0=!1,J0=e.internal_flags.nogap_total,Y0=e.internal_flags.nogap_current,Z0=e.ATHtype,g0=0,j0;switch(e.VBR){case vbr_abr:j0=e.VBR_mean_bitrate_kbps;break;case vbr_off:j0=e.brate;break;default:j0=e.VBR_min_bitrate_kbps}switch(e.VBR.ordinal()<S0.length?c0=S0[e.VBR.ordinal()]:c0=0,b0=16*d0+c0,b.findReplayGain&&(b.RadioGain>510&&(b.RadioGain=510),b.RadioGain<-510&&(b.RadioGain=-510),o=8192,o|=3072,b.RadioGain>=0?o|=b.RadioGain:(o|=512,o|=-b.RadioGain)),b.findPeakSample&&(U0=Math.abs(0|b.PeakSample/32767*Math.pow(2,23)+.5)),J0!=-1&&(Y0>0&&(X0=!0),Y0<J0-1&&(m0=!0)),g0=Z0+((D0?1:0)<<4)+((k0?1:0)<<5)+((m0?1:0)<<6)+((X0?1:0)<<7),P<0&&(P=0),e.mode){case MONO:M0=0;break;case STEREO:M0=1;break;case DUAL_CHANNEL:M0=2;break;case JOINT_STEREO:e.force_ms?M0=4:M0=3;break;case NOT_SET:default:M0=7;break}e.in_samplerate<=32e3?T0=0:e.in_samplerate==48e3?T0=2:e.in_samplerate>48e3?T0=3:T0=1,(e.short_blocks==K.short_block_forced||e.short_blocks==K.short_block_dispensed||e.lowpassfreq==-1&&e.highpassfreq==-1||e.scale_left<e.scale_right||e.scale_left>e.scale_right||e.disable_reservoir&&e.brate<320||e.noATH||e.ATHonly||Z0==0||e.in_samplerate<=32e3)&&(L0=1),E0=x0+(M0<<2)+(L0<<5)+(T0<<6),A0=b.nMusicCRC,y0(a,n+M,P),M+=4;for(var ee=0;ee<9;ee++)a[n+M+ee]=255&o0.charAt(ee);M+=9,a[n+M]=255&b0,M++,a[n+M]=255&V0,M++,y0(a,n+M,U0),M+=4,N(a,n+M,o),M+=2,N(a,n+M,u),M+=2,a[n+M]=255&g0,M++,j0>=255?a[n+M]=255:a[n+M]=255&j0,M++,a[n+M]=255&f>>4,a[n+M+1]=255&(f<<4)+(F>>8),a[n+M+2]=255&F,M+=3,a[n+M]=255&E0,M++,a[n+M++]=0,N(a,n+M,e.preset),M+=2,y0(a,n+M,t),M+=4,N(a,n+M,A0),M+=2;for(var le=0;le<M;le++)v=B(a[n+le],v);return N(a,n+M,v),M+=2,M}function h(e){e.seek(0);var t=$(10);e.readFully(t);var a;return new String(t,"ISO-8859-1").startsWith("ID3")?a=0:a=((t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127)+t.length,a}this.getLameTagFrame=function(e,t){var a=e.internal_flags;if(!e.bWriteVbrTag||a.Class_ID!=Lame.LAME_ID||a.VBR_seek_table.pos<=0)return 0;if(t.length<a.VBR_seek_table.TotalFrameSize)return a.VBR_seek_table.TotalFrameSize;n0.fill(t,0,a.VBR_seek_table.TotalFrameSize,0),d(e,t);var n=$(S);if(e.free_format)for(var v=1;v<S;++v)n[v]=255&255*v/100;else W(a.VBR_seek_table,n);var b=a.sideinfo_len;e.error_protection&&(b-=2),e.VBR==r0.vbr_off?(t[b++]=255&O.charAt(0),t[b++]=255&O.charAt(1),t[b++]=255&O.charAt(2),t[b++]=255&O.charAt(3)):(t[b++]=255&D.charAt(0),t[b++]=255&D.charAt(1),t[b++]=255&D.charAt(2),t[b++]=255&D.charAt(3)),y0(t,b,E+I+a0+e0),b+=4,y0(t,b,a.VBR_seek_table.nVbrNumFrames),b+=4;var M=a.VBR_seek_table.nBytesWritten+a.VBR_seek_table.TotalFrameSize;y0(t,b,0|M),b+=4,p.arraycopy(n,0,t,b,n.length),b+=n.length,e.error_protection&&U.CRC_writeheader(a,t);for(var f=0,v=0;v<b;v++)f=B(t[v],f);return b+=C(e,M,t,b,f),a.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(e,t){var a=e.internal_flags;if(a.VBR_seek_table.pos<=0||(t.seek(t.length()),t.length()==0))return-1;var n=h(t);t.seek(n);var v=$(A),b=getLameTagFrame(e,v);return b>v.length?-1:(b<1||t.write(v,0,b),0)}}return V1=J,V1}var Ea;function ut(){if(Ea)return qe;Ea=1;var _=$0();_.System,_.VbrMode,_.Float,_.ShortBlock,_.Util,_.Arrays,_.new_array_n;var p=_.new_byte;_.new_double,_.new_float,_.new_float_n,_.new_int,_.new_int_n;var r0=_.assert,K=tt(),n0=rt(),$=ka(),Y=La(),J=lt(),L=Va(),U=ot(),k=Ta(),E=Na();ie();var I=_t(),a0=vt();function e0(){this.setModules=function(y,Q){}}function S(){this.setModules=function(y,Q,D){}}function A(){}function c(){this.setModules=function(y,Q){}}function H(y,Q,D){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),y=1,Q=44100,D=128);var O=new K,l0=new e0,h0=new $,W=new E,m=new n0,y0=new Y,N=new J,R=new a0,l=new I,d=new c,B=new U,C=new L,h=new S,e=new A;O.setModules(h0,W,m,y0,N,R,l,d,e),W.setModules(h0,e,l,R),d.setModules(W,l),m.setModules(O),N.setModules(W,B,y0,C),y0.setModules(C,B,O.enc.psy),B.setModules(W),C.setModules(y0),R.setModules(O,W,l),l0.setModules(h,e),h.setModules(l,d,m);var t=O.lame_init();t.num_channels=y,t.in_samplerate=Q,t.brate=D,t.mode=k.STEREO,t.quality=3,t.bWriteVbrTag=!1,t.disable_reservoir=!0,t.write_id3tag_automatic=!1;var a=O.lame_init_params(t);r0(a==0);var n=1152,v=0|1.25*n+7200,b=p(v);this.encodeBuffer=function(M,f){y==1&&(f=M),r0(M.length==f.length),M.length>n&&(n=M.length,v=0|1.25*n+7200,b=p(v));var F=O.lame_encode_buffer(t,M,f,M.length,b,0,v);return new Int8Array(b.subarray(0,F))},this.flush=function(){var M=O.lame_encode_flush(t,b,0,v);return new Int8Array(b.subarray(0,M))}}function r(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function V(y){return y.charCodeAt(0)<<24|y.charCodeAt(1)<<16|y.charCodeAt(2)<<8|y.charCodeAt(3)}return r.RIFF=V("RIFF"),r.WAVE=V("WAVE"),r.fmt_=V("fmt "),r.data=V("data"),r.readHeader=function(y){var Q=new r,D=y.getUint32(0,!1);if(r.RIFF==D&&(y.getUint32(4,!0),r.WAVE==y.getUint32(8,!1)&&r.fmt_==y.getUint32(12,!1))){var O=y.getUint32(16,!0),l0=20;switch(O){case 16:case 18:Q.channels=y.getUint16(l0+2,!0),Q.sampleRate=y.getUint32(l0+4,!0);break;default:throw"extended fmt chunk not implemented"}l0+=O;for(var h0=r.data,W=0;h0!=D&&(D=y.getUint32(l0,!1),W=y.getUint32(l0+4,!0),h0!=D);)l0+=W+8;return Q.dataLen=W,Q.dataOffset=l0+8,Q}},qe.Mp3Encoder=H,qe.WavHeader=r,qe}var ht=ut();const dt=Ha(ht),ft={class:"h-screen flex bg-gradient-to-br from-slate-900 via-indigo-900 to-slate-900"},ct={class:"hidden lg:flex w-16 flex-col bg-slate-900/80 border-r border-white/10"},mt={class:"h-16 flex items-center justify-center border-b border-white/10"},bt={class:"h-10 w-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center"},xt={class:"text-lg font-bold text-white"},wt={class:"flex-1 py-4 space-y-2"},Mt={class:"p-3 border-t border-white/10"},St={class:"text-sm font-bold text-white"},pt={key:0,class:"absolute bottom-16 left-2 w-48 rounded-lg bg-slate-800 border border-white/10 shadow-xl overflow-hidden z-50"},Rt={class:"w-80 bg-slate-800/50 border-r border-white/10 flex flex-col backdrop-blur-xl"},At={class:"p-4 border-b border-white/10"},yt={class:"flex items-center justify-between mb-3"},Et={class:"flex items-center gap-2"},Bt={key:0,class:"bg-indigo-500 text-white px-2 py-0.5 rounded-full text-xs font-bold"},Tt={class:"relative"},It={class:"flex-1 overflow-y-auto"},kt={key:0,class:"p-6 text-center text-slate-400"},Ct=["onClick"],Lt={class:"ml-3 flex-1 min-w-0"},Vt={class:"flex justify-between items-center mb-1"},Nt={class:"font-semibold text-white truncate"},Ot={class:"text-xs text-slate-400 whitespace-nowrap ml-2"},Ht={class:"text-sm text-slate-400 truncate"},Ft={key:0,class:"ml-2 bg-indigo-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center"},Dt={key:0,class:"flex-1 flex flex-col min-h-0"},qt={class:"px-5 py-3 bg-slate-800/80 border-b border-white/10 flex items-center justify-between shrink-0 backdrop-blur-xl"},Xt={class:"flex items-center"},Yt={class:"ml-3"},Gt={class:"font-semibold text-white"},Pt={key:0,class:"flex justify-center my-4"},Ut={class:"bg-slate-700/80 text-slate-300 text-xs font-medium px-4 py-1.5 rounded-full"},jt=["src","onClick"],Kt={key:0,class:"text-sm text-white mt-2"},Zt={class:"flex items-start gap-3 min-w-[220px] p-2 bg-slate-600/50 rounded-lg"},zt={class:"text-white text-xs font-bold"},Qt={class:"flex-1 min-w-0"},Wt={class:"text-sm font-medium text-white truncate"},$t={class:"text-xs text-slate-300 mt-0.5"},Jt={class:"flex gap-4 mt-2 text-sm"},gt=["onClick"],er=["href","download"],ar={key:2,class:"flex items-center gap-3 min-w-[200px] p-2"},tr={controls:"",class:"w-full max-w-[240px] h-8",controllerslist:"nodownload"},rr=["src"],sr=["src"],nr=["src"],ir={key:3,class:"text-sm text-white break-words"},lr={class:"flex items-center justify-end gap-1 mt-1"},or={class:"text-[10px] text-white/60"},_r={key:0,class:"w-4 h-4 text-white/60",fill:"currentColor",viewBox:"0 0 24 24"},vr={key:0,class:"absolute inset-0 bg-indigo-500/20 border-4 border-dashed border-indigo-500 rounded-lg flex items-center justify-center z-50"},ur={class:"px-4 py-3 bg-slate-800/80 border-t border-white/10 flex items-center gap-3 backdrop-blur-xl"},hr={key:1,class:"flex-1 px-5 py-3 rounded-xl bg-slate-700/50 border border-white/10 flex items-center justify-between"},dr={class:"flex items-center gap-3"},fr={class:"text-white font-mono text-sm"},cr=["disabled"],mr={key:3,class:"flex gap-2"},br={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xr={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},wr={key:1,class:"flex-1 flex flex-col items-center justify-center text-slate-400"},Mr={key:0,class:"hidden xl:flex w-80 bg-slate-900 border-l border-white/10 flex-col backdrop-blur-xl shrink-0 transition-all"},Sr={key:0,class:"flex-1 flex items-center justify-center text-slate-400"},pr={key:1,class:"flex-1 overflow-y-auto p-4 space-y-6"},Rr={class:"p-3 bg-slate-800/50 rounded-lg border border-white/5"},Ar={class:"text-white font-medium"},yr={class:"text-slate-400 text-sm"},Er={class:"text-slate-400 text-sm"},Br={class:"space-y-4"},Tr={class:"space-y-2 max-h-40 overflow-y-auto pr-1"},Ir=["checked","onChange"],kr={class:"text-white block"},Cr={key:0,class:"text-xs text-slate-500"},Lr={key:0,class:"text-xs text-slate-500 italic"},Vr={class:"space-y-2"},Nr=["checked","onChange"],Or={class:"text-white"},Hr={key:0,class:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4"},Fr={class:"bg-slate-900 border border-white/10 rounded-xl max-w-lg w-full max-h-[90vh] flex flex-col overflow-hidden shadow-2xl"},Dr={class:"flex items-center justify-between p-4 border-b border-white/10"},qr={class:"flex items-center gap-3"},Xr={class:"text-white font-medium"},Yr={class:"flex-1 overflow-y-auto p-4 bg-slate-800/50"},Gr={key:0,class:"flex items-center justify-center min-h-[200px]"},Pr=["src"],Ur={key:1,class:"text-center"},jr={class:"text-white font-medium"},Kr={class:"text-slate-400 text-sm"},Zr={key:1,class:"flex gap-2 mt-4 justify-center flex-wrap"},zr=["onClick"],Qr=["src"],Wr={key:1,class:"w-16 h-16 bg-slate-700 flex items-center justify-center"},$r=["onClick"],Jr={class:"p-4 bg-slate-800 border-t border-white/10"},gr={class:"flex items-center gap-3"},es=["disabled"],as={key:1,class:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4"},ts={class:"bg-slate-900 border border-white/10 rounded-xl max-w-sm w-full shadow-2xl overflow-hidden"},rs={class:"p-4 bg-indigo-600 flex justify-between items-center"},ss={class:"p-6 space-y-4"},ns={class:"relative"},is=["value"],ls=["disabled"],os={key:0,class:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"},_s={__name:"Index",props:{initialContacts:Array,catalogs:{type:Object,default:()=>({})}},setup(_){const p=_,r0=Fa(),K=Oe(()=>r0.props.auth.user),n0=Oe(()=>r0.props.auth?.user?.tenant||{});P0(!1);const $=P0(!1),Y=()=>{Ga.post(route("logout"))},J=P0(p.initialContacts),L=P0(null),U=P0([]),k=P0(null),E=P0(""),I=P0(null),a0=P0(null),e0=P0(!1),S=P0(!0),A=P0(!1),c=P0({nivel_interes:"",estado_crm:"",notas_crm:"",sedes:[],carreras:[],ofertas:[],eventos:[]}),H=async g=>{A.value=!0;try{const s=await be.get(route("chat.contact.details",g));c.value=s.data}catch(s){console.error("Error fetching CRM data",s)}finally{A.value=!1}},r=async()=>{if(L.value)try{await be.put(route("chat.contact.update",L.value.id),c.value)}catch(g){console.error("Failed to update CRM",g),alert("Error al guardar datos CRM")}},V=(g,s)=>{const i=c.value[g],w=i.indexOf(s);w>-1?i.splice(w,1):i.push(s)},y=P0(!1),Q=P0("591"),D=P0(""),O=P0(""),l0=P0([]),h0=P0(!1);G1(y,g=>{g&&l0.value.length===0&&W()});const W=async()=>{try{const g=await be.get("/debug-templates");g.data&&g.data.data&&(l0.value=g.data.data.filter(s=>s.status==="APPROVED").map(s=>({name:s.name,language:s.language})),l0.value.length>0&&(O.value=l0.value[0].name))}catch(g){console.error("Error fetching templates",g)}},m=Oe(()=>J.value.reduce((g,s)=>g+(s.unread||0),0)),y0=async()=>{if(D.value){h0.value=!0;try{const g=Q.value+D.value,i=(await be.post(route("chat.initiate"),{phone:g,template:O.value})).data,w=J.value.findIndex(T=>T.id===i.id);w===-1?(J.value.unshift({...i,relativeDate:M(i.time,!0),formattedTime:b(i.time)}),c0(J.value[0])):c0(J.value[w]),y.value=!1,D.value=""}catch(g){console.error("Error initiating chat",g),alert("Error al iniciar chat")}finally{h0.value=!1}}},N=P0(!1),R=P0([]),l=P0(""),d=P0(0),B=P0(!1),C=P0(0),h=P0(null),e=P0([]),t=P0(null);let a=null;const n=["Domingo","Lunes","Martes","Mircoles","Jueves","Viernes","Sbado"],v=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],b=g=>{if(!g)return"";let s;return g.includes("T")&&(g.includes("+")||g.includes("Z"))?s=new Date(g):s=new Date(g.replace(" ","T")+"Z"),isNaN(s.getTime())?g:s.toLocaleTimeString("es-BO",{hour:"2-digit",minute:"2-digit"})},M=(g,s=!1)=>{if(!g)return"";let i;if(g.includes("T")&&(g.includes("+")||g.includes("Z"))?i=new Date(g):i=new Date(g.replace(" ","T")+"Z"),isNaN(i.getTime()))return g;const w=new Date,T=new Date(w.getFullYear(),w.getMonth(),w.getDate()),G=new Date(i.getFullYear(),i.getMonth(),i.getDate()),x=Math.floor((T-G)/(1e3*60*60*24));return x===0?s?b(g):"Hoy":x===1?"Ayer":x===2?"Anteayer":x<7?n[i.getDay()]:`${i.getDate()} ${v[i.getMonth()]}`},f=g=>{if(!g)return"";let s;return g.includes("T")&&(g.includes("+")||g.includes("Z"))?s=new Date(g):s=new Date(g.replace(" ","T")+"Z"),`${s.getFullYear()}-${s.getMonth()}-${s.getDate()}`},F=Oe(()=>{if(!E.value.trim())return J.value;const g=E.value.toLowerCase();return J.value.filter(s=>s.name&&s.name.toLowerCase().includes(g)||s.lastMessage&&s.lastMessage.toLowerCase().includes(g))}),P=Oe(()=>{const g=[];let s=null;return U.value.forEach(i=>{const w=f(i.rawDate);w!==s&&(g.push({type:"separator",date:M(i.rawDate),key:"sep-"+w}),s=w),g.push({type:"message",...i})}),g}),o0=async()=>{await Ya(),setTimeout(()=>{k.value&&(k.value.scrollTop=k.value.scrollHeight)},100)};G1(U,()=>{o0()},{deep:!0});const c0=async g=>{if(L.value=g,U.value=[],d0(),H(g.id),g.unread>0)try{await be.post(route("chat.read",g.id));const s=J.value.findIndex(i=>i.id===g.id);s!==-1&&(J.value[s].unread=0)}catch(s){console.error("Error marking as read",s)}},d0=async()=>{if(L.value)try{const s=(await be.get(route("chat.messages",L.value.id))).data.map(i=>({id:i.id,text:i.body,sender:i.direction==="outgoing"?"me":"them",time:b(i.created_at),rawDate:i.created_at,msgType:i.type,metadata:(()=>{if(!i.metadata)return null;if(typeof i.metadata=="object")return i.metadata;try{return JSON.parse(i.metadata)}catch(w){return console.error("Error parsing metadata",w,i.metadata),null}})()}));s.length!==U.value.length&&(U.value=s)}catch(g){console.error("Error loading messages",g)}},b0=async()=>{try{const g=await be.get(route("chat.contacts"));J.value=g.data.map(s=>({...s,relativeDate:M(s.time,!0),formattedTime:b(s.time)}))}catch(g){console.error("Error fetching contacts",g)}},S0=P0(""),V0=P0(!1),U0=async()=>{if(!S0.value.trim()||!L.value)return;const g=S0.value;S0.value="",V0.value=!0;const s=new Date().toISOString(),i=Date.now();U.value.push({id:i,text:g,sender:"me",time:b(s),rawDate:s});try{await be.post(route("chat.send",L.value.id),{message:g})}catch(w){console.error("Failed to send",w),alert("Error al enviar mensaje")}finally{V0.value=!1}},o=g=>{if(!g)return"?";const s=g.split(" ");return s.length>=2?(s[0][0]+s[1][0]).toUpperCase():g.substring(0,2).toUpperCase()},u=g=>{if(!g)return"bg-slate-500";const s=["bg-indigo-500","bg-purple-500","bg-pink-500","bg-rose-500","bg-orange-500","bg-teal-500","bg-cyan-500","bg-emerald-500"],i=g.charCodeAt(0)%s.length;return s[i]},x0=g=>{window.open(g,"_blank")},M0=g=>{if(g.metadata?.filename)return g.metadata.filename;if(g.text&&!g.text.includes("/"))return g.text;if(g.text?.includes("/")){const s=g.text.split("/");return s[s.length-1]||"Documento"}return"Documento"},L0=g=>M0(g).split(".").pop()?.toUpperCase()||"Archivo",T0=g=>g.metadata?.local_url?g.metadata.local_url:g.text?.startsWith("http")?g.text:`/storage/chat-media/${g.text}`,E0=g=>{const s=L0(g).toLowerCase();return{pdf:"bg-red-500",doc:"bg-blue-600",docx:"bg-blue-600",xls:"bg-green-600",xlsx:"bg-green-600",txt:"bg-gray-500"}[s]||"bg-slate-500"},A0=g=>{const s=L0(g).toUpperCase();return s.length>4?s.substring(0,4):s},D0=g=>{const s=T0(g);window.open(s,"_blank")},k0=async(g,s="")=>{const i=new FormData;i.append("image",g),s&&i.append("caption",s);const w=Date.now()+Math.random(),T=URL.createObjectURL(g);U.value.push({id:w,text:T,sender:"me",time:new Date().toLocaleTimeString("es-BO",{hour:"2-digit",minute:"2-digit"}),rawDate:new Date().toISOString(),msgType:"image",metadata:s?{caption:s}:null});try{await be.post(route("chat.sendImage",L.value.id),i,{headers:{"Content-Type":"multipart/form-data"}})}catch(G){console.error("Failed to send image",G)}},m0=async g=>{const s=new FormData;s.append("document",g),s.append("filename",g.name);const i=Date.now()+Math.random();U.value.push({id:i,text:g.name,sender:"me",time:new Date().toLocaleTimeString("es-BO",{hour:"2-digit",minute:"2-digit"}),rawDate:new Date().toISOString(),msgType:"document"});try{await be.post(route("chat.sendDocument",L.value.id),s,{headers:{"Content-Type":"multipart/form-data"}})}catch(w){console.error("Failed to send document",w)}},X0=async()=>{try{const g=await navigator.mediaDevices.getUserMedia({audio:!0});let s={};MediaRecorder.isTypeSupported("audio/webm;codecs=opus")?s={mimeType:"audio/webm;codecs=opus"}:MediaRecorder.isTypeSupported("audio/ogg;codecs=opus")?s={mimeType:"audio/ogg;codecs=opus"}:MediaRecorder.isTypeSupported("audio/mp4")?s={mimeType:"audio/mp4"}:console.warn("Using default MediaRecorder mimeType"),h.value=new MediaRecorder(g,s),e.value=[],h.value.ondataavailable=i=>{e.value.push(i.data)},h.value.onstop=()=>{g.getTracks().forEach(i=>i.stop())},h.value.start(200),B.value=!0,C.value=0,t.value=setInterval(()=>{C.value++},1e3)}catch(g){console.error("Error accessing microphone",g),alert("No se pudo acceder al micrfono")}},J0=()=>{h.value&&(h.value.onstop=async()=>{const g=h.value.mimeType,s=new Blob(e.value,{type:g}),i=await Z0(s);await j0(i),B.value=!1,clearInterval(t.value),C.value=0,e.value=[]},h.value.stop())},Y0=()=>{h.value&&B.value&&(h.value.stop(),B.value=!1,clearInterval(t.value),C.value=0,e.value=[],h.value.stream&&h.value.stream.getTracks().forEach(g=>g.stop()))},Z0=async g=>{try{const s=await g.arrayBuffer(),i=new AudioContext,w=await i.decodeAudioData(s),T=1,G=w.sampleRate,x=new dt.Mp3Encoder(T,G,128),X=w.getChannelData(0),j=new Int16Array(X.length);for(let f0=0;f0<X.length;f0++){const B0=Math.max(-1,Math.min(1,X[f0]));j[f0]=B0<0?B0*32768:B0*32767}const q=[],s0=1152;for(let f0=0;f0<j.length;f0+=s0){const B0=j.subarray(f0,f0+s0),_0=x.encodeBuffer(B0);_0.length>0&&q.push(_0)}const z=x.flush();z.length>0&&q.push(z),await i.close();const i0=new Blob(q,{type:"audio/mpeg"});return new File([i0],"voice_note.mp3",{type:"audio/mpeg"})}catch(s){return console.error("MP3 conversion failed:",s),new File([g],"voice_note.ogg",{type:"audio/ogg"})}},g0=g=>{const s=Math.floor(g/60),i=g%60;return`${s}:${i.toString().padStart(2,"0")}`},j0=async g=>{const s=new FormData;s.append("audio",g);const i=Date.now()+Math.random(),w=URL.createObjectURL(g);U.value.push({id:i,text:w,sender:"me",time:new Date().toLocaleTimeString("es-BO",{hour:"2-digit",minute:"2-digit"}),rawDate:new Date().toISOString(),msgType:"audio"});try{await be.post(route("chat.sendAudio",L.value.id),s,{headers:{"Content-Type":"multipart/form-data"}})}catch(T){console.error("Failed to send audio",T),alert("Error al enviar audio")}},ee=g=>{const s=Array.from(g.target.files);!s.length||!L.value||(te(s),g.target.value="")},le=g=>{const s=Array.from(g.target.files);!s.length||!L.value||(te(s),g.target.value="")},te=g=>{R.value=g.map(s=>({file:s,name:s.name,type:s.type,isImage:s.type.startsWith("image/"),preview:s.type.startsWith("image/")?URL.createObjectURL(s):null,size:(s.size/1024).toFixed(1)+" KB"})),d.value=0,l.value="",N.value=!0},oe=()=>{R.value.forEach(g=>{g.preview&&URL.revokeObjectURL(g.preview)}),R.value=[],l.value="",N.value=!1},xe=g=>{R.value[g].preview&&URL.revokeObjectURL(R.value[g].preview),R.value.splice(g,1),R.value.length===0?oe():d.value>=R.value.length&&(d.value=R.value.length-1)},_e=async()=>{if(!R.value.length||!L.value)return;N.value=!1,V0.value=!0;const g=l.value;for(const s of R.value)s.isImage?await k0(s.file,g):await m0(s.file);R.value.forEach(s=>{s.preview&&URL.revokeObjectURL(s.preview)}),R.value=[],l.value="",V0.value=!1},Ae=g=>{g.preventDefault(),e0.value=!0},we=()=>{e0.value=!1},ye=g=>{if(g.preventDefault(),e0.value=!1,!L.value)return;const s=Array.from(g.dataTransfer.files);s.length&&te(s)};return Da(()=>{a=setInterval(()=>{b0(),L.value&&d0()},5e3)}),qa(()=>{a&&clearInterval(a)}),(g,s)=>(O0(),N0(Se,null,[We($e(Xa),{title:"Chat WhatsApp"}),Z("div",ft,[Z("div",ct,[Z("div",mt,[Z("div",bt,[Z("span",xt,G0(n0.value?.name?.charAt(0)||"C"),1)])]),Z("nav",wt,[We($e(U1),{href:g.route("tenant.dashboard"),class:"flex items-center justify-center p-3 mx-2 rounded-xl text-slate-400 hover:bg-white/10 hover:text-white transition-colors",title:"Dashboard"},{default:P1(()=>[...s[16]||(s[16]=[Z("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)])]),_:1},8,["href"]),s[17]||(s[17]=Z("div",{class:"flex items-center justify-center p-3 mx-2 rounded-xl bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg"},[Z("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])],-1))]),Z("div",Mt,[Z("button",{onClick:s[0]||(s[0]=i=>$.value=!$.value),class:"relative w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-500 flex items-center justify-center mx-auto"},[Z("span",St,G0(K.value?.name?.charAt(0)||"U"),1)]),$.value?(O0(),N0("div",pt,[We($e(U1),{href:g.route("tenant.settings"),class:"flex items-center gap-2 px-4 py-2.5 text-sm text-slate-300 hover:bg-white/10"},{default:P1(()=>[...s[18]||(s[18]=[De(" Configuracin",-1)])]),_:1},8,["href"]),Z("button",{onClick:Y,class:"flex w-full items-center gap-2 px-4 py-2.5 text-sm text-red-400 hover:bg-red-500/10"},"Cerrar Sesin")])):se("",!0)])]),Z("div",Rt,[Z("div",At,[Z("div",yt,[Z("div",Et,[s[19]||(s[19]=Z("h2",{class:"text-white font-semibold text-lg"},"Conversaciones",-1)),m.value>0?(O0(),N0("span",Bt,G0(m.value),1)):se("",!0)]),Z("button",{onClick:s[1]||(s[1]=i=>y.value=!0),class:"p-2 bg-indigo-500/20 hover:bg-indigo-500/30 rounded-lg text-indigo-400 transition-colors",title:"Nuevo Chat"},[...s[20]||(s[20]=[Z("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])]),Z("div",Tt,[s[21]||(s[21]=Z("svg",{class:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)),pe(Z("input",{"onUpdate:modelValue":s[2]||(s[2]=i=>E.value=i),type:"text",placeholder:"Buscar chat...",class:"w-full pl-10 pr-4 py-2.5 rounded-xl bg-slate-700/50 border border-white/10 text-white text-sm placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"},null,512),[[Ie,E.value]])])]),Z("div",It,[F.value.length===0?(O0(),N0("div",kt,[...s[22]||(s[22]=[Z("svg",{class:"w-12 h-12 mx-auto mb-2 opacity-50",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),Z("p",{class:"text-sm"},"No hay conversaciones",-1)])])):se("",!0),(O0(!0),N0(Se,null,ke(F.value,i=>(O0(),N0("div",{key:i.id,onClick:w=>c0(i),class:Re(["flex items-center p-4 cursor-pointer border-b border-white/5 transition-all duration-200 hover:bg-white/5",{"bg-indigo-500/20 border-l-4 border-l-indigo-500":L.value&&L.value.id===i.id}])},[Z("div",{class:Re([u(i.name),"w-12 h-12 rounded-full flex items-center justify-center text-white font-semibold text-sm shadow-md"])},G0(o(i.name)),3),Z("div",Lt,[Z("div",Vt,[Z("h3",Nt,G0(i.name),1),Z("span",Ot,G0(i.relativeDate||i.formattedTime),1)]),Z("p",Ht,G0(i.lastMessage||"Sin mensajes"),1)]),i.unread>0?(O0(),N0("div",Ft,G0(i.unread),1)):se("",!0)],10,Ct))),128))])]),Z("div",{class:"flex-1 flex flex-col bg-slate-900/50 min-h-0 relative",onDragover:Ae,onDragleave:we,onDrop:ye},[L.value?(O0(),N0("div",Dt,[Z("div",qt,[Z("div",Xt,[Z("div",{class:Re([u(L.value.name),"w-11 h-11 rounded-full flex items-center justify-center text-white font-semibold shadow-md"])},G0(o(L.value.name)),3),Z("div",Yt,[Z("h3",Gt,G0(L.value.name),1),s[23]||(s[23]=Z("p",{class:"text-xs text-green-400"},"En lnea",-1))])])]),Z("div",{ref_key:"messageContainer",ref:k,class:"flex-1 overflow-y-auto px-6 py-4 min-h-0"},[(O0(!0),N0(Se,null,ke(P.value,i=>(O0(),N0(Se,{key:i.key||i.id},[i.type==="separator"?(O0(),N0("div",Pt,[Z("span",Ut,G0(i.date),1)])):(O0(),N0("div",{key:1,class:Re(["flex mb-2",i.sender==="me"?"justify-end":"justify-start"])},[Z("div",{class:Re(["max-w-[70%] px-3 py-2 rounded-xl shadow-sm relative",i.sender==="me"?"bg-indigo-600 rounded-br-sm":"bg-slate-700 rounded-bl-sm"])},[i.msgType==="image"?(O0(),N0(Se,{key:0},[Z("img",{src:i.text,alt:"Imagen",class:"max-w-[280px] max-h-[300px] rounded-lg cursor-pointer hover:opacity-90 object-cover",onClick:w=>x0(i.text)},null,8,jt),i.metadata?.caption?(O0(),N0("p",Kt,G0(i.metadata.caption),1)):se("",!0)],64)):i.msgType==="document"?(O0(),N0(Se,{key:1},[Z("div",Zt,[Z("div",{class:Re(["flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center",E0(i)])},[Z("span",zt,G0(A0(i)),1)],2),Z("div",Qt,[Z("p",Wt,G0(M0(i)),1),Z("p",$t,G0(L0(i)),1)])]),Z("div",Jt,[Z("button",{onClick:w=>D0(i),class:"text-indigo-300 hover:text-indigo-200 font-medium"},"Abrir",8,gt),Z("a",{href:T0(i),download:M0(i),class:"text-indigo-300 hover:text-indigo-200 font-medium"},"Descargar",8,er)])],64)):i.msgType==="audio"?(O0(),N0("div",ar,[Z("audio",tr,[Z("source",{src:i.text.startsWith("http")||i.text.startsWith("blob:")?i.text:`/storage/${i.text.replace("public/","")}`,type:"audio/mpeg"},null,8,rr),Z("source",{src:i.text.startsWith("http")||i.text.startsWith("blob:")?i.text:`/storage/${i.text.replace("public/","")}`,type:"audio/ogg"},null,8,sr),Z("source",{src:i.text.startsWith("http")||i.text.startsWith("blob:")?i.text:`/storage/${i.text.replace("public/","")}`,type:"audio/webm"},null,8,nr),s[24]||(s[24]=De(" Tu navegador no soporta audio. ",-1))])])):(O0(),N0("p",ir,G0(i.text),1)),Z("div",lr,[Z("span",or,G0(i.time),1),i.sender==="me"?(O0(),N0("svg",_r,[...s[25]||(s[25]=[Z("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"},null,-1)])])):se("",!0)])],2)],2))],64))),128))],512),e0.value?(O0(),N0("div",vr,[...s[26]||(s[26]=[Z("div",{class:"text-center"},[Z("svg",{class:"w-16 h-16 mx-auto text-indigo-400 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})]),Z("p",{class:"text-lg font-semibold text-indigo-300"},"Suelta tus archivos aqu")],-1)])])):se("",!0),Z("div",ur,[Z("input",{type:"file",ref_key:"imageInput",ref:I,accept:"image/*",multiple:"",class:"hidden",onChange:ee},null,544),Z("input",{type:"file",ref_key:"documentInput",ref:a0,multiple:"",class:"hidden",onChange:le},null,544),Z("button",{onClick:s[3]||(s[3]=i=>g.$refs.imageInput.click()),class:"p-2 rounded-lg hover:bg-white/10 text-slate-400 transition-colors",title:"Enviar imagen"},[...s[27]||(s[27]=[Z("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])]),Z("button",{onClick:s[4]||(s[4]=i=>g.$refs.documentInput.click()),class:"p-2 rounded-lg hover:bg-white/10 text-slate-400 transition-colors",title:"Enviar documento"},[...s[28]||(s[28]=[Z("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})],-1)])]),B.value?(O0(),N0("div",hr,[Z("div",dr,[s[29]||(s[29]=Z("span",{class:"relative flex h-3 w-3"},[Z("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),Z("span",{class:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})],-1)),Z("span",fr,G0(g0(C.value)),1)]),s[30]||(s[30]=Z("span",{class:"text-slate-400 text-xs"},"Grabando audio...",-1))])):pe((O0(),N0("input",{key:0,"onUpdate:modelValue":s[5]||(s[5]=i=>S0.value=i),onKeyup:Je(U0,["enter"]),type:"text",placeholder:"Escribe un mensaje",class:"flex-1 px-5 py-3 rounded-xl bg-slate-700/50 border border-white/10 text-white text-sm placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500"},null,544)),[[Ie,S0.value]]),S0.value.trim()?(O0(),N0("button",{key:2,onClick:U0,disabled:V0.value,class:"p-3 bg-indigo-500 hover:bg-indigo-600 text-white rounded-xl disabled:opacity-50 disabled:cursor-not-allowed transition-colors shadow-lg"},[...s[31]||(s[31]=[Z("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1)])],8,cr)):(O0(),N0("div",mr,[B.value?(O0(),N0("button",{key:0,onClick:Y0,class:"p-3 bg-slate-600 hover:bg-slate-500 text-white rounded-xl transition-colors shadow-lg",title:"Cancelar"},[...s[32]||(s[32]=[Z("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])):se("",!0),Z("button",{onClick:s[6]||(s[6]=i=>B.value?J0():X0()),class:Re(["p-3 text-white rounded-xl transition-colors shadow-lg",B.value?"bg-green-500 hover:bg-green-600":"bg-slate-700 hover:bg-slate-600"])},[B.value?(O0(),N0("svg",xr,[...s[34]||(s[34]=[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):(O0(),N0("svg",br,[...s[33]||(s[33]=[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"},null,-1)])]))],2)]))])])):(O0(),N0("div",wr,[...s[35]||(s[35]=[j1('<div class="w-24 h-24 bg-slate-700/50 rounded-full flex items-center justify-center mb-4" data-v-8afe2e6f><svg class="w-12 h-12 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-v-8afe2e6f><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" data-v-8afe2e6f></path></svg></div><h3 class="text-xl font-medium text-white mb-2" data-v-8afe2e6f>Chat WhatsApp</h3><p class="text-sm" data-v-8afe2e6f>Selecciona un chat para comenzar</p>',3)])]))],32),L.value&&S.value?(O0(),N0("div",Mr,[Z("div",{class:"p-4 border-b border-white/10 flex justify-between items-center"},[s[36]||(s[36]=Z("h3",{class:"text-white font-semibold"},"CRM Contacto",-1)),Z("button",{onClick:r,class:"px-3 py-1.5 bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium rounded-lg transition-colors"}," Guardar ")]),A.value?(O0(),N0("div",Sr,[...s[37]||(s[37]=[Z("svg",{class:"animate-spin h-5 w-5 mr-2 text-white",fill:"none",viewBox:"0 0 24 24"},[Z("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),Z("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),De(" Cargando... ",-1)])])):(O0(),N0("div",pr,[Z("div",Rr,[s[38]||(s[38]=Z("p",{class:"text-xs text-slate-500 uppercase font-bold mb-2"},"Contacto",-1)),Z("p",Ar,G0(L.value.name),1),Z("p",yr,G0(L.value.wa_id),1),Z("p",Er,G0(L.value.email||"Sin email"),1)]),Z("div",Br,[Z("div",null,[s[40]||(s[40]=Z("label",{class:"block text-xs font-medium text-slate-400 mb-1"},"Nivel de Inters",-1)),pe(Z("select",{"onUpdate:modelValue":s[7]||(s[7]=i=>c.value.nivel_interes=i),class:"w-full bg-slate-800 border border-white/10 rounded-lg text-white text-sm px-3 py-2 focus:ring-1 focus:ring-indigo-500 outline-none"},[...s[39]||(s[39]=[Z("option",{value:""},"-- Seleccionar --",-1),Z("option",{value:"frio"}," Fro",-1),Z("option",{value:"tibio"}," Tibio",-1),Z("option",{value:"caliente"}," Caliente",-1)])],512),[[ge,c.value.nivel_interes]])]),Z("div",null,[s[42]||(s[42]=Z("label",{class:"block text-xs font-medium text-slate-400 mb-1"},"Estado CRM",-1)),pe(Z("select",{"onUpdate:modelValue":s[8]||(s[8]=i=>c.value.estado_crm=i),class:"w-full bg-slate-800 border border-white/10 rounded-lg text-white text-sm px-3 py-2 focus:ring-1 focus:ring-indigo-500 outline-none"},[...s[41]||(s[41]=[j1('<option value="" data-v-8afe2e6f>-- Seleccionar --</option><option value="prospecto" data-v-8afe2e6f>Prospecto</option><option value="interesado" data-v-8afe2e6f>Interesado</option><option value="inscrito" data-v-8afe2e6f>Inscrito</option><option value="perdido" data-v-8afe2e6f>Perdido</option>',5)])],512),[[ge,c.value.estado_crm]])])]),Z("div",null,[s[43]||(s[43]=Z("label",{class:"block text-xs font-medium text-slate-400 mb-2"},"Carreras de Inters",-1)),Z("div",Tr,[(O0(!0),N0(Se,null,ke(_.catalogs.carreras,i=>(O0(),N0("label",{key:i.id,class:"flex items-start gap-2 p-2 rounded hover:bg-white/5 cursor-pointer text-sm"},[Z("input",{type:"checkbox",checked:c.value.carreras.includes(i.id),onChange:w=>V("carreras",i.id),class:"mt-1 rounded bg-slate-700 border-slate-500 text-indigo-600 focus:ring-indigo-500"},null,40,Ir),Z("div",null,[Z("span",kr,G0(i.nombre),1),i.duracion?(O0(),N0("span",Cr,G0(i.duracion),1)):se("",!0)])]))),128)),_.catalogs.carreras?.length?se("",!0):(O0(),N0("p",Lr,"No hay carreras disponibles"))])]),Z("div",null,[s[44]||(s[44]=Z("label",{class:"block text-xs font-medium text-slate-400 mb-2"},"Sedes Preferidas",-1)),Z("div",Vr,[(O0(!0),N0(Se,null,ke(_.catalogs.sedes,i=>(O0(),N0("label",{key:i.id,class:"flex items-center gap-2 p-2 rounded hover:bg-white/5 cursor-pointer text-sm"},[Z("input",{type:"checkbox",checked:c.value.sedes.includes(i.id),onChange:w=>V("sedes",i.id),class:"rounded bg-slate-700 border-slate-500 text-indigo-600 focus:ring-indigo-500"},null,40,Nr),Z("span",Or,G0(i.nombre),1)]))),128))])]),Z("div",null,[s[45]||(s[45]=Z("label",{class:"block text-xs font-medium text-slate-400 mb-1"},"Notas / Observaciones",-1)),pe(Z("textarea",{"onUpdate:modelValue":s[9]||(s[9]=i=>c.value.notas_crm=i),rows:"4",class:"w-full bg-slate-800 border border-white/10 rounded-lg text-white text-sm px-3 py-2 focus:ring-1 focus:ring-indigo-500 outline-none placeholder-slate-600",placeholder:"Escribe notas aqu..."},null,512),[[Ie,c.value.notas_crm]])]),s[46]||(s[46]=Z("div",{class:"h-10"},null,-1))]))])):se("",!0),$.value?(O0(),N0("div",{key:1,onClick:s[10]||(s[10]=i=>$.value=!1),class:"fixed inset-0 z-40"})):se("",!0)]),N.value?(O0(),N0("div",Hr,[Z("div",Fr,[Z("div",Dr,[Z("div",qr,[Z("button",{onClick:oe,class:"p-2 hover:bg-white/10 rounded-full transition-colors"},[...s[47]||(s[47]=[Z("svg",{class:"w-5 h-5 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),Z("span",Xr,G0(R.value.length)+" archivo"+G0(R.value.length>1?"s":""),1)])]),Z("div",Yr,[R.value[d.value]?(O0(),N0("div",Gr,[R.value[d.value].isImage?(O0(),N0("img",{key:0,src:R.value[d.value].preview,class:"max-w-full max-h-[300px] rounded-lg object-contain"},null,8,Pr)):(O0(),N0("div",Ur,[s[48]||(s[48]=Z("svg",{class:"w-20 h-20 mx-auto text-slate-500 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),Z("p",jr,G0(R.value[d.value].name),1),Z("p",Kr,G0(R.value[d.value].size),1)]))])):se("",!0),R.value.length>1?(O0(),N0("div",Zr,[(O0(!0),N0(Se,null,ke(R.value,(i,w)=>(O0(),N0("div",{key:w,class:Re(["relative cursor-pointer rounded-lg overflow-hidden border-2 transition-all",d.value===w?"border-indigo-500":"border-transparent"]),onClick:T=>d.value=w},[i.isImage?(O0(),N0("img",{key:0,src:i.preview,class:"w-16 h-16 object-cover"},null,8,Qr)):(O0(),N0("div",Wr,[...s[49]||(s[49]=[Z("svg",{class:"w-8 h-8 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)])])),Z("button",{onClick:Pa(T=>xe(w),["stop"]),class:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center shadow-lg"},[...s[50]||(s[50]=[Z("svg",{class:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,$r)],10,zr))),128))])):se("",!0)]),Z("div",Jr,[Z("div",gr,[pe(Z("input",{"onUpdate:modelValue":s[11]||(s[11]=i=>l.value=i),type:"text",placeholder:"Agregar un comentario...",class:"flex-1 bg-slate-700/50 text-white px-4 py-3 rounded-xl border border-white/10 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 placeholder-slate-400",onKeyup:Je(_e,["enter"])},null,544),[[Ie,l.value]]),Z("button",{onClick:_e,disabled:V0.value,class:"p-3 bg-indigo-500 hover:bg-indigo-600 rounded-xl transition-colors disabled:opacity-50"},[...s[51]||(s[51]=[Z("svg",{class:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})],-1)])],8,es)])])])])):se("",!0),y.value?(O0(),N0("div",as,[Z("div",ts,[Z("div",rs,[s[53]||(s[53]=Z("h3",{class:"text-white font-semibold text-lg"},"Iniciar Conversacin",-1)),Z("button",{onClick:s[12]||(s[12]=i=>y.value=!1),class:"text-white/80 hover:text-white transition-colors"},[...s[52]||(s[52]=[Z("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[Z("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),Z("div",ss,[Z("div",null,[s[55]||(s[55]=Z("label",{class:"block text-sm font-medium text-slate-300 mb-1"},"Prefijo Pas",-1)),Z("div",ns,[s[54]||(s[54]=Z("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 font-medium"},"+",-1)),pe(Z("input",{"onUpdate:modelValue":s[13]||(s[13]=i=>Q.value=i),type:"text",class:"w-full pl-6 pr-4 py-2 rounded-lg bg-slate-700/50 border border-white/10 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all outline-none",placeholder:"591"},null,512),[[Ie,Q.value]])])]),Z("div",null,[s[56]||(s[56]=Z("label",{class:"block text-sm font-medium text-slate-300 mb-1"},"Nmero de Telfono",-1)),pe(Z("input",{"onUpdate:modelValue":s[14]||(s[14]=i=>D.value=i),type:"tel",class:"w-full px-4 py-2 rounded-lg bg-slate-700/50 border border-white/10 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all outline-none",placeholder:"70012345",onKeyup:Je(y0,["enter"])},null,544),[[Ie,D.value]])]),Z("div",null,[s[58]||(s[58]=Z("label",{class:"block text-sm font-medium text-slate-300 mb-1"},"Plantilla de Inicio (Opcional)",-1)),pe(Z("select",{"onUpdate:modelValue":s[15]||(s[15]=i=>O.value=i),class:"w-full px-4 py-2 rounded-lg bg-slate-700/50 border border-white/10 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all outline-none text-sm"},[s[57]||(s[57]=Z("option",{value:""},"-- Ninguna --",-1)),(O0(!0),N0(Se,null,ke(l0.value,i=>(O0(),N0("option",{key:i.name,value:i.name},G0(i.name)+" ("+G0(i.language)+") ",9,is))),128))],512),[[ge,O.value]]),s[59]||(s[59]=Z("p",{class:"text-xs text-slate-400 mt-1"},"Si el contacto no te ha escrito en 24h, usa una plantilla. ",-1))]),Z("button",{onClick:y0,disabled:h0.value||!D.value,class:"w-full py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-lg shadow-md transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[h0.value?(O0(),N0("span",os)):se("",!0),De(" "+G0(h0.value?"Iniciando...":"Iniciar Chat"),1)],8,ls)])])])):se("",!0)],64))}},hs=Ua(_s,[["__scopeId","data-v-8afe2e6f"]]);export{hs as default};
